<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title><![CDATA[webpackç³»åˆ—ä¹‹åˆæŽ¢]]></title>
    <url>%2F2019%2F06%2F06%2Fwebpack%E7%B3%BB%E5%88%97%E4%B9%8B%E5%88%9D%E6%8E%A2%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢ç›¸ä¿¡webpackè¿™ä¸ªåç§°å¯¹äºŽå‰ç«¯çš„åŒå­¦æ¥è¯´å¹¶ä¸é™Œç”Ÿï¼Œåªè¦ä½ åœ¨ç”¨vueã€reactç­‰ç­‰ä¹‹ç±»çš„æ¡†æž¶ï¼Œå°±å¾—å¤©å¤©å’Œå®ƒæ‰“äº¤é“ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†äººéƒ½åªæ˜¯ç›´æŽ¥æ€¼ä¸€ä¸ªvue-cliè„šæ‰‹æž¶ç”Ÿæˆä¸€ä¸ªé¡¹ç›®ï¼Œè¿è¡Œèµ·æ¥å°±å¼€å§‹ä¸€é¡¿å†™ï¼Œå®Œå…¨ä¸ä¼šåŽ»çœ‹è¿™ä¸ªé¡¹ç›®çš„å…¶ä»–ç›¸å…³çš„ä¸œè¥¿ï¼Œä»Šå¤©å¼€å§‹ï¼Œå’±ä»¬å°±æ¥è¯´è¯´è¿™ä¸ªåˆçˆ±åˆæ¨çš„webpack é—®é¢˜ä½¿ç”¨wepackçš„æ—¶å€™ç»å¸¸ä¼šå‡ºçŽ°ä¸‹é¢è¿™äº›ç–‘é—® ä½ webpackåªèƒ½æ‰“åŒ…å•é¡µé¢çš„æ–‡ä»¶å—ï¼Ÿ WTFï¼Œæˆ‘åŒ…æ€Žä¹ˆè¿™ä¹ˆå¤§ï¼ŒåŠ è½½å¤ªæ…¢äº† æˆ‘æ‰“åŒ…é€Ÿåº¦æ€Žä¹ˆè¿™ä¹ˆæ…¢ï¼Œä»€ä¹ˆç ´çŽ©æ„ï¼Ÿâ€¦ ä¸ºä»€ä¹ˆè¦ä½¿ç”¨webpackå“ˆï¼Œä½ é—®æˆ‘ä¸ºä»€ä¹ˆè¦ç”¨ï¼Ÿå› ä¸ºå¤§å®¶éƒ½åœ¨ç”¨å•ŠðŸ˜ƒðŸ˜ƒã€‚å¼€ä¸ªçŽ©ç¬‘ï¼Œå‰ç«¯å‘å±•åˆ°ä»Šå¤©ï¼Œæ–°æŠ€æœ¯æ–°æ€æƒ³æ–°æ¡†æž¶çˆ†å‘å¼å¢žé•¿ï¼Œå½“å‰çš„æµè§ˆå™¨çŽ¯å¢ƒè·‘ä¸èµ¢å•Šï¼Œä½ è¯´ä½ å†™ä¸ªES6/7åœ¨æµè§ˆå™¨çŽ¯å¢ƒéƒ½èƒ½è·‘èµ·æ¥ï¼Ÿæ‰¯æ·¡çš„ã€‚è¿™ä¸ªæ—¶å€™babelå°±å‡ºçŽ°äº†ï¼Œä½ è·‘ä¸èµ·æ¥æ˜¯å§ï¼Œé‚£æˆ‘è½¬æˆES5ä½ æ€»è¯¥è·‘èµ·æ¥å§~ï¼Œé‚£babelæˆ‘è¿˜æ˜¯ä¸èƒ½ç›´æŽ¥ç”¨å•Šï¼Œè‚¯å®šå¾—å€ŸåŠ©å·¥å…·ç¼–è¯‘å‘€ï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦webpackåŽ»åšè¿™ä»¶äº‹æƒ…äº†ã€‚è¿™ä¸ªæ—¶å€™æœ‰äººå°±è¦ç«™å‡ºæ¥è¯´äº†ï¼Œæˆ‘gulpä¸æœï¼Œæˆ‘ä¹Ÿèƒ½åšï¼Œæˆ‘å°±ä¸ç”¨webpackã€‚ä½ è¿™ä¹ˆè¯´æˆ‘å°±è¦è·Ÿä½ å” å” äº†ï¼ŒçŽ°åœ¨æˆ‘ä»¬å…ˆæ¥æ¯”è¾ƒä¸€ä¸‹webpackå’Œgulpã€‚ gulp æ˜¯ task runnerï¼ŒWebpack æ˜¯ module bundler webpackçš„ä¼˜åŠ¿åœ¨æ¨¡å—åŒ–ï¼Œgulpé™¤äº†æ¨¡å—åŒ–æ–¹é¢éƒ½å¾ˆä¸é”™ã€‚ä½†æ˜¯å‰ç«¯å‘å±•è‡³ä»Šï¼Œæ¨¡å—åŒ–çœŸçš„å¾ˆé‡è¦ï¼ŒCMDã€AMDå°±æ˜¯æ¨¡å—åŒ–çš„äº§ç‰©ã€‚ç®€å•æ¥è¯´ï¼Œå¦‚æžœä½ å½“å‰é¡¹ç›®éœ€è¦æ¨¡å—åŒ–ç¼–ç¨‹ï¼Œé‚£å°±é€‰webpackï¼Œå¦‚æžœæ˜¯å¤„ç†å…¶ä»–äº‹æƒ…ï¼Œæ¯”å¦‚æŠŠå›¾ç‰‡æ‹¼æŽ¥æˆé›ªç¢§å›¾æˆ–è€…åŽ‹ç¼©ï¼Œé‚£ä¹ˆgulpæ˜¯æœ€æ“…é•¿çš„ æ„Ÿå…´è¶£çš„å¯ä»¥çœ‹çœ‹è¿™ä¸ªå›žç­” gulp æœ‰å“ªäº›åŠŸèƒ½æ˜¯ webpack ä¸èƒ½æ›¿ä»£çš„ï¼Ÿ å®‰è£…è¿™é‡Œå¯ä»¥å‚è€ƒwebpackå®˜ç½‘123&gt; mkdir webpack &amp;&amp; cd webpack&gt; npm init -y&gt; npm install webpack webpack-cli -D å…¥å£ï¼ˆentryï¼‰æ¯ä¸ªwebpackéƒ½ä¼šæœ‰ä¸€ä¸ªentryï¼Œå°±æ˜¯å…¥å£çš„æ„æ€ï¼ŒæŒ‡ç¤º webpack åº”è¯¥ä½¿ç”¨å“ªä¸ªæ¨¡å—ï¼Œæ¥ä½œä¸ºæž„å»ºå…¶å†…éƒ¨ä¾èµ–å›¾çš„å¼€å§‹ã€‚ æ³¨æ„ç‚¹ï¼š å…¥å£å¯ä»¥æœ‰å¤šä¸ªï¼Œå¦‚æžœæ˜¯å•é¡µé¢åªéœ€è¦ä¸€ä¸ªå…¥å£ï¼Œå¤šé¡µé¢å¯ä»¥è®¾ç½®å¤šä¸ªè·¯å£ å…¥å£çš„æ–‡ä»¶å¿…é¡»æ˜¯.jsæ–‡ä»¶ï¼Œå› ä¸ºwebpackåªè®¤è¯†js ä¸¾ä¸ªðŸŒ°æˆ‘ä»¬æ–°å»ºwebpack.config.jså’Œæ–°å»ºsrcæ–‡ä»¶å¤¹ï¼Œå¹¶ä¸”æ–‡ä»¶å¤¹ä¸‹æ–°å»ºindex.jsæ–‡ä»¶ç›®å½•å¦‚ä¸‹ 1234- webpack/- src/- index.js- webpack.config.js webpack.config.js123module.exports = &#123; entry: './src/index.js'&#125;; æˆ‘ä»¬ä¸Šé¢æŒ‡å®šwebpackçš„å…¥å£æ–‡ä»¶ä¸ºindex.jsæ–‡ä»¶ï¼Œè¿™æ˜¯æ€»å…¥å£ å‡ºå£ï¼ˆoutputï¼‰æœ‰å…¥å£å½“ç„¶å°±ä¼šæœ‰å‡ºå£äº†ï¼Œå°±æ˜¯ä½ å¯¼å‡ºçš„æ–‡ä»¶ webpack.config.js1234567module.exports = &#123; entry: './src/index.js', output: &#123; path: path.resolve(__dirname, 'dist'), filename: 'bundle.js' &#125;&#125;; ä¸Šè¿°entryå·²ç»ä»‹ç»è¿‡äº†ï¼Œæˆ‘ä»¬æ¥çœ‹çœ‹outputï¼Œä»–æœ‰æ–‡ä»¶å¯¼å‡ºçš„è·¯å¾„ï¼ˆpathï¼‰å’Œå¯¼å‡ºçš„æ–‡ä»¶åï¼ˆfilenameï¼‰ å…³äºŽfilenameè¿™é‡Œéœ€è¦æ³¨æ„çš„åœ°æ–¹æœ‰ï¼š å‡ºå£çš„æ–‡ä»¶åå¯ä»¥å®šåˆ¶åŒ–ï¼Œå½“å‰å¦‚æžœä½ æ˜¯å•é¡µé¢çš„è¯ï¼Œç®€å•çš„å¯ä»¥å†™æ­»ä¸€ä¸ªfilenameï¼Œå°±å¦‚ä¸Šé¢çš„bundle.jsä¸€æ · ä½ ä¹Ÿå¯ä»¥è¿™ä¹ˆå†™ï¼Œä½¿ç”¨å…¥å£åç§°çš„åç§°ï¼šfilename: &#39;[name].bundle.js&#39;,å½“ç„¶è¿˜éœ€è¦æ”¹ä¸€ä¸‹entryï¼ŒæŠŠå®ƒæ”¹æˆä»¥ä¸‹å½¢å¼ï¼Œnameå°±ä¼šå˜æˆ -&gt; app 123456789module.exports = &#123; entry: &#123; app: './src/index.js' &#125;, output: &#123; path: path.resolve(__dirname, 'dist'), filename: 'bundle.js' &#125;&#125;; çŽ°åœ¨æˆ‘ä»¬æ¥è¯•ä¸€ä¸‹webapckæ‰“åŒ… å°è¯•ç‰›åˆ€ç¬¬ä¸€æ­¥ï¼Œæ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹webpack-demo123&gt; mkdir webpack-demo &amp;&amp; cd webpack-demo&gt; npm init -y&gt; cnpm install webpack webpack-cli -D ç¬¬äºŒæ­¥ï¼Œæ–°å»ºsrc/index.jsæ–‡ä»¶å’Œwebpack.config.jsæ–‡ä»¶ webpack.config.js 12345678const path = require('path');module.exports = &#123; entry: './src/index.js', output: &#123; filename: 'bundle.js', path: path.resolve(__dirname, 'dist/'), &#125;,&#125;; index.js1document.write('hello webpack'); ç¬¬ä¸‰æ­¥ï¼Œæ‰“åŒ…å‘½ä»¤è¡Œè¾“å…¥1&gt; npx webpack --config webpack.config.js ç„¶åŽæŽ§åˆ¶å°å°±ä¼šè¾“å‡º12345678Hash: 348dca17387cd3f29cefVersion: webpack 4.33.0Time: 227msBuilt at: 2019-06-08 15:24:07 Asset Size Chunks Chunk Namesbundle.js 961 bytes 0 [emitted] mainEntrypoint main = bundle.js[0] ./src/index.js 33 bytes &#123;0&#125; [built] çœ‹åˆ°è¿™ä¸ªä¿¡æ¯è¯æ˜Žä½ å·²ç»å¤§åŠŸå‘Šæˆäº†ï¼ŒåŽ»çœ‹çœ‹dist/æ–‡ä»¶å¤¹ä¸‹æ˜¯ä¸æ˜¯æœ‰æ‰“åŒ…å¥½çš„jsæ–‡ä»¶æœ€åŽé¢ä½ ä¼šçœ‹åˆ°æœ‰é»„è‰²çš„è­¦å‘Šï¼Œè¯´modeæ²¡æœ‰è®¾ç½®ï¼Œå¾…ä¼šå†è®² è¿™ä¸ªæ—¶å€™ä½ å°±ä¼šæƒ³ï¼Œæˆ‘æ¯æ¬¡ç”Ÿæˆçš„æ–‡ä»¶éƒ½å«bundle.jsï¼Œæˆ‘éƒ½åŒºåˆ†ä¸å¼€ï¼Œä¹Ÿä¸å¥½åšç¼“å­˜ï¼Œè¿™ä¸ªæ—¶å€™ä½ å°±éœ€è¦é…ç½®ä¸€ä¸‹filenameäº† æˆ‘ä»¬æŠŠwebpack.config.jsæ”¹æˆä»¥ä¸‹ 12345678910const path = require('path');module.exports = &#123; entry: &#123; app: './src/index.js', &#125;, output: &#123; filename: '[name].[hash].js', path: path.resolve(__dirname, 'dist/'), &#125;,&#125;; ç„¶åŽæ‰§è¡Œ1&gt; npx webpack --config webpack.config.js è¿™ä¸ªæ—¶å€™dist/æ–‡ä»¶å¤¹ä¸‹å°±ä¼šå¤šå‡ºä¸ªç±»ä¼¼app.32434c7cc602e3049dac.jsçš„æ–‡ä»¶ï¼Œè€Œä¸”å¦‚æžœä½ åå¤æ‰§è¡Œæ‰“åŒ…å‘½ä»¤ï¼Œä½ å‘çŽ°app.32434c7cc602e3049dac.jsæ–‡ä»¶åéƒ½æ²¡æœ‰æ”¹å˜ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿå› ä¸ºwebpackä¼šåˆ¤æ–­ä½ çš„æ–‡ä»¶æ˜¯å¦æœ‰æ›´æ”¹è€Œæ¥è§‰å¾—æ–‡ä»¶å¤¹hashçš„å˜æ›´ï¼ŒçŽ°åœ¨ä½ å¯ä»¥å°è¯•ä¿®æ”¹ä¸€ä¸‹index.jsæ–‡ä»¶ä¹‹åŽæ‰“åŒ…çš„æ•ˆæžœå°±çŸ¥é“äº†ã€‚ æ¨¡å¼ï¼ˆmode ï¼‰ä¸Šé¢è¯´åˆ°æ¯æ¬¡æ‰“åŒ…çš„æ—¶å€™éƒ½ä¼šæŠ¥è­¦å‘Šï¼Œå‘Šè¯‰æˆ‘ä»¬æ²¡æœ‰è®¾ç½®modeï¼ŒçŽ°åœ¨æˆ‘ä»¬æ¥è¯´è¯´modeé¦–å…ˆmodeæœ‰ä¸¤ä¸ªå€¼ï¼Œåˆ†åˆ«æ˜¯developmentå’Œproductionï¼Œæ„æ€å°±æ˜¯ï¼Œå½“å‰é¡¹ç›®æ‰“åŒ…çš„å¼€å‘çŽ¯å¢ƒè¿˜æ˜¯ç”ŸæˆçŽ¯å¢ƒçš„ä»£ç å¦‚æžœä½ è®¾ç½®äº†mode: â€˜developmentâ€™ï¼Œåœ¨é¡¹ç›®é‡Œä½ å¯ä»¥ä½¿ç”¨ process.env.NODE_ENV æ¥èŽ·å–å½“å‰çš„çŽ¯å¢ƒçš„å€¼ä½ å¯ä»¥å°è¯•æŠŠwebpack.config.jsæ”¹æˆä»¥ä¸‹ï¼Œç„¶åŽåœ¨index.jsé‡ŒæŠŠè¿™ä¸ªå€¼æ‰“å°å‡ºæ¥ï¼Œè¿è¡Œä¸€ä¸‹æ•ˆæžœ webpack.config.js1234567891011const path = require('path');module.exports = &#123; mode: 'development', entry: &#123; app: './src/index.js', &#125;, output: &#123; filename: '[name].[hash].js', path: path.resolve(__dirname, 'dist/'), &#125;,&#125;; index.js1document.write(`hello webpackï¼Œthis is $&#123;process.env.NODE_ENV&#125;`); çŽ°åœ¨æˆ‘ä»¬åªæœ‰jsæ–‡ä»¶ï¼Œä½ å¯ä»¥å…ˆåœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼ŒæŠŠjså¼•å…¥åœ¨æµè§ˆå™¨çŽ¯å¢ƒæ‰§è¡Œ(æˆ–è€…ç›´æŽ¥åœ¨æµè§ˆå™¨æŽ§åˆ¶å°æ‰§è¡Œjs)ï¼Œä½ ä¼šçœ‹åˆ°æµè§ˆå™¨æ˜¾ç¤º -&gt; hello webpackï¼Œthis is developmentä½ åˆ†åˆ«è¿è¡Œä¹‹åŽä¼šå‘çŽ°ä»–ä»¬çš„æ•ˆæžœæ˜¯ä¸ä¸€æ ·çš„ï¼Œä¸€ä¸ªæ˜¯è¢«åŽ‹ç¼©çš„ï¼Œä¸€ä¸ªæ²¡æœ‰è¢«åŽ‹ç¼© è¿™ä¸ªæ—¶å€™ä½ å°±ä¼šæƒ³äº†ï¼Œæ€Žä¹ˆè¿™ä¹ˆéº»çƒ¦ï¼Œæˆ‘æ‰“åŒ…è¿˜å¾—è‡ªå·±åŽ»æ–°å»ºhtmlæ–‡ä»¶å¼•å…¥jsç„¶åŽè¿è¡Œæˆ–è€…åŽ»æ‰§è¡Œjsæ–‡ä»¶ï¼Œèƒ½ä¸èƒ½è®©ä»–è‡ªåŠ¨è¿è¡Œè·‘èµ·æ¥ï¼Ÿå½“ç„¶æ˜¯å¯ä»¥çš„ï¼Œä¸‹é¢æˆ‘ä»¬æ¥è¯´è¯´plugins## æ’ä»¶ï¼ˆpluginsï¼‰æ’ä»¶æ˜¯ webpack çš„æ”¯æŸ±åŠŸèƒ½ã€‚webpack è‡ªèº«ä¹Ÿæ˜¯æž„å»ºäºŽï¼Œä½ åœ¨ webpack é…ç½®ä¸­ç”¨åˆ°çš„ç›¸åŒçš„æ’ä»¶ç³»ç»Ÿä¹‹ä¸Šï¼ï¼ˆå®˜ç½‘çš„è§£é‡Šï¼‰æ’ä»¶æ€Žä¹ˆè¯´å‘¢ï¼Ÿä¸å¥½è§£é‡Šå®ƒï¼Œä½ å¯ä»¥ç†è§£ä¸ºå¤„ç†å·¥å…·ï¼Œæ’ä»¶ç›®çš„åœ¨äºŽè§£å†³ loader(è¿™ä¸ªç­‰ä¼šå†è®²ï¼ŒçŽ°åœ¨ç”¨ä¸ä¸Š) æ— æ³•å®žçŽ°çš„å…¶ä»–äº‹æ’ä»¶æ€Žä¹ˆé…ç½®ï¼Ÿå°±åƒä¸‹é¢è¿™æ ·ï¼Œå½“ç„¶ä¸æ˜¯éšä¾¿æ‰¾çš„æ’ä»¶ï¼Œæˆ‘ä»¬ä¼šç”¨åˆ°ä¸‹é¢é…ç½®çš„æ’ä»¶123456789101112131415const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');module.exports = &#123; mode: 'development', entry: &#123; app: './src/index.js', &#125;, output: &#123; filename: '[name].[hash].js', path: path.resolve(__dirname, 'dist/'), &#125;, plugins: [ new HtmlWebpackPlugin(&#123;template: 'index.html'&#125;) ]&#125;;æˆ‘ä»¬å…ˆåœ¨æ ¹ç›®å½•æ–°å»ºä¸€ä¸ªindex.htmlæ–‡ä»¶ï¼Œä¹‹å‰ä¸æ˜¯è¯´è¿è¡Œé¡¹ç›®å¾ˆéº»çƒ¦å˜›ï¼ŸçŽ°åœ¨æ•™ä½ ç®€å•çš„æ–¹æ³•ç„¶åŽæˆ‘ä»¬ç”¨åˆ°äº†html-webpack-pluginï¼Œéœ€è¦å…ˆå®‰è£…ä»–æ‰èƒ½ä½¿ç”¨1&gt; cnpm i html-webpack-plugin -Dä¸‹ä¸€æ­¥æ‰“åŒ…è¿è¡Œé¡¹ç›®1&gt; npx webpack --config webpack.config.jsè¿è¡Œç»“æžœï¼š12345678910111213141516Hash: bea857ae13cad8af6e66Version: webpack 4.33.0Time: 274msBuilt at: 2019-06-08 16:00:33 Asset Size Chunks Chunk Namesapp.bea857ae13cad8af6e66.js 3.83 KiB app [emitted] app index.html 74 bytes [emitted] Entrypoint app = app.bea857ae13cad8af6e66.js[./src/index.js] 65 bytes &#123;app&#125; [built]Child html-webpack-plugin for &quot;index.html&quot;: 1 asset Entrypoint undefined = index.html [./node_modules/_html-webpack-plugin@3.2.0@html-webpack-plugin/lib/loader.js!./index.html] 209 bytes &#123;0&#125; [built] [./node_modules/_webpack@4.33.0@webpack/buildin/global.js] (webpack)/buildin/global.js 472 bytes &#123;0&#125; [built] [./node_modules/_webpack@4.33.0@webpack/buildin/module.js] (webpack)/buildin/module.js 497 bytes &#123;0&#125; [built] + 1 hidden moduleåŽ»æŸ¥çœ‹distæ–‡ä»¶å¤¹ä¸‹ï¼Œä½ ä¼šå‘çŽ°å¤šå‡ºäº†ä¸¤ä¸ªæ–‡ä»¶ï¼Œjså’Œindex.htmlæ–‡ä»¶ï¼Œè¿™å°±æ˜¯æ’ä»¶çš„åŠŸåŠ³html-webpack-pluginè¿™ä¸ªæ’ä»¶éœ€è¦æŒ‡å®šæ˜¯é‚£ä¸ªhtmlæ¨¡æ¿ï¼Œç„¶åŽæœ€åŽæ‰“åŒ…çš„æ—¶å€™å°±æ˜¯ä»¥è¿™ä¸ªæ¨¡æ¿ä¸ºä¸»ï¼ŒæŠŠæ‰“åŒ…å¥½çš„jsæ–‡ä»¶æ”¾åˆ°è¿™ä¸ªindex.htmlé‡Œé¢ï¼Œä½ å¯ä»¥æŸ¥çœ‹htmlæ–‡ä»¶é‡Œçš„å†…å®¹ï¼šindex.html1&lt;script type="text/javascript" src="app.1b0b2001b0579faec32d.js"&gt;&lt;/script&gt;è¿™ä¸ªæ—¶å€™ä½ ä¼šå‘çŽ°ï¼Œæˆ‘é ï¼Œæˆ‘distæ–‡ä»¶æ€Žä¹ˆè¿™ä¹ˆå¤šå•Šï¼Œæ€Žä¹ˆåŠžå•Šï¼Ÿåˆ«æ€¥ï¼Œæˆ‘ä»¬å†æ¥ç”¨ä¸€ä¸ªæ’ä»¶è§£å†³è¿™ä¸ªé—®é¢˜ å®‰è£…æ’ä»¶clean-webpack-plugin1&gt; cnpm i clean-webpack-plugin -D ç„¶åŽé…ç½®æ–‡ä»¶åŽ»æ·»åŠ æ’ä»¶ 1234567891011121314151617const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const &#123; CleanWebpackPlugin &#125; = require('clean-webpack-plugin');module.exports = &#123; mode: 'development', entry: &#123; app: './src/index.js', &#125;, output: &#123; filename: '[name].[hash].js', path: path.resolve(__dirname, 'dist/'), &#125;, plugins: [ new CleanWebpackPlugin(), new HtmlWebpackPlugin(&#123;template: 'index.html'&#125;) ]&#125;; ç„¶åŽä½ å†åŽ»çœ‹çœ‹distæ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶ï¼Œæ˜¯ä¸æ˜¯åªæœ‰ä¸¤ä¸ªæ–‡ä»¶äº†ï¼Ÿè¿™ä¸ªæ’ä»¶çš„ä½œç”¨æ˜¯ï¼Œå…ˆæŠŠdistæ–‡ä»¶å¤¹é‡Œçš„æ–‡ä»¶å…ˆæ¸…ç©ºç„¶åŽå†æŠŠæ‰“åŒ…å¥½çš„æ–‡ä»¶æ”¾å…¥distã€‚ é‚£ä¹ˆä½ è¿˜ä¼šæœ‰é—®é¢˜ï¼Œè¿™è¿˜æ˜¯éº»çƒ¦å•Šï¼Œæˆ‘ä¸èƒ½åªè¿è¡Œå‘½ä»¤è¡Œï¼Œè®©é‡æ–°è‡ªå·±æ‰“å¼€æµè§ˆå™¨è¿è¡Œæˆ‘æ‰“åŒ…çš„é¡¹ç›®å—ï¼Ÿå½“ç„¶å¯ä»¥å•Šé¦–å…ˆå®‰è£… webpack-dev-server1&gt; cnpm i webpack-dev-server -Dç„¶åŽ1&gt; webpack-dev-server --open --config webpack.config.jsä½ ä¼šå‘çŽ°é‡æ–°è‡ªåŠ¨æ‰“å¼€äº†æµè§ˆå™¨ï¼Œé¡µé¢æ˜¾ç¤º hello webpackï¼Œthis is developmentã€‚æ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿä½ çŽ°åœ¨å¯ä»¥åŽ»ä¿®æ”¹index.jsç„¶åŽä¿å­˜æ–‡ä»¶ï¼ŒåŽ»æµè§ˆå™¨çœ‹çœ‹æ˜¯ä¸æ˜¯è‡ªåŠ¨åˆ·æ–°äº†ä½ åˆšåˆšæ›´æ”¹çš„å†…å®¹å‘¢ï¼ŸçŽ°åœ¨ä½ å¯èƒ½è¿˜ä¼šæœ‰é—®é¢˜ï¼Œæˆ‘åŽ»ï¼Œè¿™å¤ªç®€å•äº†å§ï¼Œæˆ‘è¦ç”¨csså’Œå›¾ç‰‡æ€Žä¹ˆåŠžï¼Ÿjsä¸èƒ½å¯¼å…¥cssæ–‡ä»¶å•Šï¼æˆ‘æ€Žä¹ˆè·Ÿvueä¸€æ ·åœ¨è‡ªå·±çš„ipè®¿é—®é¡¹ç›®å•Šï¼ŸçŽ°åœ¨è‚¯å®šæ˜¯é—®é¢˜ä¸€å¤§å † loaderloader ç”¨äºŽå¯¹æ¨¡å—çš„æºä»£ç è¿›è¡Œè½¬æ¢ã€‚loader å¯ä»¥ä½¿ä½ åœ¨ import æˆ–â€åŠ è½½â€æ¨¡å—æ—¶é¢„å¤„ç†æ–‡ä»¶ã€‚æ¯”å¦‚å¯ä»¥æŠŠtypescriptè½¬æ¢æˆJavaScriptï¼Œlessè½¬æˆcssçŽ°åœ¨æˆ‘ä»¬å°±æ¥è§£å†³ä½ ä¸Šä¸€ç« èŠ‚æœ«çš„é—®é¢˜ï¼Œæ•™ä½ é…ç½®ç®€å•çš„loaderï¼Œæ¥åŠ è½½cssæˆ–è€…å›¾ç‰‡é¦–å…ˆæˆ‘ä»¬å…ˆå®‰è£…css-loader/style-loaderï¼Œæ¥åŠ è½½è§£æžcssæ–‡ä»¶1&gt; cnpm i css-loader style-loader -D ä¸‹ä¸€æ­¥åœ¨srcæ–‡ä»¶å¤¹ä¸‹æ–°å»ºtest.cssæ–‡ä»¶ï¼Œå†åœ¨index.jså¯¼å…¥test.css123body &#123; background: #ccc;&#125; index.js12import './test.css';document.write(`hello webpackï¼Œthis is $&#123;process.env.NODE_ENV&#125;ï¼Œtest`); å¦‚æžœä½ ç›´æŽ¥è¿è¡Œä¼šå‘çŽ°æŽ§åˆ¶å°æŠ¥é”™äº†1234567ERROR in ./src/test.css 1:5Module parse failed: Unexpected token (1:5)You may need an appropriate loader to handle this file type.&gt; body &#123;| background: #ccc;| &#125; @ ./src/index.js 1:0-20 è¿™ä¸ªæ—¶å€™loaderç™»åœºäº†ï¼Œæˆ‘ä»¬ä¿®æ”¹é…ç½®æ–‡ä»¶webpack.config.js12345678910111213141516171819202122232425const path = require('path');const HtmlWebpackPlugin = require('html-webpack-plugin');const &#123; CleanWebpackPlugin &#125; = require('clean-webpack-plugin');module.exports = &#123; mode: 'development', entry: &#123; app: './src/index.js', &#125;, output: &#123; filename: '[name].[hash].js', path: path.resolve(__dirname, 'dist/'), &#125;, plugins: [ new CleanWebpackPlugin(), new HtmlWebpackPlugin(&#123; template: 'index.html' &#125;), ], module: &#123; rules:[ &#123; test: /\.css$/, use: ['style-loader', 'css-loader'], &#125;, ] &#125;&#125;; ç„¶åŽè¿è¡Œå‘½ä»¤è¡Œ1&gt; webpack-dev-server --open --config webpack.config.js ä½ ä¼šå‘çŽ°é¡µé¢èƒŒæ™¯é¢œè‰²å˜äº† çŽ°åœ¨æˆ‘ä»¬æ¥è¯´è¯´é…ç½®ï¼šmodule.rules å…è®¸ä½ åœ¨ webpack é…ç½®ä¸­æŒ‡å®šå¤šä¸ª loaderï¼Œä¸Šé¢æˆ‘ä»¬è§„å®šæ­£åˆ™åŒ¹é…cssæ–‡ä»¶ï¼Œç„¶åŽå¦‚æžœåŒ¹é…åˆ°äº†ï¼Œåˆ™ä½¿ç”¨style-laoderå’Œcss-loaderåŽ»å¤„ç†cssæ–‡ä»¶ï¼Œcss-laoderè´Ÿè´£è§£æžcssæ–‡ä»¶ï¼Œstyle-loaderè´Ÿè´£æŠŠcssæ–‡ä»¶æ”¾åˆ°é¡µé¢ä¸­åŽ»ï¼Œä½ æ‰“å¼€è°ƒè¯•å¯ä»¥çœ‹åˆ°headé‡Œè¢«æ’å…¥äº†styleæ ·å¼æ ‡ç­¾ï¼Œå½“å‰å¦‚æžœä½ æƒ³è§£æžä¾‹å¦‚xx.tsæ–‡ä»¶ï¼Œåˆ™å¯ä»¥åœ¨æ•°ç»„é‡Œé¢æ–°å¢žï¼š1234 &#123; test: /\.ts$/, use: 'ts-loader',&#125;, ä¸‹é¢æ¥çœ‹çœ‹æ€Žä¹ˆåŠ è½½å›¾ç‰‡èµ„æºï¼Œè¿˜æ˜¯è·Ÿä¸Šè¿°åŽŸä¸€æ ·ï¼Œå›¾ç‰‡ä¹Ÿæ˜¯æœ‰ç±»åž‹çš„ï¼Œæˆ‘ä»¬é¦–å…ˆå¾—åŒ¹é…æ–‡ä»¶åŽç¼€ï¼Œç„¶åŽåŽ»ç”¨loaderåŽ»è§£æžä»–ä»¬ï¼Œè¿™é‡Œæˆ‘ä»¬éœ€è¦ç”¨åˆ° url-loader file-loaderæŒ‰ç…§æƒ¯ä¾‹å…ˆå®‰è£…1&gt; cnpm i url-loader file-loader -D 12345678910111213141516171819module.exports = &#123; ... module: &#123; rules:[ &#123; test: /\.css$/, use: ['style-loader', 'css-loader'], &#125;, &#123; test: /\.(png|jpe?g|gif|svg)(\?.*)?$/, loader: 'url-loader', options: &#123; limit: 6000, name: 'img/[name].[hash:7].[ext]', &#125;, &#125; ] &#125;&#125;; ä¸‹ä¸€æ­¥å°±æ˜¯å¾€é¡¹ç›®é‡Œå¢žåŠ å›¾ç‰‡äº†æˆ‘ä»¬ä¿®æ”¹test.cssæ–‡ä»¶test.css123body &#123; background: url(img.jpg);&#125; æµè§ˆå™¨å°±æ˜¾ç¤ºçš„å…¨æ˜¯åˆšåˆšè®¾ç½®çš„é‡å¤å›¾ç‰‡äº† è¿™é‡Œä½ åˆä¼šé—®äº†ï¼Œä¸å¯¹ï¼Œä½ è¿™é‡Œåªç”¨åˆ°äº†url-loaderï¼Œfile-loaderä¸æ˜¯å¤šä½™çš„å—ï¼Ÿ ä¸æ˜¯çš„ï¼Œä½ å¯ä»¥çœ‹çœ‹optionsï¼Œæœ‰ä¸€ä¸ªlimitå‚æ•°ï¼Œè§„å®šå¦‚æžœè¶…è¿‡äº†6000byteså¤§å°çš„æ–‡ä»¶ä¼šäº¤ç»™file-loaderå¤„ç†ï¼Œå› ä¸ºå¦‚æžœå›¾ç‰‡å°äºŽè¿™ä¸ªæ•°å€¼ï¼Œurl-loaderä¼šæŠŠå›¾ç‰‡è½¬æˆbase64æ ¼å¼çš„å›¾ç‰‡åŠ è½½ï¼Œå¦‚æžœè¶…è¿‡å°±è‡ªå·±ä¸å¤„ç†äº†ï¼Œæ‰€ä»¥ä»–ä»¬ä¸¤è€…æ˜¯æœ‰ç›¸ä¾æ€§çš„ ä½¿ç”¨npmè„šæœ¬ä¸Šé¢åŸºæœ¬ä¸Šéƒ½æ˜¯ä½¿ç”¨ä¸€å¤§æ®µçš„å‘½ä»¤è¡Œæ¥æ‰§è¡Œé¡¹ç›®ï¼ŒçŽ°åœ¨æˆ‘ä»¬æ¥ç®€åŒ–ä¸€ä¸‹ä¿®æ”¹package.json1234"scripts": &#123; "dev": "webpack-dev-server --open --config webpack.config.js", "build": "webpack --config webpack.config.js"&#125;, å‘½ä»¤è¡Œè¿è¡Œé¡¹ç›®12&gt; npm run dev&gt; npm run build devServeråœ¨å¼€å‘ä¸­ä½ å¯èƒ½æœ‰å¾ˆå¤šéœ€æ±‚ï¼Œæ¯”å¦‚æ€Žä¹ˆé€šè¿‡ipè®¿é—®é¡¹ç›®ï¼Œæ€Žä¹ˆæŠŠæŽ§åˆ¶å°ä¿¡æ¯è¾“å‡ºçš„ç²¾ç®€ç‚¹ï¼Œæ€Žä¹ˆä¿®æ”¹ç«¯å£ç­‰ç­‰ï¼Ÿè¿™ä¸ªæ—¶å€™å°±éœ€è¦ç”¨åˆ°devServerçš„é…ç½®äº†æˆ‘ä»¬ä¿®æ”¹webpack.config.js,å¢žåŠ ä»¥ä¸‹ï¼š 1234567891011module.exports = &#123; ... devServer: &#123; contentBase: './dist', // å‘Šè¯‰æœåŠ¡å™¨ä»Žå“ªé‡Œæä¾›å†…å®¹ host: '0.0.0.0', // æŒ‡å®šä½¿ç”¨ä¸€ä¸ª hostã€‚é»˜è®¤æ˜¯ localhost useLocalIp: true, // æ˜¯å¦ä½¿ç”¨æœ¬åœ°ip open: true, // æ˜¯å¦è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨ port: 8080, // ç«¯å£å· noInfo: true, // æ˜¾ç¤ºçš„ webpack åŒ…(bundle)ä¿¡æ¯ã€çš„æ¶ˆæ¯å°†è¢«éšè— &#125;,&#125; æ˜¯çš„ï¼Œä½ çŽ°åœ¨å¯ä»¥ä¸ç”¨åœ¨å‘½ä»¤è¡Œé‡Œå¢žåŠ â€“openè¿™ä¸ªå‚æ•°ï¼Œåœ¨è¿™é‡Œé…ç½®ä¹Ÿæ˜¯ä¸€æ ·çš„ æœ€åŽç´¯äº†ç´¯äº†ï¼Œå†™åˆ°è¿™å·²ç»æ˜¯å‡Œæ™¨äº†ã€‚ä¸å¤šBBäº†ï¼ŒçŽ°åœ¨åŸºæœ¬çš„webpackæ“ä½œåº”è¯¥éƒ½å·²ç»å­¦ä¼šäº†å§ï¼ŒåŽé¢å°±æ˜¯ç¨å¾®æ·±å…¥çš„çŽ©ä¸€çŽ©webpackäº†ï¼Œæˆä¸ºä¸€ä¸ªwebpacké…ç½®å·¥ç¨‹å¸ˆï¼Ÿ to be continuedâ€¦]]></content>
      <categories>
        <category>javascript</category>
        <category>webpack</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>webpack</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[redisç®€æ˜“æ•™ç¨‹ä»¥åŠä½¿ç”¨nodejsè¿žæŽ¥redis]]></title>
    <url>%2F2019%2F04%2F19%2Fredis%E7%AE%80%E6%98%93%E6%95%99%E7%A8%8B%E4%BB%A5%E5%8F%8A%E4%BD%BF%E7%94%A8nodejs%E8%BF%9E%E6%8E%A5redis%2F</url>
    <content type="text"><![CDATA[å‰è¨€ä¸€ç›´æ²¡æœºä¼šå­¦ä¹ redisï¼Œæœ€è¿‘æŠ½ç©ºå­¦äº†ä¸€ä¸‹ï¼Œå› ä¸ºçŸ¥é“reidsè¿˜æ˜¯æ¯”è¾ƒé‡è¦çš„ï¼Œç»å¸¸çœ‹åˆ°æœ‰äººå¼€å‘å…¬ä¼—å·å› ä¸ºæ²¡æœ‰å¯¹access_tokenè¿›è¡Œç¼“å­˜ï¼Œåˆ¤æ–­æ˜¯å¦è¿‡æœŸï¼Œå¯¼è‡´access_tokençš„è°ƒç”¨apiæ¬¡æ•°è¶…è¿‡é™åˆ¶è€Œå½±å“ä¸šåŠ¡çš„æƒ…å†µï¼Œç†Ÿæ‚‰çš„äººéƒ½çŸ¥é“ä½¿ç”¨redisåŸºæœ¬ä¸Šéƒ½æ˜¯åšç¼“å­˜ï¼Œå› ä¸ºä»–ç®€å•ã€é€Ÿåº¦å¿«ï¼Œå¯ä»¥è¯´æ˜¯ä¸ªâ€å¿«ç”·â€ã€‚ä½¿ç”¨reidsåšæŠ½å¥–ä¹Ÿå¾ˆæ™®éï¼Œæœ‰ç©ºå¯ä»¥è¯•è¯•ã€‚æœ¬ç¯‡æœ¬ç« æš‚æ—¶åªè®²keyã€hashã€list redisç®€ä»‹ Redis æ˜¯å®Œå…¨å¼€æºå…è´¹çš„ï¼Œéµå®ˆBSDåè®®ï¼Œæ˜¯ä¸€ä¸ªé«˜æ€§èƒ½çš„key-valueæ•°æ®åº“ã€‚ Redis ä¸Žå…¶ä»– key - value ç¼“å­˜äº§å“æœ‰ä»¥ä¸‹ä¸‰ä¸ªç‰¹ç‚¹ï¼š Redisæ”¯æŒæ•°æ®çš„æŒä¹…åŒ–ï¼Œå¯ä»¥å°†å†…å­˜ä¸­çš„æ•°æ®ä¿å­˜åœ¨ç£ç›˜ä¸­ï¼Œé‡å¯çš„æ—¶å€™å¯ä»¥å†æ¬¡åŠ è½½è¿›è¡Œä½¿ç”¨ã€‚ Redisä¸ä»…ä»…æ”¯æŒç®€å•çš„key-valueç±»åž‹çš„æ•°æ®ï¼ŒåŒæ—¶è¿˜æä¾›listï¼Œsetï¼Œzsetï¼Œhashç­‰æ•°æ®ç»“æž„çš„å­˜å‚¨ã€‚ Redisæ”¯æŒæ•°æ®çš„å¤‡ä»½ï¼Œå³master-slaveæ¨¡å¼çš„æ•°æ®å¤‡ä»½ã€‚ ä¸ºä»€ä¹ˆè¦ç”¨redisï¼ˆä¼˜åŠ¿ï¼‰ æ€§èƒ½æžé«˜ â€“ Redisèƒ½è¯»çš„é€Ÿåº¦æ˜¯110000æ¬¡/s,å†™çš„é€Ÿåº¦æ˜¯81000æ¬¡/s ã€‚ ä¸°å¯Œçš„æ•°æ®ç±»åž‹ â€“ Redisæ”¯æŒäºŒè¿›åˆ¶æ¡ˆä¾‹çš„ Strings, Lists, Hashes, Sets åŠ Ordered Sets æ•°æ®ç±»åž‹æ“ä½œã€‚ åŽŸå­ â€“ Redisçš„æ‰€æœ‰æ“ä½œéƒ½æ˜¯åŽŸå­æ€§çš„ï¼Œæ„æ€å°±æ˜¯è¦ä¹ˆæˆåŠŸæ‰§è¡Œè¦ä¹ˆå¤±è´¥å®Œå…¨ä¸æ‰§è¡Œã€‚å•ä¸ªæ“ä½œæ˜¯åŽŸå­æ€§çš„ã€‚å¤šä¸ªæ“ä½œä¹Ÿæ”¯æŒäº‹åŠ¡ï¼Œå³åŽŸå­æ€§ï¼Œé€šè¿‡MULTIå’ŒEXECæŒ‡ä»¤åŒ…èµ·æ¥ã€‚ ä¸°å¯Œçš„ç‰¹æ€§ â€“ Redisè¿˜æ”¯æŒ publish/subscribe, é€šçŸ¥, key è¿‡æœŸç­‰ç­‰ç‰¹æ€§ã€‚ å®‰è£…è¿è¡ŒåŠè°ƒè¯•ï¼ˆè¿™é‡Œä»¥macä¸ºä¾‹ï¼‰ å…ˆåŽ»å®˜ç½‘ä¸‹è½½å®‰è£…åŒ…ï¼šhttp://www.redis.net.cn/download/ è§£åŽ‹å®‰è£… 12345&gt; tar xzf redis-3.0.6.tar.gz&gt; make&gt; sudo make install&gt; cd /usr/local/bin &amp;&amp; redis-server // å¼€å¯redisæœåŠ¡&gt; cd /usr/local/bin &amp;&amp; redis-cli // å¼€å¯redisè°ƒè¯•æœåŠ¡ å¼€å¯è°ƒè¯•ä¼šæ˜¾ç¤ºä¸‹é¢çš„ç•Œé¢ï¼ŒçŽ°åœ¨ä½ å°±å¯ä»¥å¼€å§‹ä½¿ç”¨redisçš„apiäº†12&gt; cd /usr/local/bin &amp;&amp; redis-cli127.0.0.1:6379&gt; å…¨å±€apiæŸ¥è¯¢é”®123456127.0.0.1:6379&gt; keys *1) &quot;wclimb&quot;2) &quot;key&quot;3) &quot;me&quot;4) &quot;user&quot;5) &quot;user1&quot; é”®çš„æ€»æ•°12127.0.0.1:6379&gt; dbsize (integer) 5 æ£€æŸ¥é”®æ˜¯å¦å­˜åœ¨å­˜åœ¨è¿”å›ž 1 ï¼Œä¸å­˜åœ¨è¿”å›ž 01234127.0.0.1:6379&gt; exists wclimb (integer) 1127.0.0.1:6379&gt; exists wclimb1 (integer) 0 åˆ é™¤é”®è¿”å›žç»“æžœä¸ºæˆåŠŸåˆ é™¤é”®çš„ä¸ªæ•°12127.0.0.1:6379&gt; del user1 (integer) 1 é”®è¿‡æœŸexpire key seconds å½“è¶…è¿‡è¿‡æœŸæ—¶é—´ï¼Œä¼šè‡ªåŠ¨åˆ é™¤ï¼Œkeyåœ¨secondsç§’åŽè¿‡æœŸexpireat key timestamp é”®åœ¨ç§’çº§æ—¶é—´æˆ³timestampåŽè¿‡æœŸpexpire key milliseconds å½“è¶…è¿‡è¿‡æœŸæ—¶é—´ï¼Œä¼šè‡ªåŠ¨åˆ é™¤ï¼Œkeyåœ¨millisecondsæ¯«ç§’åŽè¿‡æœŸpexpireat key milliseconds-timestamp keyåœ¨æ¯«ç§’çº§æ—¶é—´æˆ³timestampåŽè¿‡æœŸ 12127.0.0.1:6379&gt; expire user 10 // 10ç§’åŽuserä¼šè¢«åˆ é™¤(integer) 1 randomkey éšæœºè¿”å›žä¸€ä¸ªé”®1234127.0.0.1:6379&gt; randomkey &quot;wclimb&quot;127.0.0.1:6379&gt; randomkey &quot;me&quot; redis é”®ï¼ˆkeyï¼‰123456set key value [ex] [px] [nx|xx]exä¸ºé”®å€¼è®¾ç½®ç§’çº§è¿‡æœŸæ—¶é—´pxä¸ºé”®å€¼è®¾ç½®æ¯«ç§’çº§è¿‡æœŸæ—¶é—´nxé”®å¿…é¡»ä¸å­˜åœ¨ï¼Œæ‰å¯ä»¥è®¾ç½®æˆåŠŸï¼Œç”¨äºŽæ·»åŠ xxä¸Žnxç›¸åï¼Œé”®å¿…é¡»å­˜åœ¨ï¼Œæ‰å¯ä»¥è®¾ç½®æˆåŠŸï¼Œç”¨äºŽæ›´æ–°setnxã€setex ä¸Žä¸Šé¢çš„nxã€exä½œç”¨ç›¸åŒ è®¾ç½®key(O(1))1234567127.0.0.1:6379&gt; set name 25 OK127.0.0.1:6379&gt; keys * 1) &quot;wclimb&quot;2) &quot;key&quot;3) &quot;me&quot;4) &quot;name&quot; èŽ·å–key(O(1))12127.0.0.1:6379&gt; get name &quot;25&quot; æ‰¹é‡è®¾ç½®keymset key value [key value â€¦â€¦] 1234127.0.0.1:6379&gt; mset test1 1 test2 2OK127.0.0.1:6379&gt; get test2&quot;2&quot; è¿½åŠ å€¼(O(1))1234127.0.0.1:6379&gt; append test2 apend(integer) 6127.0.0.1:6379&gt; get test2 &quot;2apend&quot; å­—ç¬¦ä¸²é•¿åº¦12127.0.0.1:6379&gt; strlen test2(integer) 6 å“ˆå¸Œï¼ˆhashï¼‰HGET KEY_NAME FIELD_NAMEç±»ä¼¼javscripté‡Œçš„å¯¹è±¡ {} è®¾ç½®hash12127.0.0.1:6379&gt; HMSET hash name wclimb age 25OK èŽ·å–hash12127.0.0.1:6379&gt; hmget hash name1) &quot;wclimb&quot; åˆ é™¤hashhdel key field [field â€¦â€¦] ä¼šåˆ é™¤ä¸€ä¸ªæˆ–å¤šä¸ªfieldï¼Œè¿”å›žç»“æžœä¸ºæˆåŠŸåˆ é™¤fielçš„ä¸ªæ•° 1234127.0.0.1:6379&gt; hdel hash name(integer) 1127.0.0.1:6379&gt; hmget hash name // å†èŽ·å–å°±è¿”å›žnil1) (nil) èŽ·å–æ‰€æœ‰field12345678127.0.0.1:6379&gt; hkeys hash1) &quot;age&quot;127.0.0.1:6379&gt; HMSET hash name wclimb from jiangxiOK127.0.0.1:6379&gt; hkeys hash1) &quot;age&quot;2) &quot;name&quot;3) &quot;from&quot; èŽ·å–æ‰€æœ‰value1234127.0.0.1:6379&gt; hvals hash1) &quot;25&quot;2) &quot;wclimb&quot;3) &quot;jiangxi&quot; åˆ—è¡¨ï¼ˆlistï¼‰ æ“ä½œç±»åž‹ æ“ä½œ æ·»åŠ  rpush ã€lpushã€linsert æŸ¥ lrangeã€lindexã€llen åˆ é™¤ lpop ã€rpopã€ lremã€ltrim ä¿®æ”¹ lset é˜»å¡žæ“ä½œ blpopã€brpop æ·»åŠ ï¼ˆ1ï¼‰ä»Žå·¦è¾¹æ’å…¥å…ƒç´ lpush key value [valueâ€¦â€¦]12127.0.0.1:6379&gt; LPUSH list redis(integer) 1 ï¼ˆ1ï¼‰ä»Žå³è¾¹æ’å…¥å…ƒç´ rpush key value [valueâ€¦â€¦]12127.0.0.1:6379&gt; RPUSH list test(integer) 2 æŸ¥æ‰¾lrange key start end ç´¢å¼•ä¸‹æ ‡ä»Žå·¦åˆ°å³åˆ†åˆ«æ˜¯0åˆ°N-1ï¼Œä»Žå³åˆ°å·¦åˆ†åˆ«æ˜¯-1åˆ°-Nï¼›endé€‰é¡¹åŒ…å«äº†è‡ªèº«lrange key 0 -1 å¯ä»¥ä»Žå·¦åˆ°å³èŽ·å–åˆ—è¡¨çš„æ‰€æœ‰å…ƒç´ lrange mylist 1 3 èŽ·å–åˆ—è¡¨ä¸­ç¬¬2ä¸ªåˆ°ç¬¬4ä¸ªå…ƒç´  123127.0.0.1:6379&gt; lrange list 0 11) &quot;redis&quot;2) &quot;test&quot; é•¿åº¦12127.0.0.1:6379&gt; llen key(integer) 2 åˆ é™¤æˆ‘ä»¬å…ˆæ·»åŠ å‡ ä¸ª 12127.0.0.1:6379&gt; LPUSH list a b c(integer) 5 ï¼ˆ1ï¼‰ä»Žåˆ—è¡¨å³ä¾§å¼¹å‡ºå…ƒç´  rpop key ï¼ˆ2ï¼‰ä»Žåˆ—è¡¨å·¦ä¾§å¼¹å‡ºå…ƒç´  lpop key å…ˆçœ‹çœ‹çŽ°åœ¨çš„åˆ—è¡¨123456127.0.0.1:6379&gt; lrange list 0 -11) &quot;c&quot;2) &quot;b&quot;3) &quot;a&quot;4) &quot;redis&quot;5) &quot;test&quot; åˆ é™¤12127.0.0.1:6379&gt; rpop list &quot;test&quot; æˆ‘ä»¬å‘çŽ°testè¢«åˆ é™¤äº†ï¼ŒçŽ°åœ¨çœ‹çœ‹æˆ‘ä»¬çš„åˆ—è¡¨12345127.0.0.1:6379&gt; lrange list 0 -11) &quot;c&quot;2) &quot;b&quot;3) &quot;a&quot;4) &quot;redis&quot; ä¿®æ”¹lset key index newValue ä¿®æ”¹æŒ‡å®šç´¢å¼•ä¸‹æ ‡çš„å…ƒç´  1234567127.0.0.1:6379&gt; lset list 0 newValueOK127.0.0.1:6379&gt; lrange list 0 -11) &quot;newValue&quot;2) &quot;b&quot;3) &quot;a&quot;4) &quot;redis&quot; ç¬¬0ä¸ªä¸‹æ ‡çš„å…ƒç´ è¢«æ›¿æ¢æˆæœ€æ–°çš„å€¼ ä½¿ç”¨nodeè¿žæŽ¥redis1234&gt; npm init&gt; cnpm i reids -S&gt; touch index.js&gt; vim index.js è¿žæŽ¥redisredis npmåŒ…é“¾æŽ¥ https://www.npmjs.com/package/redis 123456var redis = require('redis');var client = redis.createClient(6379, '127.0.0.1');client.on('error', function(err) &#123; console.log('Error ' + err);&#125;); è®¾ç½®èŽ·å–key123456client.set('user', JSON.stringify(&#123; name: 'wclimb', age: '18' &#125;), redis.print);client.get('user', function(err, value) &#123; if (err) throw err; console.log('Got: ' + value); client.quit();&#125;); æŽ§åˆ¶å°æ‰“å° 123&gt; node index.jsReply: OKGot: &#123;&quot;name&quot;:&quot;wclimb&quot;,&quot;age&quot;:&quot;18&quot;&#125; è®¾ç½®èŽ·å–hash1234client.hmset("hosts", "mjr", "1", "another", "23", "home", "1234");client.hgetall("hosts", function (err, obj) &#123; console.dir(obj);&#125;); æŽ§åˆ¶å°æ‰“å°12&gt; node index.js&#123; mjr: &apos;1&apos;, another: &apos;23&apos;, home: &apos;1234&apos; &#125; è®¾ç½®èŽ·å–list12client.LPUSH('list', [1, 2, 3, 4], redis.print);client.lrange('list', '0', '-1', redis.print); æŽ§åˆ¶å°æ‰“å°123&gt; node index.jsReply: 8Reply: 4,3,2,1,newValue,b,a,redis åŸºæœ¬ç”¨æ³•å’Œä¸Šé¢è®²çš„éƒ½å·®ä¸å¤šï¼Œç›´æŽ¥ä¸ŠåŽ»ä¸€é¡¿å†™å°±å®Œäº‹äº†ï¼Œå®Œå…¨å¯ä»¥ä¸å¸¦è„‘å­çš„ä½¿ç”¨å„ç§api]]></content>
      <categories>
        <category>javascript</category>
        <category>redis</category>
        <category>node</category>
        <category>æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>Node</tag>
        <tag>redis</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹å®žçŽ°ä¸€ä¸ªç®€å•çš„Vue]]></title>
    <url>%2F2018%2F09%2F11%2FJavaScript%E4%B9%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84Vue%2F</url>
    <content type="text"><![CDATA[vueçš„ä½¿ç”¨ç›¸ä¿¡å¤§å®¶éƒ½å¾ˆç†Ÿç»ƒäº†ï¼Œä½¿ç”¨èµ·æ¥ç®€å•ã€‚ä½†æ˜¯å¤§éƒ¨åˆ†äººä¸çŸ¥é“å…¶å†…éƒ¨çš„åŽŸç†æ˜¯æ€Žä¹ˆæ ·çš„ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥ä¸€èµ·å®žçŽ°ä¸€ä¸ªç®€å•çš„vue Object.defineProperty()å®žçŽ°ä¹‹å‰æˆ‘ä»¬å¾—å…ˆçœ‹ä¸€ä¸‹Object.definePropertyçš„å®žçŽ°ï¼Œå› ä¸ºvueä¸»è¦æ˜¯é€šè¿‡æ•°æ®åŠ«æŒæ¥å®žçŽ°çš„ï¼Œé€šè¿‡getã€setæ¥å®Œæˆæ•°æ®çš„è¯»å–å’Œæ›´æ–°ã€‚ 1234567891011121314151617181920var obj = &#123;name:'wclimb'&#125;var age = 24Object.defineProperty(obj,'age',&#123; enumerable: true, // å¯æžšä¸¾ configurable: false, // ä¸èƒ½å†define get () &#123; return age &#125;, set (newVal) &#123; console.log('æˆ‘æ”¹å˜äº†',age +' -&gt; '+newVal); age = newVal &#125;&#125;)&gt; obj.age&gt; 24&gt; obj.age = 25;&gt; æˆ‘æ”¹å˜äº† 24 -&gt; 25&gt; 25 ä»Žä¸Šé¢å¯ä»¥çœ‹åˆ°é€šè¿‡getèŽ·å–æ•°æ®ï¼Œé€šè¿‡setç›‘å¬åˆ°æ•°æ®å˜åŒ–æ‰§è¡Œç›¸åº”æ“ä½œï¼Œè¿˜æ˜¯ä¸æ˜Žç™½çš„è¯å¯ä»¥åŽ»çœ‹çœ‹Object.definePropertyæ–‡æ¡£ã€‚ æµç¨‹å›¾ htmlä»£ç ç»“æž„1234567&lt;div id=&quot;wrap&quot;&gt; &lt;p v-html=&quot;test&quot;&gt;&lt;/p&gt; &lt;input type=&quot;text&quot; v-model=&quot;form&quot;&gt; &lt;input type=&quot;text&quot; v-model=&quot;form&quot;&gt; &lt;button @click=&quot;changeValue&quot;&gt;æ”¹å˜å€¼&lt;/button&gt; &#123;&#123;form&#125;&#125;&lt;/div&gt; jsè°ƒç”¨12345678910111213new Vue(&#123; el: '#wrap', data:&#123; form: 'è¿™æ˜¯formçš„å€¼', test: '&lt;strong&gt;æˆ‘æ˜¯ç²—ä½“&lt;/strong&gt;', &#125;, methods:&#123; changeValue()&#123; console.log(this.form) this.form = 'å€¼è¢«æˆ‘æ”¹å˜äº†ï¼Œæ°”ä¸æ°”ï¼Ÿ' &#125; &#125;&#125;) Vueç»“æž„1234567891011class Vue&#123; constructor()&#123;&#125; proxyData()&#123;&#125; observer()&#123;&#125; compile()&#123;&#125; compileText()&#123;&#125;&#125;class Watcher&#123; constructor()&#123;&#125; update()&#123;&#125;&#125; Vue constructor æž„é€ å‡½æ•°ä¸»è¦æ˜¯æ•°æ®çš„åˆå§‹åŒ– proxyData æ•°æ®ä»£ç† observer åŠ«æŒç›‘å¬æ‰€æœ‰æ•°æ® compile è§£æždom compileText è§£æždomé‡Œå¤„ç†çº¯åŒèŠ±æ‹¬å·çš„æ“ä½œ Watcher æ›´æ–°è§†å›¾æ“ä½œ Vue constructor åˆå§‹åŒ–1234567891011121314class Vue&#123; constructor(options = &#123;&#125;)&#123; this.$el = document.querySelector(options.el); let data = this.data = options.data; // ä»£ç†dataï¼Œä½¿å…¶èƒ½ç›´æŽ¥this.xxxçš„æ–¹å¼è®¿é—®dataï¼Œæ­£å¸¸çš„è¯éœ€è¦this.data.xxx Object.keys(data).forEach((key)=&gt; &#123; this.proxyData(key); &#125;); this.methods = options.methods // äº‹ä»¶æ–¹æ³• this.watcherTask = &#123;&#125;; // éœ€è¦ç›‘å¬çš„ä»»åŠ¡åˆ—è¡¨ this.observer(data); // åˆå§‹åŒ–åŠ«æŒç›‘å¬æ‰€æœ‰æ•°æ® this.compile(this.$el); // è§£æždom &#125;&#125; ä¸Šé¢ä¸»è¦æ˜¯åˆå§‹åŒ–æ“ä½œï¼Œé’ˆå¯¹ä¼ è¿‡æ¥çš„æ•°æ®è¿›è¡Œå¤„ç† proxyData ä»£ç†data123456789101112131415161718class Vue&#123; constructor(options = &#123;&#125;)&#123; ...... &#125; proxyData(key)&#123; let that = this; Object.defineProperty(that, key, &#123; configurable: false, enumerable: true, get () &#123; return that.data[key]; &#125;, set (newVal) &#123; that.data[key] = newVal; &#125; &#125;); &#125; &#125; ä¸Šé¢ä¸»è¦æ˜¯ä»£ç†dataåˆ°æœ€ä¸Šå±‚ï¼Œthis.xxxçš„æ–¹å¼ç›´æŽ¥è®¿é—®data observer åŠ«æŒç›‘å¬123456789101112131415161718192021222324252627282930class Vue&#123; constructor(options = &#123;&#125;)&#123; ...... &#125; proxyData(key)&#123; ...... &#125; observer(data)&#123; let that = this Object.keys(data).forEach(key=&gt;&#123; let value = data[key] this.watcherTask[key] = [] Object.defineProperty(data,key,&#123; configurable: false, enumerable: true, get()&#123; return value &#125;, set(newValue)&#123; if(newValue !== value)&#123; value = newValue that.watcherTask[key].forEach(task =&gt; &#123; task.update() &#125;) &#125; &#125; &#125;) &#125;) &#125; &#125; åŒæ ·æ˜¯ä½¿ç”¨Object.definePropertyæ¥ç›‘å¬æ•°æ®ï¼Œåˆå§‹åŒ–éœ€è¦è®¢é˜…çš„æ•°æ®ã€‚æŠŠéœ€è¦è®¢é˜…çš„æ•°æ®åˆ°pushåˆ°watcherTaské‡Œï¼Œç­‰åˆ°æ—¶å€™éœ€è¦æ›´æ–°çš„æ—¶å€™å°±å¯ä»¥æ‰¹é‡æ›´æ–°æ•°æ®äº†ã€‚ðŸ‘‡ä¸‹é¢å°±æ˜¯ï¼›éåŽ†è®¢é˜…æ± ï¼Œæ‰¹é‡æ›´æ–°è§†å›¾ã€‚123456789set(newValue)&#123; if(newValue !== value)&#123; value = newValue // æ‰¹é‡æ›´æ–°è§†å›¾ that.watcherTask[key].forEach(task =&gt; &#123; task.update() &#125;) &#125;&#125; compile è§£æždom12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667class Vue&#123; constructor(options = &#123;&#125;)&#123; ...... &#125; proxyData(key)&#123; ...... &#125; observer(data)&#123; ...... &#125; compile(el)&#123; var nodes = el.childNodes; for (let i = 0; i &lt; nodes.length; i++) &#123; const node = nodes[i]; if(node.nodeType === 3)&#123; var text = node.textContent.trim(); if (!text) continue; this.compileText(node,'textContent') &#125;else if(node.nodeType === 1)&#123; if(node.childNodes.length &gt; 0)&#123; this.compile(node) &#125; if(node.hasAttribute('v-model') &amp;&amp; (node.tagName === 'INPUT' || node.tagName === 'TEXTAREA'))&#123; node.addEventListener('input',(()=&gt;&#123; let attrVal = node.getAttribute('v-model') this.watcherTask[attrVal].push(new Watcher(node,this,attrVal,'value')) node.removeAttribute('v-model') return () =&gt; &#123; this.data[attrVal] = node.value &#125; &#125;)()) &#125; if(node.hasAttribute('v-html'))&#123; let attrVal = node.getAttribute('v-html'); this.watcherTask[attrVal].push(new Watcher(node,this,attrVal,'innerHTML')) node.removeAttribute('v-html') &#125; this.compileText(node,'innerHTML') if(node.hasAttribute('@click'))&#123; let attrVal = node.getAttribute('@click') node.removeAttribute('@click') node.addEventListener('click',e =&gt; &#123; this.methods[attrVal] &amp;&amp; this.methods[attrVal].bind(this)() &#125;) &#125; &#125; &#125; &#125;, compileText(node,type)&#123; let reg = /\&#123;\&#123;(.*?)\&#125;\&#125;/g, txt = node.textContent; if(reg.test(txt))&#123; node.textContent = txt.replace(reg,(matched,value)=&gt;&#123; let tpl = this.watcherTask[value] || [] tpl.push(new Watcher(node,this,value,type)) if(value.split('.').length &gt; 1)&#123; let v = null value.split('.').forEach((val,i)=&gt;&#123; v = !v ? this[val] : v[val] &#125;) return v &#125;else&#123; return this[value] &#125; &#125;) &#125; &#125; &#125; è¿™é‡Œä»£ç æ¯”è¾ƒå¤šï¼Œæˆ‘ä»¬æ‹†åˆ†çœ‹ä½ å°±ä¼šè§‰å¾—å¾ˆç®€å•äº† é¦–å…ˆæˆ‘ä»¬å…ˆéåŽ†elå…ƒç´ ä¸‹é¢çš„æ‰€æœ‰å­èŠ‚ç‚¹ï¼Œnode.nodeType === 3 çš„æ„æ€æ˜¯å½“å‰å…ƒç´ æ˜¯æ–‡æœ¬èŠ‚ç‚¹ï¼Œnode.nodeType === 1 çš„æ„æ€æ˜¯å½“å‰å…ƒç´ æ˜¯å…ƒç´ èŠ‚ç‚¹ã€‚å› ä¸ºå¯èƒ½æœ‰çš„æ˜¯çº¯æ–‡æœ¬çš„å½¢å¼ï¼Œå¦‚çº¯åŒèŠ±æ‹¬å·å°±æ˜¯çº¯æ–‡æœ¬çš„æ–‡æœ¬èŠ‚ç‚¹ï¼Œç„¶åŽé€šè¿‡åˆ¤æ–­å…ƒç´ èŠ‚ç‚¹æ˜¯å¦è¿˜å­˜åœ¨å­èŠ‚ç‚¹ï¼Œå¦‚æžœæœ‰çš„è¯å°±é€’å½’è°ƒç”¨compileæ–¹æ³•ã€‚ä¸‹é¢é‡å¤´æˆæ¥äº†ï¼Œæˆ‘ä»¬æ‹†å¼€çœ‹ï¼š12345if(node.hasAttribute('v-html'))&#123; let attrVal = node.getAttribute('v-html'); this.watcherTask[attrVal].push(new Watcher(node,this,attrVal,'innerHTML')) node.removeAttribute('v-html')&#125; ä¸Šé¢è¿™ä¸ªé¦–å…ˆåˆ¤æ–­nodeèŠ‚ç‚¹ä¸Šæ˜¯å¦æœ‰v-htmlè¿™ç§æŒ‡ä»¤ï¼Œå¦‚æžœå­˜åœ¨çš„è¯ï¼Œæˆ‘ä»¬å°±å‘å¸ƒè®¢é˜…ï¼Œæ€Žä¹ˆå‘å¸ƒè®¢é˜…å‘¢ï¼Ÿåªéœ€è¦æŠŠå½“å‰éœ€è¦è®¢é˜…çš„æ•°æ®pushåˆ°watcherTaské‡Œé¢ï¼Œç„¶åŽåˆ°æ—¶å€™åœ¨è®¾ç½®å€¼çš„æ—¶å€™å°±å¯ä»¥æ‰¹é‡æ›´æ–°äº†ï¼Œå®žçŽ°åŒå‘æ•°æ®ç»‘å®šï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢çš„æ“ä½œ123that.watcherTask[key].forEach(task =&gt; &#123; task.update()&#125;) ç„¶åŽpushçš„å€¼æ˜¯ä¸€ä¸ªWatcherçš„å®žä¾‹ï¼Œé¦–å…ˆä»–newçš„æ—¶å€™ä¼šå…ˆæ‰§è¡Œä¸€æ¬¡ï¼Œæ‰§è¡Œçš„æ“ä½œå°±æ˜¯åŽ»æŠŠçº¯åŒèŠ±æ‹¬å· -&gt; 1ï¼Œä¹Ÿå°±æ˜¯è¯´æŠŠæˆ‘ä»¬å†™å¥½çš„æ¨¡æ¿æ•°æ®æ›´æ–°åˆ°æ¨¡æ¿è§†å›¾ä¸Šã€‚æœ€åŽæŠŠå½“å‰å…ƒç´ å±žæ€§å‰”é™¤å‡ºåŽ»ï¼Œæˆ‘ä»¬ç”¨Vueçš„æ—¶å€™ä¹Ÿæ˜¯çœ‹ä¸åˆ°è¿™ç§æŒ‡ä»¤çš„ï¼Œä¸å‰”é™¤ä¹Ÿä¸å½±å“ è‡³äºŽWatcheræ˜¯ä»€ä¹ˆï¼Œçœ‹ä¸‹é¢å°±çŸ¥é“äº† Watcher123456789101112class Watcher&#123; constructor(el,vm,value,type)&#123; this.el = el; this.vm = vm; this.value = value; this.type = type; this.update() &#125; update()&#123; this.el[this.type] = this.vm.data[this.value] &#125;&#125; ä¹‹å‰å‘å¸ƒè®¢é˜…ä¹‹åŽèµ°äº†è¿™é‡Œé¢çš„æ“ä½œï¼Œæ„æ€å°±æ˜¯æŠŠå½“å‰å…ƒç´ å¦‚ï¼šnode.innerHTML = â€˜è¿™æ˜¯dataé‡Œé¢çš„å€¼â€™ã€node.value = â€˜è¿™ä¸ªæ˜¯è¡¨å•çš„æ•°æ®â€™ é‚£ä¹ˆæˆ‘ä»¬ä¸ºä»€ä¹ˆä¸ç›´æŽ¥åŽ»æ›´æ–°å‘¢ï¼Œè¿˜éœ€è¦updateåšä»€ä¹ˆï¼Œä¸æ˜¯å¤šæ­¤ä¸€ä¸¾å—ï¼Ÿå…¶å®župdateè®°å¾—å—ï¼Ÿæˆ‘ä»¬åœ¨è®¢é˜…æ± é‡Œé¢éœ€è¦æ‰¹é‡æ›´æ–°ï¼Œå°±æ˜¯é€šè¿‡è°ƒç”¨WatcheråŽŸåž‹ä¸Šçš„updateæ–¹æ³•ã€‚ æ•ˆæžœåœ¨çº¿æ•ˆæžœåœ°å€ï¼Œå¤§å®¶å¯ä»¥æµè§ˆå™¨çœ‹ä¸€ä¸‹æ•ˆæžœï¼Œç”±äºŽæœ¬äººå¤ªæ‡’äº†ï¼Œgifæ•ˆæžœå›¾å°±å…ˆä¸æ”¾äº†ï¼Œå“ˆå“ˆðŸ˜„ðŸ˜„ å®Œæ•´ä»£ç å®Œæ•´ä»£ç å·²ç»æ”¾åˆ°githubä¸Šäº† -&gt; MyVue å‚è€ƒå‰–æžVueåŽŸç†&amp;å®žçŽ°åŒå‘ç»‘å®šMVVMä»¿Vueå®žçŽ°æžç®€åŒå‘ç»‘å®š QQç¾¤æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥åŠ qqç¾¤: 725165362 ç‚¹å‡»åŠ å…¥]]></content>
      <categories>
        <category>javascript</category>
        <category>vue</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹Web Worker]]></title>
    <url>%2F2018%2F09%2F10%2FJavaScript%E4%B9%8BWeb-Worker%2F</url>
    <content type="text"><![CDATA[ä»‹ç» Web Workerä¸ºWebå†…å®¹åœ¨åŽå°çº¿ç¨‹ä¸­è¿è¡Œè„šæœ¬æä¾›äº†ä¸€ç§ç®€å•çš„æ–¹æ³•ã€‚çº¿ç¨‹å¯ä»¥æ‰§è¡Œä»»åŠ¡è€Œä¸å¹²æ‰°ç”¨æˆ·ç•Œé¢ã€‚æ­¤å¤–ï¼Œä»–ä»¬å¯ä»¥ä½¿ç”¨XMLHttpRequestæ‰§è¡Œ I/O (å°½ç®¡responseXMLå’Œchannelå±žæ€§æ€»æ˜¯ä¸ºç©º)ã€‚ä¸€æ—¦åˆ›å»ºï¼Œ ä¸€ä¸ªworker å¯ä»¥å°†æ¶ˆæ¯å‘é€åˆ°åˆ›å»ºå®ƒçš„JavaScriptä»£ç , é€šè¿‡å°†æ¶ˆæ¯å‘å¸ƒåˆ°è¯¥ä»£ç æŒ‡å®šçš„äº‹ä»¶å¤„ç†ç¨‹åºï¼ˆåä¹‹äº¦ç„¶ï¼‰ã€‚ Web Workerä½¿ç”¨è¦ç‚¹ åŒæºé™åˆ¶ï¼šåˆ†é…ç»™ Worker çº¿ç¨‹è¿è¡Œçš„è„šæœ¬æ–‡ä»¶ï¼Œå¿…é¡»ä¸Žä¸»çº¿ç¨‹çš„è„šæœ¬æ–‡ä»¶åŒæºã€‚ DOM é™åˆ¶ï¼šWorker çº¿ç¨‹æ‰€åœ¨çš„å…¨å±€å¯¹è±¡ï¼Œä¸Žä¸»çº¿ç¨‹ä¸ä¸€æ ·ï¼Œæ— æ³•è¯»å–ä¸»çº¿ç¨‹æ‰€åœ¨ç½‘é¡µçš„ DOM å¯¹è±¡ï¼Œä¹Ÿæ— æ³•ä½¿ç”¨documentã€windowã€parentè¿™äº›å¯¹è±¡ã€‚ä½†æ˜¯ï¼ŒWorker çº¿ç¨‹å¯ä»¥navigatorå¯¹è±¡å’Œlocationå¯¹è±¡ã€‚ é€šä¿¡è”ç³»ï¼šWorker çº¿ç¨‹å’Œä¸»çº¿ç¨‹ä¸åœ¨åŒä¸€ä¸ªä¸Šä¸‹æ–‡çŽ¯å¢ƒï¼Œå®ƒä»¬ä¸èƒ½ç›´æŽ¥é€šä¿¡ï¼Œå¿…é¡»é€šè¿‡æ¶ˆæ¯å®Œæˆã€‚ è„šæœ¬é™åˆ¶ï¼šWorker çº¿ç¨‹ä¸èƒ½æ‰§è¡Œalert()æ–¹æ³•å’Œconfirm()æ–¹æ³•ï¼Œä½†å¯ä»¥ä½¿ç”¨ XMLHttpRequest å¯¹è±¡å‘å‡º AJAX è¯·æ±‚ã€‚ æ–‡ä»¶é™åˆ¶ï¼šWorker çº¿ç¨‹æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå³ä¸èƒ½æ‰“å¼€æœ¬æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfile://ï¼‰ï¼Œå®ƒæ‰€åŠ è½½çš„è„šæœ¬ï¼Œå¿…é¡»æ¥è‡ªç½‘ç»œã€‚åŽé¢æˆ‘ä»¬å…è®¸ä¼šåšå¤„ç†ã€‚ å®‰è£…http-serverWorker çº¿ç¨‹æ— æ³•è¯»å–æœ¬åœ°æ–‡ä»¶ï¼Œå³ä¸èƒ½æ‰“å¼€æœ¬æœºçš„æ–‡ä»¶ç³»ç»Ÿï¼ˆfile://ï¼‰ï¼Œå®ƒæ‰€åŠ è½½çš„è„šæœ¬ï¼Œå¿…é¡»æ¥è‡ªç½‘ç»œã€‚æ‰€ä»¥æˆ‘ä»¬å¾—èµ·ä¸€ä¸ªé¡¹ç›®ã€‚ä½¿ç”¨http-serveræœ€ç®€å•å®‰è£…ï¼š1&gt; cnpm i -g http-server ä½¿ç”¨ï¼š1&gt; http-server åŸºæœ¬ä½¿ç”¨æˆ‘ä»¬æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹åå«workerï¼Œé‡Œé¢æ–°å»ºä¸‰ä¸ªæ–‡ä»¶åˆ†åˆ«æ˜¯123index.htmlmain.jsworker.js æ–°å»ºä¸€ä¸ªworkerçº¿ç¨‹å¾ˆç®€å•ï¼Œåªéœ€ï¼š 1var worker = new Worker(&apos;worker.js&apos;) main.js:12345678910var worker = new Worker('./worker.js')console.log('worker running')worker.addEventListener('message',e =&gt; &#123; console.log('main: ', e.data);&#125;)// ä¹Ÿå¯ä½¿ç”¨ï¼š// worker.onmessage = (e)=&gt;&#123;// console.log('main: ', e.data);// &#125;worker.postMessage('hello worker,I am from main.js') worker.js:123456console.log('worker task running')onmessage = (e)=&gt;&#123; console.log('worker task receive', e.data); // å‘é€æ•°æ®äº‹ä»¶ postMessage('Hello, I am from Worker.js');&#125; åœ¨workeræ–‡ä»¶å¤¹ä¸‹ï¼Œå‘½ä»¤è¡Œè¾“å…¥http-server,å¯åŠ¨é¡¹ç›®ï¼Œç”¨æµè§ˆå™¨æ‰“å¼€ï¼Œçœ‹æŽ§åˆ¶å°ï¼š1234worker runningworker task runningworker task receive hello worker,I am from main.jsmain: Hello, I am from Worker.js ä»Žä¸Šé¢å¯ä»¥çœ‹åˆ°ï¼Œworkeré€šè¿‡onmessageæ¥ç›‘å¬æ•°æ®ï¼Œé€šè¿‡postMessgaeæ¥å‘é€æ•°æ® ç»ˆæ­¢ worker1worker.terminate(); å¤„ç†é”™è¯¯123worker.addEventListener(&apos;error&apos;, (e) =&gt; &#123; console.log(&apos;main error&apos;, &apos;filename:&apos; + e.filename + &apos;message:&apos; + e.message + &apos;lineno:&apos; + e.lineno;&#125;); event.filename: å¯¼è‡´é”™è¯¯çš„ Worker è„šæœ¬çš„åç§°ï¼› event.message: é”™è¯¯çš„ä¿¡æ¯ï¼› event.lineno: å‡ºçŽ°é”™è¯¯çš„è¡Œå·ï¼› åŠ è½½å¤–éƒ¨è„šæœ¬main.js1var worker = new Worker('./worker1.js'); worker1.js12345console.log("I'm worker1")importScripts('worker2.js', 'worker3.js');// æˆ–è€…// importScripts('worker2.js');// importScripts('worker3.js'); worker2.js1console.log("I'm worker2") worker3.js1console.log("I'm worker3") å…¼å®¹æ€§https://caniuse.com/#feat=webworkerså…¼å®¹æ€§è¿˜ä¸æ˜¯å¾ˆä¹è§‚ï¼Œä¸è¿‡åœ¨ç§»åŠ¨ç«¯çš„å…¼å®¹æ€§è¿˜ä¸é”™ å‚è€ƒä½¿ç”¨ Web WorkersWeb Worker ä½¿ç”¨æ•™ç¨‹]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹å®žçŽ°ä¸€ä¸ªç®€å•çš„promise]]></title>
    <url>%2F2018%2F09%2F09%2FJavaScript%E4%B9%8B%E5%AE%9E%E7%8E%B0%E4%B8%80%E4%B8%AA%E7%AE%80%E5%8D%95%E7%9A%84promise%2F</url>
    <content type="text"><![CDATA[æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­å¤§å¤šä¼šç”¨åˆ°promiseï¼Œæƒ³å¿…å¤§å®¶å¯¹promiseçš„ä½¿ç”¨éƒ½å¾ˆç†Ÿç»ƒäº†ï¼Œä»Šå¤©æˆ‘ä»¬å°±æ¥å®žçŽ°ä¸€ä¸ªç®€å•çš„promiseï¼Œå®žçŽ°çš„æ•ˆæžœå¦‚æœ‰å‡ºå…¥è¿˜å¾€æŒ‡æ­£ã€‚ æ•´ä½“ç»“æž„æˆ‘ä»¬å…ˆæ¥æ¢³ç†ä¸€ä¸‹æ•´ä½“çš„ç»“æžœï¼Œä»¥ä¾¿åŽç»­å¥½æ“ä½œ 1234567891011121314151617class MyPromise &#123; constructor(fn)&#123; &#125; resolve()&#123; &#125; then()&#123; &#125; reject()&#123; &#125; catch()&#123; &#125;&#125; Promiseç†è®ºçŸ¥è¯† æ‘˜æŠ„è‡³ http://es6.ruanyifeng.com/#docs/promise#Promise-all Promiseå¯¹è±¡æœ‰ä»¥ä¸‹ä¸¤ä¸ªç‰¹ç‚¹ã€‚ ï¼ˆ1ï¼‰å¯¹è±¡çš„çŠ¶æ€ä¸å—å¤–ç•Œå½±å“ã€‚Promiseå¯¹è±¡ä»£è¡¨ä¸€ä¸ªå¼‚æ­¥æ“ä½œï¼Œæœ‰ä¸‰ç§çŠ¶æ€ï¼špendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰å’Œrejectedï¼ˆå·²å¤±è´¥ï¼‰ã€‚åªæœ‰å¼‚æ­¥æ“ä½œçš„ç»“æžœï¼Œå¯ä»¥å†³å®šå½“å‰æ˜¯å“ªä¸€ç§çŠ¶æ€ï¼Œä»»ä½•å…¶ä»–æ“ä½œéƒ½æ— æ³•æ”¹å˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™ä¹Ÿæ˜¯Promiseè¿™ä¸ªåå­—çš„ç”±æ¥ï¼Œå®ƒçš„è‹±è¯­æ„æ€å°±æ˜¯â€œæ‰¿è¯ºâ€ï¼Œè¡¨ç¤ºå…¶ä»–æ‰‹æ®µæ— æ³•æ”¹å˜ã€‚ ï¼ˆ2ï¼‰ä¸€æ—¦çŠ¶æ€æ”¹å˜ï¼Œå°±ä¸ä¼šå†å˜ï¼Œä»»ä½•æ—¶å€™éƒ½å¯ä»¥å¾—åˆ°è¿™ä¸ªç»“æžœã€‚Promiseå¯¹è±¡çš„çŠ¶æ€æ”¹å˜ï¼Œåªæœ‰ä¸¤ç§å¯èƒ½ï¼šä»Žpendingå˜ä¸ºfulfilledå’Œä»Žpendingå˜ä¸ºrejectedã€‚åªè¦è¿™ä¸¤ç§æƒ…å†µå‘ç”Ÿï¼ŒçŠ¶æ€å°±å‡å›ºäº†ï¼Œä¸ä¼šå†å˜äº†ï¼Œä¼šä¸€ç›´ä¿æŒè¿™ä¸ªç»“æžœï¼Œè¿™æ—¶å°±ç§°ä¸º resolvedï¼ˆå·²å®šåž‹ï¼‰ã€‚å¦‚æžœæ”¹å˜å·²ç»å‘ç”Ÿäº†ï¼Œä½ å†å¯¹Promiseå¯¹è±¡æ·»åŠ å›žè°ƒå‡½æ•°ï¼Œä¹Ÿä¼šç«‹å³å¾—åˆ°è¿™ä¸ªç»“æžœã€‚è¿™ä¸Žäº‹ä»¶ï¼ˆEventï¼‰å®Œå…¨ä¸åŒï¼Œäº‹ä»¶çš„ç‰¹ç‚¹æ˜¯ï¼Œå¦‚æžœä½ é”™è¿‡äº†å®ƒï¼Œå†åŽ»ç›‘å¬ï¼Œæ˜¯å¾—ä¸åˆ°ç»“æžœçš„ã€‚ æ€»ç»“ä¸€ä¸‹å°±æ˜¯promiseæœ‰ä¸‰ç§çŠ¶æ€ï¼špendingï¼ˆè¿›è¡Œä¸­ï¼‰ã€fulfilledï¼ˆå·²æˆåŠŸï¼‰å’Œrejectedï¼ˆå·²å¤±è´¥ï¼‰ï¼Œè¿˜æœ‰å°±æ˜¯çŠ¶æ€çš„æ”¹å˜åªèƒ½æ˜¯pending -&gt; fulfilled æˆ–è€… pending -&gt; rejectedï¼Œè¿™äº›å¾ˆé‡è¦ å®žçŽ°æž„é€ å‡½æ•°çŽ°åœ¨æˆ‘ä»¬å¼€å§‹å®žçŽ°æž„é€ å‡½æ•° 1234567891011class MyPromise &#123; constructor(fn)&#123; if(typeof fn !== 'function') &#123; throw new TypeError(`MyPromise fn $&#123;fn&#125; is not a function`) &#125; this.state = 'pending'; this.value = void 0; fn(this.resolve.bind(this),this.reject.bind(this)) &#125; ...&#125; æž„é€ å‡½æ•°æŽ¥æ”¶ä¸€ä¸ªå‚æ•°fnï¼Œä¸”è¿™ä¸ªå‚æ•°å¿…é¡»æ˜¯ä¸€ä¸ªå‡½æ•°ï¼Œå› ä¸ºæˆ‘ä»¬ä¸€èˆ¬è¿™æ ·ä½¿ç”¨new Promise((resolve,reject)=&gt;{});ç„¶åŽåˆå§‹åŒ–ä¸€ä¸‹promiseçš„çŠ¶æ€ï¼Œé»˜è®¤å¼€å§‹ä¸ºpendingï¼Œåˆå§‹åŒ–valueçš„å€¼ã€‚fnæŽ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼Œresolveã€reject resolve12345678910111213141516class MyPromise &#123; constructor(fn)&#123; if(typeof fn !== 'function') &#123; throw new TypeError(`MyPromise fn $&#123;fn&#125; is not a function`) &#125; this.state = 'pending'; this.value = void 0; fn(this.resolve.bind(this),this.reject.bind(this)) &#125; resolve(value)&#123; if(this.state !== 'pending') return; this.state = 'fulfilled'; this.value = value &#125; ...&#125; å½“resolveæ‰§è¡Œï¼ŒæŽ¥æ”¶åˆ°ä¸€ä¸ªå€¼ä¹‹åŽï¼›çŠ¶æ€å°±ç”± pending -&gt; fulfilledï¼›å½“å‰çš„å€¼ä¸ºæŽ¥æ”¶çš„å€¼ reject1234567891011121314151617181920class MyPromise &#123; constructor(fn)&#123; if(typeof fn !== 'function') &#123; throw new TypeError(`MyPromise fn $&#123;fn&#125; is not a function`) &#125; this.state = 'pending'; this.value = void 0; fn(this.resolve.bind(this),this.reject.bind(this)) &#125; resolve(value)&#123; if(this.state !== 'pending') return; this.state = 'fulfilled'; this.value = value &#125; reject(reason)&#123; if(this.state !== 'pending') return; this.state = 'rejected'; this.value = reason &#125;&#125; å½“rejectæ‰§è¡Œï¼ŒæŽ¥æ”¶åˆ°ä¸€ä¸ªå€¼ä¹‹åŽï¼›çŠ¶æ€å°±ç”± pending -&gt; rejectedï¼›å½“å‰çš„å€¼ä¸ºæŽ¥æ”¶çš„å€¼ then1234567891011121314151617181920212223242526272829303132333435363738394041424344454647class MyPromise &#123; constructor(fn)&#123; if(typeof fn !== 'function') &#123; throw new TypeError(`MyPromise fn $&#123;fn&#125; is not a function`) &#125; this.state = 'pending'; this.value = void 0; fn(this.resolve.bind(this),this.reject.bind(this)) &#125; resolve(value)&#123; if(this.state !== 'pending') return; this.state = 'fulfilled'; this.value = value &#125; reject(reason)&#123; if(this.state !== 'pending') return; this.state = 'rejected'; this.value = reason &#125; then(fulfilled,rejected)&#123; if (typeof fulfilled !== 'function' &amp;&amp; typeof rejected !== 'function' ) &#123; return this; &#125; if (typeof fulfilled !== 'function' &amp;&amp; this.state === 'fulfilled' || typeof rejected !== 'function' &amp;&amp; this.state === 'rejected') &#123; return this; &#125; return new MyPromise((resolve,reject)=&gt;&#123; if(fulfilled &amp;&amp; typeof fulfilled === 'function' &amp;&amp; this.state === 'fulfilled')&#123; let result = fulfilled(this.value); if(result &amp;&amp; typeof result.then === 'function')&#123; return result.then(resolve,reject) &#125;else&#123; resolve(result) &#125; &#125; if(rejected &amp;&amp; typeof rejected === 'function' &amp;&amp; this.state === 'rejected')&#123; let result = rejected(this.value); if(result &amp;&amp; typeof result.then === 'function')&#123; return result.then(resolve,reject) &#125;else&#123; resolve(result) &#125; &#125; &#125;) &#125;&#125; thençš„å®žçŽ°æ¯”è¾ƒå…³é”®ï¼Œé¦–å…ˆæœ‰ä¸¤ä¸ªåˆ¤æ–­ï¼Œç¬¬ä¸€ä¸ªåˆ¤æ–­ä¼ çš„ä¸¤ä¸ªå‚æ•°æ˜¯å¦éƒ½æ˜¯å‡½æ•°ï¼Œå¦‚æžœéƒ¨ä¸æ˜¯return thisæ‰§è¡Œä¸‹ä¸€æ­¥æ“ä½œã€‚ç¬¬äºŒä¸ªåˆ¤æ–­çš„ä½œç”¨æ˜¯ï¼Œæ¯”å¦‚ï¼ŒçŽ°åœ¨çŠ¶æ€ä»Žpending -&gt; rejected;ä½†æ˜¯ä¸­é—´ä»£ç ä¸­æœ‰è®¸å¤šä¸ª.thençš„æ“ä½œï¼Œæˆ‘ä»¬éœ€è¦è·³è¿‡è¿™äº›æ“ä½œæ‰§è¡Œ.catchçš„ä»£ç ã€‚å¦‚ä¸‹é¢çš„ä»£ç ï¼Œæ‰§è¡Œç»“æžœåªä¼šæ‰“å°1123456789new Promise((resolve,reject)=&gt;&#123; reject(1)&#125;).then(()=&gt;&#123; console.log(2)&#125;).then(()=&gt;&#123; console.log(3)&#125;).catch((e)=&gt;&#123; console.log(e)&#125;) æˆ‘ä»¬ç»§ç»­ï¼ŒæŽ¥ä¸‹æ¥çœ‹åˆ°çš„æ˜¯è¿”å›žäº†ä¸€ä¸ªæ–°çš„promiseï¼ŒçœŸæ­£thençš„å®žçŽ°çš„ç¡®éƒ½æ˜¯è¿”å›žä¸€ä¸ªpromiseå®žä¾‹ã€‚è¿™é‡Œä¸å¤šè¯´ ä¸‹é¢æœ‰ä¸¤ä¸ªåˆ¤æ–­ï¼Œä½œç”¨æ˜¯åˆ¤æ–­æ˜¯rejectedè¿˜æ˜¯fulfilled,é¦–å…ˆçœ‹fulfilledï¼Œå¦‚æžœæ˜¯fulfilledçš„è¯ï¼Œé¦–å…ˆæ‰§è¡Œfulfilledå‡½æ•°ï¼Œå¹¶æŠŠå½“å‰çš„valueå€¼ä¼ è¿‡åŽ»ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢è¿™æ­¥æ“ä½œ,reså°±æ˜¯ä¼ è¿‡åŽ»çš„valueå€¼ï¼Œå¹¶æ‰§è¡Œäº†(res)=&gt;{console.log(res)}è¿™æ®µä»£ç ;æ‰§è¡Œå®Œæˆä¹‹åŽæˆ‘ä»¬å¾—åˆ°äº†resultï¼›ä¹Ÿå°±æ˜¯2è¿™ä¸ªç»“æžœï¼Œä¸‹é¢å°±æ˜¯åˆ¤æ–­å½“å‰ç»“æžœæ˜¯å¦æ˜¯ä¸€ä¸ªpromiseå®žä¾‹äº†ï¼Œä¹Ÿå°±æ˜¯ä¸‹é¢æ³¨é‡Šäº†çš„æƒ…å†µï¼ŒçŽ°åœ¨æˆ‘ä»¬ç›´æŽ¥æ‰§è¡Œresolve(result);1234567new Promise((resolve,reject)=&gt;&#123; resolve(1)&#125;).then((res)=&gt;&#123; console.log(res) return 2 //return new Promise(resolve=&gt;&#123;&#125;)&#125;) å‰©ä¸‹çš„å°±ä¸å¤šè¯´äº†ï¼Œå¯ä»¥debuggerçœ‹çœ‹æ‰§è¡Œç»“æžœ catch123456class MyPromise &#123; ... catch(rejected)&#123; return this.then(null,rejected) &#125;&#125; å®Œæ•´ä»£ç 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950class MyPromise &#123; constructor(fn)&#123; if(typeof fn !== 'function') &#123; throw new TypeError(`MyPromise fn $&#123;fn&#125; is not a function`) &#125; this.state = 'pending'; this.value = void 0; fn(this.resolve.bind(this),this.reject.bind(this)) &#125; resolve(value)&#123; if(this.state !== 'pending') return; this.state = 'fulfilled'; this.value = value &#125; reject(reason)&#123; if(this.state !== 'pending') return; this.state = 'rejected'; this.value = reason &#125; then(fulfilled,rejected)&#123; if (typeof fulfilled !== 'function' &amp;&amp; typeof rejected !== 'function' ) &#123; return this; &#125; if (typeof fulfilled !== 'function' &amp;&amp; this.state === 'fulfilled' || typeof rejected !== 'function' &amp;&amp; this.state === 'rejected') &#123; return this; &#125; return new MyPromise((resolve,reject)=&gt;&#123; if(fulfilled &amp;&amp; typeof fulfilled === 'function' &amp;&amp; this.state === 'fulfilled')&#123; let result = fulfilled(this.value); if(result &amp;&amp; typeof result.then === 'function')&#123; return result.then(resolve,reject) &#125;else&#123; resolve(result) &#125; &#125; if(rejected &amp;&amp; typeof rejected === 'function' &amp;&amp; this.state === 'rejected')&#123; let result = rejected(this.value); if(result &amp;&amp; typeof result.then === 'function')&#123; return result.then(resolve,reject) &#125;else&#123; resolve(result) &#125; &#125; &#125;) &#125; catch(rejected)&#123; return this.then(null,rejected) &#125;&#125; æµ‹è¯•123456789101112131415161718192021222324new MyPromise((resolve,reject)=&gt;&#123; console.log(1); //reject(2) resolve(2) console.log(3) setTimeout(()=&gt;&#123;console.log(4)&#125;,0)&#125;).then(res=&gt;&#123; console.log(res) return new MyPromise((resolve,reject)=&gt;&#123; resolve(5) &#125;).then(res=&gt;&#123; return res &#125;)&#125;).then(res=&gt;&#123; console.log(res)&#125;).catch(e=&gt;&#123; console.log('e',e)&#125;)æ‰§è¡Œç»“æžœï¼š&gt; 1&gt; 3&gt; 2&gt; 5&gt; 4 åŽŸç”Ÿpromise123456789101112131415161718192021222324new Promise((resolve,reject)=&gt;&#123; console.log(1); //reject(2) resolve(2) console.log(3) setTimeout(()=&gt;&#123;console.log(4)&#125;,0)&#125;).then(res=&gt;&#123; console.log(res) return new Promise((resolve,reject)=&gt;&#123; resolve(5) &#125;).then(res=&gt;&#123; return res &#125;)&#125;).then(res=&gt;&#123; console.log(res)&#125;).catch(e=&gt;&#123; console.log('e',e)&#125;)æ‰§è¡Œç»“æžœï¼š&gt; 1&gt; 3&gt; 2&gt; 5&gt; 4]]></content>
      <categories>
        <category>javascript</category>
        <category>promise</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavsScriptä¹‹æµ…æ‹·è´ä¸Žæ·±æ‹·è´]]></title>
    <url>%2F2018%2F07%2F29%2FJavsScript%E4%B9%8B%E6%B5%85%E6%8B%B7%E8%B4%9D%E4%B8%8E%E6%B7%B1%E6%8B%B7%E8%B4%9D%2F</url>
    <content type="text"><![CDATA[åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬å¾€å¾€éœ€è¦å¤åˆ¶ä¸€ä¸ªæ•°æ®ï¼Œåœ¨å¤åˆ¶åŸºæœ¬æ•°æ®ç±»åž‹çš„æ—¶å€™ä¸ä¼šå‡ºçŽ°é—®é¢˜ï¼Œå¦‚stringã€numberã€nullç­‰ã€‚ä½†æ˜¯æˆ‘ä»¬å¤åˆ¶ä¸€ä¸ªå¼•ç”¨ç±»åž‹çš„æ•°æ®æ—¶ï¼Œå¾€å¾€ä¼šå‡ºçŽ°é—®é¢˜ï¼Œå¦‚arrayã€objectã€‚ æµ…æ‹·è´çœ‹ä¸‹é¢è¿™æ®µä»£ç 123var arr1 = [1,2,3];var arr2 = arr1;arr2.push(4) æˆ‘ä»¬æ‰“å°ä¸€ä¸‹çœ‹çœ‹arr1 arr2çš„ç»“æžœ12arr1: [1, 2, 3, 4]arr2: [1, 2, 3, 4] æˆ‘ä»¬å‘çŽ°ï¼Œæ”¹å˜arr2çš„åŒæ—¶ä¹Ÿæ”¹å˜äº†arr1ï¼ŒWTFï¼Ÿ æŽ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¯¹è±¡12345var obj1 = &#123; name:'wclimb' &#125;;var obj2 = obj1obj2.age = 24 æˆ‘ä»¬æ‰“å°ä¸€ä¸‹çœ‹çœ‹arr1`arr2`çš„ç»“æžœ12obj1: &#123;name: "wclimb", age: 24&#125;obj2: &#123;name: "wclimb", age: 24&#125; å’Œé¢„æƒ³çš„ä¸€æ ·ï¼Œéƒ½è¢«å½±å“äº†ã€‚why?å› ä¸ºå¼•ç”¨ç±»åž‹çš„å¤åˆ¶ï¼Œä¸¤ä¸ªå¼•ç”¨ç±»åž‹çš„æŒ‡é’ˆéƒ½æŒ‡å‘åŒä¸€ä¸ªå †å†…å­˜ ç½‘ä¸Šå¶å°”ä¼šçœ‹åˆ°æœ‰äººè¯´sliceã€concatæ˜¯æ·±æ‹·è´ï¼Œå…¶å®žè¿™ä¸¤ä¸ªæ˜¯æµ…å¤åˆ¶ï¼Œå¦‚ä¸‹123var arr1 = [1,2,3];var arr2 = arr1.slice();arr2.push(4) ç»“æžœï¼š12arr1 [1, 2, 3]arr2 [1, 2, 3, 4] æ•°ç»„å…ƒç´ åªæ˜¯åŸºæœ¬æ•°æ®ç±»åž‹ä¸ä¼šæœ‰å½±å“ï¼Œé‚£ä¹ˆæˆ‘ä»¬çœ‹ä¸‹é¢çš„123var arr1 = [1,2,3,[4]];var arr2 = arr1.slice();arr2[3].push(5) ç»“æžœ12arr1: [1,2,3,[4,5]] &lt;----- è¢«å½±å“äº†arr2: [1,2,3,[4,5]] å³ä½¿ä½¿ç”¨äº†slice, ä¸¤ä¸ªæ•°ç»„ä¹Ÿç›¸äº’å½±å“äº†ï¼Œç±»ä¼¼æ–¹æ³•é™¤äº†sliceã€concatè¿˜æœ‰Array.fromã€... æ·±æ‹·è´å’Œæµ…æ‹·è´æœ€æ ¹æœ¬çš„åŒºåˆ«åœ¨äºŽæ˜¯å¦æ˜¯çœŸæ­£èŽ·å–äº†ä¸€ä¸ªå¯¹è±¡çš„æ‹·è´å®žä½“ï¼Œè€Œä¸æ˜¯å¼•ç”¨ æ·±æ‹·è´Object.assignObject.assignå¯ä»¥è¿›è¡Œä¸€å±‚çš„æ·±åº¦æ‹·è´ï¼Œä¹Ÿå°±æ˜¯è·Ÿsliceç±»åž‹çš„æ•ˆæžœ1234567891011121314151617181920212223242526var obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = Object.assign(&#123;&#125;, obj1)obj2.age = 24ç»“æžœï¼šobj1: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;obj2: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125;, age: 24 &#125;; ä½†æ˜¯æˆ‘ä»¬çœ‹ä¸‹é¢çš„ä¾‹å­12345678910111213141516171819202122232425262728var obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = Object.assign(&#123;&#125;, obj1)obj2.age = 24obj2.test4.val = '1';ç»“æžœï¼š obj1: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;val: 1&#125; &lt;----- è¢«å½±å“äº† &#125;;obj2: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;val: 1&#125;, age: 24 &#125;; JSON.parse(JSON.stringify(obj))è¯´åˆ°æ·±æ‹·è´ï¼Œä½ ä¸€å®šä¼šæƒ³åˆ°JSON.parse(JSON.stringify(obj));æ²¡é”™ï¼Œè¿™æ ·å¯ä»¥å®Œæˆä¸€ä¸ªæ·±æ‹·è´ï¼Œçœ‹ä¸‹é¢çš„ä¾‹å­ï¼š 12345var obj1 = &#123; name: 'wclimb' &#125;;var obj2 = JSON.parse(JSON.stringify(obj1))obj2.age = 24 ç»“æžœ12obj1: &#123;name: "wclimb"&#125; &lt;----- æ²¡æœ‰è¢«å½±å“äº†obj2: &#123;name: "wclimb", age: 24&#125; perfectï¼Œä½†æ˜¯è¿™ä¸ªæ–¹æ³•ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä¸‹ä¾‹ï¼š123456789var var obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = JSON.parse(JSON.stringify(obj1))obj2.age = 24 ç»“æžœ12345678910111213obj1: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;obj2: &#123; name: "wclimb", age: 24, test1: null, test4: &#123;&#125; &#125; WTFï¼Œé‚£ä¸¤ä¸ªä¸ªè·‘å“ªåŽ»äº†ï¼Ÿæ‰€ä»¥è¿™ä¸ªæ–¹æ³•ä¸èƒ½å¤Ÿæ‹·è´å€¼ä¸ºundefinedã€function æ·±æ‹·è´å®žçŽ°é‚£ä¹ˆæ€Žä¹ˆè¿›è¡Œæ·±æ‹·è´å‘¢ï¼Ÿæˆ‘çš„æ–¹æ³•æ˜¯ï¼š12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152function deepCopy(obj)&#123; var result; var toString = Object.prototype.toString if(toString.call(obj) === '[object Array]')&#123; result = [] for(var i = 0 ;i &lt; obj.length; i++)&#123; result[i] = deepCopy(obj[i]) &#125; &#125;else if(toString.call(obj) === '[object Object]')&#123; result = &#123;&#125;; for (var key in obj) &#123; if (obj.hasOwnProperty(key)) &#123; result[key] = deepCopy(obj[key]) &#125; &#125; &#125;else&#123; return obj &#125; return result&#125;æµ‹è¯•ä¸€ä¸‹ï¼švar obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = deepCopy(obj1)obj2.age = 24obj2.test4.val = '1';è¿”å›žï¼š obj1: &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &lt;----- æ²¡æœ‰è¢«å½±å“äº† &#125;;obj2: &#123; age: 24, name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;val: '1'&#125; &#125;; jQueryçš„å®žçŽ°123456789var obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = $.extend(true, &#123;&#125;, obj1)obj2.age = 24 lodashçš„å®žçŽ°123456789var obj1 = &#123; name: 'wclimb', test1: null, test2: undefined, test3: function()&#123;alert(1)&#125;, test4: &#123;&#125; &#125;;var obj2 = _.cloneDeep(obj1)obj2.age = 24 GitHubï¼šwclimb ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nodeé¡¹ç›®æœåŠ¡å™¨éƒ¨ç½²(æ–°æ‰‹æ•™ç¨‹)]]></title>
    <url>%2F2018%2F07%2F28%2Fnode%E9%A1%B9%E7%9B%AE%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%83%A8%E7%BD%B2-%E6%96%B0%E6%89%8B%E6%95%99%E7%A8%8B%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢ä¹‹å‰åœ¨githubå†™äº†å‡ ä¸ªé¡¹ç›®ï¼Œç„¶åŽä¸€ç›´æœ‰å¾ˆå¤šäººé—®æˆ‘nodeé¡¹ç›®æ€Žä¹ˆéƒ¨ç½²åˆ°æœåŠ¡å™¨ä¸Šï¼ŒäºŽæ˜¯ä¹Žåº”å¤§å®¶è¦æ±‚å°±å†™äº†è¿™ç¯‡æ–‡ç« ï¼Œæ­¤ç¯‡æ•™ç¨‹åªæä¾›ç»™æ–°æ‰‹å€Ÿé‰´ï¼Œå¦‚æžœä½ æ˜¯å¤§ä½¬çš„è¯å¯ä»¥ä¸ç”¨å¾€ä¸‹çœ‹äº†ï¼Œæ•™ç¨‹å¤šå°‘æœ‰äº›ç¼ºé™·ï¼Œéƒ½æ˜¯æŒ‰ç…§è‡ªå·±çš„å°è±¡å†™å‡ºæ¥çš„ï¼Œæ‰€ä»¥æœ‰é—®é¢˜è¿˜æœ›æŒ‡æ­£ã€‚ linuxæœåŠ¡å™¨å®‰è£…nodeé¦–å…ˆä¸‹è½½nodeåŒ…1wget https://npm.taobao.org/mirrors/node/latest-v8.x/node-v8.1.0-linux-x64.tar.gz è§£åŽ‹1tar xvf node-v8.1.0-linux-x64.tar.gz 12ln -s ~/node-v8.1.0-linux-x64/bin/node /usr/local/bin/nodeln -s ~/node-v8.1.0-linux-x64/bin/npm /usr/local/bin/npm æœ€åŽnode -væŸ¥çœ‹nodeç‰ˆæœ¬ï¼Œå¦‚æžœå‡ºçŽ°ä»¥ä¸‹å°±è¡¨ç¤ºå®‰è£…æˆåŠŸäº†1v8.1.0 å¦‚æžœä½ éœ€è¦å‡çº§nodeç‰ˆæœ¬ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å³å¯12sudo npm i -g nn stable å®‰è£…pm2pm2æ˜¯ä¸€ä¸ªè¿›ç¨‹å®ˆæŠ¤å·¥å…·,ç±»ä¼¼çš„è¿˜æœ‰forever 1sudo npm i pm2 -g ç„¶åŽæ‰§è¡Œï¼Œå¦‚æžœä¸æ˜ å°„çš„è¯ï¼Œä¼šå‡ºçŽ°pm2ä¸æ˜¯å†…éƒ¨æŒ‡ä»¤çš„é”™è¯¯1ln -s ~/node-v8.1.0-linux-x64/bin/pm2 /usr/local/bin/pm2 æˆ‘ä»¬é¡ºä¾¿æŠŠgitå’Œcnpmä¹Ÿå®‰è£…äº†123yum install gitsudo npm i -g cnpmln -s ~/node-v8.1.0-linux-x64/bin/cnpm /usr/bin/cnpm å®‰è£…mysqlå¸è½½å·²æœ‰çš„mysql12rpm -qa|grep -i mysqlyum remove &apos;mysql&apos; ä¸‹è½½mysqlçš„repoæº12wget http://repo.mysql.com//mysql57-community-release-el7-7.noarch.rpmrpm -ivh mysql57-community-release-el7-7.noarch.rpm å®‰è£…123yum install mysql-serveryum install mysql-develyum install mysql ç„¶åŽæŸ¥çœ‹åˆšåˆšå®‰è£…çš„mysql1rpm -qa|grep -i mysql ç™»å½•1234service mysqld status æŸ¥çœ‹mysqlå½“å‰çš„çŠ¶æ€service mysqld stop åœæ­¢mysqlservice mysqld restart é‡å¯mysqlservice mysqld start å¯åŠ¨mysql åœ¨å®Œæˆä¸Šè¿°æ­¥éª¤ä¹‹åŽç™»é™†æ—¶å¯èƒ½é‡åˆ°ERROR 2002 (HY000): Canâ€˜t connect to local MySQL server through socket â€˜/var/lib/mysql/mysql.sockâ€˜ (2)é”™è¯¯ã€‚ è¿™ä¸ªé”™è¯¯çš„åŽŸå› æ˜¯/var/lib/mysqlçš„è®¿é—®æƒé™é—®é¢˜ã€‚ä¸‹é¢çš„å‘½ä»¤æŠŠ/var/lib/mysqlçš„æ‹¥æœ‰è€…æ”¹ä¸ºå½“å‰ç”¨æˆ·ã€‚ 12chown -R openscanner:openscanner /var/lib/mysqlchown -R root:root /var/lib/mysql äºŽæ˜¯ä¹ŽæŽ¥ä¸‹æ¥å°±æ˜¯æŸ¥çœ‹ä¸€ä¸‹/var/lib/mysql/mysql.sockæ–‡ä»¶æ˜¯å¦å­˜åœ¨ï¼Œç¬¬ä¸€æ¬¡æŸ¥çœ‹æ—¶è¯¥æ–‡ä»¶ä¸å­˜åœ¨ï¼ŒåŽæ¥åœ¨/etc/my.cnfæ–‡ä»¶ä¸­æ·»åŠ äº†user=mysqlç„¶åŽå°è¯•ç™»å½•1mysql -u root ä¼šå‡ºçŽ°ERROR 1045 (28000): Access denied for user &#39;root&#39;@&#39;localhost&#39; (using password: NO) ç™»å½•rootå¸å·éœ€è¦å¯†ç ï¼ŒçŽ°åœ¨æˆ‘ä»¬æ²¡æœ‰è®¾ç½®å¯†ç ï¼Œå“ªæ¥çš„å¯†ç ã€‚äºŽæ˜¯ä¹Žæˆ‘ä»¬å¼€å§‹å¿˜è®°å¯†ç çš„æ“ä½œç¬¬ä¸€æ­¥ï¼Œåœ¨/etc/my.cnfæ–‡ä»¶ä¸­æ·»åŠ skip-grant-tablesç¬¬äºŒæ­¥ï¼Œé‡å¯mysqlï¼Œservice mysqld restartç¬¬ä¸‰æ­¥ï¼Œç™»å½•mysqlï¼Œmysql -u rootç¬¬å››æ­¥ï¼Œä¿®æ”¹å¯†ç ï¼š1234mysql&gt;use mysql;mysql&gt;update mysql.user set authentication_string=password(&apos;ä½ çš„å¯†ç &apos;) where user=&apos;root&apos;;mysql&gt;flush privileges;mysql&gt;exit; ç¬¬äº”æ­¥ï¼Œæ¢å¤/etc/my.cnfï¼Œå°†skip-grant-tablesåˆ é™¤æˆ–è€…æ³¨é‡ŠæŽ‰ç¬¬å…­æ­¥ï¼Œé‡å¯mysqlï¼Œservice mysqld restart åˆ†é…ç”¨æˆ· hostæŒ‡å®šè¯¥ç”¨æˆ·åœ¨å“ªä¸ªä¸»æœºä¸Šå¯ä»¥ç™»é™†ï¼Œæ­¤å¤„çš„â€localhostâ€ï¼Œæ˜¯æŒ‡è¯¥ç”¨æˆ·åªèƒ½åœ¨æœ¬åœ°ç™»å½•ï¼Œä¸èƒ½åœ¨å¦å¤–ä¸€å°æœºå™¨ä¸Šè¿œç¨‹ç™»å½•ï¼Œå¦‚æžœæƒ³è¿œç¨‹ç™»å½•çš„è¯ï¼Œå°†â€localhostâ€æ”¹ä¸ºâ€%â€ï¼Œè¡¨ç¤ºåœ¨ä»»ä½•ä¸€å°ç”µè„‘ä¸Šéƒ½å¯ä»¥ç™»å½•;ä¹Ÿå¯ä»¥æŒ‡å®šæŸå°æœºå™¨å¯ä»¥è¿œç¨‹ç™»å½•; 12CREATE USER &apos;username&apos;@&apos;host&apos; IDENTIFIED BY &apos;password&apos;;CREATE USER &apos;test&apos;@&apos;%&apos; IDENTIFIED BY &apos;å¯†ç &apos;; ç»™åˆ›å»ºçš„ç”¨æˆ·æƒé™ privilegesï¼šç”¨æˆ·çš„æ“ä½œæƒé™,å¦‚SELECTï¼ŒINSERTï¼ŒUPDATEç­‰.å¦‚æžœè¦æŽˆäºˆæ‰€çš„æƒé™åˆ™ä½¿ç”¨ALL;databasenameï¼šæ•°æ®åº“åã€‚tablenameï¼šè¡¨å,å¦‚æžœè¦æŽˆäºˆè¯¥ç”¨æˆ·å¯¹æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„ç›¸åº”æ“ä½œæƒé™åˆ™å¯ç”¨è¡¨ç¤º, å¦‚.*. 1GRANT privileges ON databasename.tablename TO &apos;username&apos;@&apos;host&apos; ä¸‹é¢è¡¨ç¤ºç»™testç”¨æˆ·æ‰€æœ‰æ•°æ®åº“å’Œè¡¨çš„æƒé™ mysql&gt;GRANT ALL ON . TO â€˜testâ€˜@â€™%â€™; å®‰è£…nginxå®‰è£…1yum -y install nginx å¯åŠ¨1service nginx start æŸ¥æ‰¾nginxå®‰è£…åœ¨å“ªï¼Œæˆ‘è¿™é‡Œæ˜¯/etc/nginx/conf.d1whereis nginx è¿›å…¥æ–‡ä»¶å¤¹1cd /etc/nginx/conf.d ç„¶åŽæ–°å»ºæ–‡ä»¶ï¼Œè¿™é‡Œä»¥æˆ‘çš„åŸŸåä¸ºä¾‹1vi www.wclimb.site.conf ç„¶åŽé‡Œé¢çš„æ–‡ä»¶å†…å®¹æˆ‘ä»¬å…ˆä¸å†™ï¼Œæˆ‘ä»¬å…ˆæŠŠnodeé¡¹ç›®éƒ¨ç½²ä¸€ä¸‹ ä½¿ç”¨pm2å¯åŠ¨nodeé¡¹ç›®è¿™é‡Œä»¥æˆ‘çš„é¡¹ç›®ä¸ºä¾‹koa2-blogæˆ‘ä»¬å…ˆæ‰¾åˆ°åˆé€‚çš„æ–‡ä»¶å¤¹å­˜æ”¾æˆ‘ä»¬å¾—é¡¹ç›®ï¼Œç„¶åŽgit cloneä¸€ä¸‹ï¼ˆgitæˆ‘ä»¬ä¹‹å‰å®‰è£…è¿‡äº†ï¼‰ è¯¥é¡¹ç›®çš„æ•°æ®åº“åå«nodeSqlï¼Œä½¿ç”¨è¿è¡Œä¹‹å‰å¾—å…ˆå»ºç«‹å¥½æ•°æ®åº“ï¼Œç„¶åŽå†è¿è¡Œé¡¹ç›®ï¼Œç™»å½•æ•°æ®åº“æ‰§è¡Œ create database nodesql; 1234git clone https://github.com/wclimb/Koa2-blog.gitcd Koa2-blogcnpm i pm2 start index.js ä¸Šé¢pm2æˆ‘ä»¬ä¹Ÿå®‰è£…è¿‡ï¼Œè¯¥é¡¹ç›®ç›‘å¬çš„æ˜¯3000ç«¯å£ï¼Œé¡¹ç›®å·²ç»è¿è¡Œèµ·æ¥äº†å¯ä»¥ä½¿ç”¨pm2 listæŸ¥çœ‹è¿›ç¨‹åˆ—è¡¨ï¼Œä½¿ç”¨pm2 logæ‰“å°æ—¥å¿— nginxé…ç½®è®°å¾—åˆšåˆšæˆ‘ä»¬æ²¡æœ‰ç¼–å†™www.wclimb.site.confæ–‡ä»¶çŽ°åœ¨å¼€å§‹å†™å…¥ä»¥ä¸‹å†…å®¹ï¼Œblog.wclimb.siteæ˜¯æˆ‘çš„åŸŸåï¼Œä½ å¯ä»¥åœ¨ä½ çš„æœåŠ¡å™¨å¹³å°åŽ»è§£æžä¸€ä¸‹ï¼Œç›®å‰æˆ‘ä»¬ç›‘å¬çš„æ˜¯3000ç«¯å£ï¼Œæ‰€ä»¥ä»£ç†åˆ°30001234567server &#123; listen 80; server_name blog.wclimb.site; location / &#123; proxy_pass http://127.0.0.1:3000; &#125;&#125; æ£€éªŒnginxæ˜¯å¦æ­£ç¡®é…ç½®1nginx -t é‡å¯nginx1service nginx restart å¦‚æžœä¸æˆåŠŸï¼Œå¯èƒ½è¿˜éœ€æ‰§è¡Œä¸€ä¸‹å‘½ä»¤12systemctl stop httpdsystemctl disable httpd å®Œç»“OKï¼ŒçŽ°åœ¨è®¿é—®åŸŸåçœ‹çœ‹æ˜¯å¦æœ‰æ•ˆæžœäº†ï¼Œæ•´ä¸ªæµç¨‹å¯èƒ½æœ‰å†™çº°æ¼ï¼Œå¤§è‡´æµç¨‹ä¹Ÿå·®ä¸å¤šäº†ï¼Œå¸Œæœ›å¯¹ä½ æœ‰å¸®åŠ© GitHubï¼šwclimb ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
        <category>node</category>
        <category>æ•™ç¨‹</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>Node</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹å‡½æ•°è®°å¿†]]></title>
    <url>%2F2018%2F07%2F12%2FJavaScript%E4%B9%8B%E5%87%BD%E6%95%B0%E8%AE%B0%E5%BF%86%2F</url>
    <content type="text"><![CDATA[æœ€è¿‘åœ¨è¯»è¯­è¨€ç²¾ç²¹ï¼Œè¯»åˆ°å‡½æ•°è®°å¿†è¿™å—ï¼Œè§‰å¾—æœ‰å¿…è¦è®°å½•ä¸€ä¸‹ æˆ‘ä»¬åœ¨å¼€å‘è¿‡ç¨‹ä¸­ç»å¸¸ä½¿ç”¨é€’å½’çš„æ–¹å¼è°ƒç”¨å‡½æ•°ï¼Œä½†æ˜¯å¼€å‘è¿‡ç¨‹ä¸­å¾ˆå°‘æœ‰å…³å¿ƒæ€§èƒ½é—®é¢˜ æˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢è¿™æ®µä»£ç 123456789var count = 0var f = function(n)&#123; count++ return n &lt; 2 ? n : f(n - 1) + f(n - 2);&#125;for(var i = 0; i &lt;= 10; i++)&#123; console.log(i,f(i))&#125;console.log('æ‰§è¡Œæ¬¡æ•°', count) ç»“æžœ1234567891011120 01 12 13 24 35 56 87 138 219 3410 55'æ‰§è¡Œæ¬¡æ•°', 453 æ‰§è¡Œä¸€éå‘çŽ°ï¼Œfè¿™ä¸ªå‡½æ•°è¢«è°ƒç”¨äº†453æ¬¡ï¼Œæˆ‘ä»¬è°ƒç”¨äº†11æ¬¡ï¼Œè€Œå®ƒè‡ªèº«è°ƒç”¨äº†442æ¬¡åŽ»è®¡ç®—å¯èƒ½å·²ç»è¢«åˆšè®¡ç®—è¿‡çš„å€¼ã€‚å¦‚æžœæˆ‘ä»¬è®©å‡½æ•°å…·å¤‡è®°å¿†åŠŸèƒ½ï¼Œå°±å¯ä»¥æ˜¾è‘—å‡å°‘è¿ç®—é‡ã€‚ æŽ¥ä¸‹æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ä¸€ä¸ªmemoçš„æ•°ç»„æ¥ä¿å­˜æˆ‘ä»¬å¾—å‚¨å­˜ç»“æžœï¼Œå¹¶æŠŠå®ƒéšè—åœ¨é—­åŒ…ä¸­ï¼Œè®©è¯¥å‡½æ•°èƒ½ä¸€ç›´è®¿é—®åˆ°è¿™ä¸ªæ•°ç»„ï¼Œä¸è¢«åžƒåœ¾å›žæ”¶æœºåˆ¶å›žæ”¶ 123456789101112131415161718var count = 0var f = function()&#123; var memo = [0,1]; var fib = function(n)&#123; count++ var result = memo[n]; if(typeof result !== 'number')&#123; result = fib(n - 1) + fib(n - 2) memo[n] = result &#125; return result &#125; return fib&#125;()for(var i = 0; i &lt;= 10; i++)&#123; console.log(i,f(i))&#125;console.log('æ‰§è¡Œæ¬¡æ•°', count) æ‰§è¡Œç»“æžœ1234567891011120 01 12 13 24 35 56 87 138 219 3410 55æ‰§è¡Œæ¬¡æ•° 29 çŽ°åœ¨få‡½æ•°åªè¢«è°ƒç”¨äº†29æ¬¡ï¼Œæˆ‘ä»¬è°ƒç”¨äº†å®ƒ11æ¬¡ï¼Œå®ƒè°ƒç”¨äº†18æ¬¡åŽ»å–å¾—ä¹‹å‰å‚¨å­˜çš„ç»“æžœã€‚ å…ˆå°±åˆ†äº«åˆ°è¿™å§ï¼Œå…³é”®æ‹“å®½æ€è·¯ GitHubï¼šwclimb]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹åŽŸåž‹ä¸ŽåŽŸåž‹é“¾]]></title>
    <url>%2F2018%2F06%2F13%2FJavaScript%E4%B9%8B%E5%8E%9F%E5%9E%8B%E4%B8%8E%E5%8E%9F%E5%9E%8B%E9%93%BE%2F</url>
    <content type="text"><![CDATA[ä¸‡ç‰©çš†å¯¹è±¡åœ¨JavaScriptä¸­é™¤å€¼ç±»åž‹ä¹‹å¤–ï¼Œå…¶ä»–çš„éƒ½æ˜¯å¯¹è±¡ï¼Œä¸ºäº†è¯´æ˜Žè¿™ç‚¹ï¼Œæˆ‘ä»¬ä¸¾å‡ ä¸ªä¾‹å­æˆ‘ä»¬å¯ä»¥ä½¿ç”¨typeofæ¥åšç±»åž‹åˆ¤æ–­ 123456789typeof a; // undefinedtypeof 1; // numbertypeof 'wclimb'; // stringtypeof true; // booleantypeof function()&#123;&#125;; // functiontypeof []; // objecttypeof null; // objecttypeof &#123;&#125;; // object é™¤äº†undefinedã€numberã€stringã€booleanå±žäºŽå€¼ç±»åž‹ä¹‹å¤–ï¼Œå…¶ä»–éƒ½æ˜¯å¯¹è±¡ã€‚ä½ å¯èƒ½è¦é—®äº†ï¼Œä¸æ˜¯è¿˜æœ‰ä¸€ä¸ªæ˜¯functionå—ï¼Ÿè¦æ ¡éªŒä»–æ˜¯ä¸æ˜¯åº”è¯¥å¯¹è±¡å¯ä»¥è¿™æ ·åš:12var fn = function()&#123;&#125;fn instanceof Object // true ç”±ä¸Šé¢çš„ä¾‹å­æ‰€ç¤ºï¼Œå‡½æ•°ç¡®å®žæ˜¯å¯¹è±¡ï¼Œä¸ºä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸€ä¸‹ä¸‹é¢çš„ä¾‹å­12345function Person(name)&#123; this.name = name; &#125;var person = new Person('wclimb');console.log(person) // Person &#123;name: "wclimb"&#125; ç”±æ­¤æˆ‘ä»¬å¯ä»¥å¾—çŸ¥ï¼Œå¯¹è±¡éƒ½æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„ï¼Œè¿™ä¹ˆè¯´ä½ å¯èƒ½åˆä¼šè¯´ä¸å¯¹ï¼Œä½ çœ‹ä¸‹é¢çš„å°±ä¸æ˜¯å‡½æ•°åˆ›å»ºçš„1var person = &#123;name:'wclimb'&#125; ä½ å’‹å°±è¿™ä¹ˆé£˜å‘¢ï¼Ÿæˆ‘ç«Ÿæ— è¨€ä»¥å¯¹ï¼Œæ²¡é”™ï¼Œè¿™æ˜¯ä¸ªæ„å¤–ã€æ„å¤–ã€æ„å¤–ã€‚ä½†æ˜¯å½’æ ¹ç»“åº•ä»–è¿˜æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„12var person = new Object()person.name = 'wclimb' soï¼ŒçŽ°åœ¨ä½ åªè¦çŸ¥é“å¯¹è±¡æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„å°±å¯ä»¥äº†ï¼Œæ¥è·Ÿç€æˆ‘è¯»ï¼šç¬¬ä¸€é å¯¹è±¡éƒ½æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„ç¬¬äºŒé å¯¹è±¡éƒ½æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„ç¬¬ä¸‰é å¯¹è±¡éƒ½æ˜¯é€šè¿‡å‡½æ•°åˆ›å»ºçš„ æž„é€ å‡½æ•°(constructor)12345function Person(name)&#123; this.name = name&#125;var person1 = new Person('wclimb 1')var person2 = new Person('wclimb 2') ä¸Šé¢Personå°±æ˜¯ä¸€ä¸ªæž„é€ å‡½æ•°ï¼Œæˆ‘ä»¬é€šè¿‡newçš„æ–¹å¼åˆ›å»ºäº†ä¸€ä¸ªå®žä¾‹å¯¹è±¡personæˆ‘ä»¬æ¥çœ‹çœ‹person1å’Œperson2çš„constructor(æž„é€ å‡½æ•°)æ˜¯ä¸æ˜¯æŒ‡å‘Personçš„12person1.constructor === Person // trueperson2.constructor === Person // true åŽŸåž‹(prototype)åœ¨JavaScriptä¸­ï¼Œæ¯å®šä¹‰ä¸€ä¸ªå‡½æ•°éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªprototype(åŽŸåž‹)å±žæ€§ï¼Œè¿™ä¸ªå±žæ€§æŒ‡å‘å‡½æ•°çš„åŽŸåž‹å¯¹è±¡12345678function Person()&#123;&#125;Person.prototype.name = 'wclimb'Person.prototype.age = '24'Person.prototype.sayAge = function()&#123; console.log(this.age)&#125;var person = new Person()person.sayAge(); // 24 é‚£ä¹ˆè¿™ä¸ªprototypeåˆ°åº•æ˜¯ä»€ä¹ˆå‘¢ï¼Ÿè·Ÿæž„é€ å‡½æ•°æœ‰å…³ç³»å—ï¼Ÿ ä¸Šå›¾å°±å¯ä»¥åæ˜ å‡ºä»–ä»¬ä¹‹é—´çš„å…³ç³» å…¶å®žå‡½æ•°çš„prototypeæŒ‡å‘å‡½æ•°çš„åŽŸåž‹å¯¹è±¡ï¼Œæ¯ä¸ªå¯¹è±¡éƒ½ä¼šå…³è”å¦å¤–ä¸€ä¸ªå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯åŽŸåž‹ï¼Œä¸Šé¢çš„ä¾‹å­æ”¹æˆï¼š1234567Person.prototype = &#123; name: 'wclimb', age: 24, satAge: function()&#123; console.log(this.age) &#125;&#125; éšå¼åŽŸåž‹(__proto__)ä¸Šé¢æˆ‘ä»¬è¯´åˆ°æ¯å®šä¹‰ä¸€ä¸ªå‡½æ•°éƒ½ä¼šäº§ç”Ÿä¸€ä¸ªåŽŸåž‹ï¼Œæ¯ä¸ªå‡½æ•°å®ƒä¸æ­¢æœ‰åŽŸåž‹ï¼Œè¿˜æœ‰ä¸€ä¸ª__proto__(éšå¼åŽŸåž‹)æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__å±žæ€§ï¼ŒæŒ‡å‘åˆ›å»ºè¯¥å¯¹è±¡å‡½æ•°çš„prototypeï¼Œæˆ‘ä»¬å¯ä»¥æ¥è¯•è¯•ï¼Œè¿˜æ˜¯ä¸Šé¢çš„ä¾‹å­ï¼š123function Person()&#123;&#125;var person = new Person()person.__proto__ === Person.prototype // true çŽ°åœ¨ä»–ä»¬çš„å…³ç³»å›¾å¦‚ä¸‹ ç”±ä¸Šå›¾æˆ‘ä»¬å¯ä»¥çŸ¥é“ï¼š123Person.prototype.constructor = Personperson.__proto__ = Person.prototypeperson.constructor = Person æˆ‘ä»¬å¯ä»¥çœ‹åˆ°person.__proto__æŒ‡å‘æž„é€ å‡½æ•°çš„åŽŸåž‹ï¼Œé‚£ä¹ˆæž„é€ å‡½æ•°çš„åŽŸåž‹å³Personçš„__proto__æŒ‡å‘å“ªé‡Œå‘¢ï¼Ÿæˆ‘ä»¬çŸ¥é“æž„é€ å‡½æ•°å…¶å®žå°±æ˜¯ç”±Functionæ¥åˆ›å»ºçš„ï¼Œç”±æ­¤å¾—å‡º:1Person.__proto__ === Function.prototype é‚£ä¹ˆæž„é€ å‡½æ•°çš„åŽŸåž‹å³Person.prototypeçš„__proto__æŒ‡å‘å“ªé‡Œå‘¢ï¼ŸåŽŸåž‹å¯¹è±¡å…¶å®žæ˜¯é€šè¿‡Objectç”Ÿæˆçš„ï¼Œè‡ªç„¶è€Œç„¶çš„å¾—å‡º:1Person.prototype.__proto__ === Object.prototype é‚£ä¹ˆObject.prototypeçš„__proto__æŒ‡å‘å“ªé‡Œå‘¢ï¼Ÿç­”æ¡ˆæ˜¯nullï¼Œæœ€ç»ˆå¾—åˆ°ä¸‹é¢çš„å›¾ æŠ›å¼€è¿™å¼ å›¾ï¼Œæ¥çœ‹çœ‹ä¸‹é¢å‡ é“é¢˜ person.__proto__ Person.__proto__ Person.prototype.__proto__ Object.__proto__ Object.prototype.__proto__ è§£ï¼š æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸€ä¸ª__proto__å±žæ€§ï¼ŒæŒ‡å‘åˆ›å»ºè¯¥å¯¹è±¡å‡½æ•°çš„prototypeï¼Œå› ä¸ºPersonæ˜¯personçš„æž„é€ å‡½æ•°Person === person.constructorä¸ºtrue,æ‰€ä»¥ï¼šperson.__proto__ === Person.prototype Personæž„é€ å‡½æ•°æ˜¯ç”±Functionåˆ›å»ºçš„ï¼Œæ‰€ä»¥å¯ä»¥å¾—å‡ºPerson.__proto__ === Fucntion.prototype æˆ‘ä»¬ä¸Šé¢è¯´è¿‡Person.prototypeå…¶å®žæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œè€Œå¯¹è±¡æ˜¯ç”±Objectåˆ›å»ºçš„ï¼Œæ‰€ä»¥ Person.prototype.__proto__ === Object.prototype Objectå¯¹è±¡éƒ½æ˜¯å‡½æ•°åˆ›å»ºçš„ï¼Œæ‰€ä»¥Object.__proto__ === Function.prototype è™½ç„¶Object.prototypeæ˜¯ä¸€ä¸ªå¯¹è±¡ä½†æ˜¯ä»–çš„__proto__ä¸ºnull å®žä¾‹å’ŒåŽŸåž‹å½“æˆ‘ä»¬è¦å–ä¸€ä¸ªå€¼çš„æ—¶å€™ï¼Œä¼šå…ˆä»Žå®žä¾‹ä¸­å–ï¼Œå¦‚æžœå®žä¾‹ä¸­å­˜åœ¨ï¼Œåˆ™å–å®žä¾‹çš„å€¼ï¼Œå¦‚æžœå®žä¾‹ä¸å­˜åœ¨ï¼Œåˆ™ä¼šé¡ºç€åŽŸåž‹é‡Œæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ° 12345678function Person()&#123;&#125;Person.prototype.name = 'æˆ‘æ¥è‡ªåŽŸåž‹'var person = new Person()person.name = 'æˆ‘æ¥è‡ªå®žä¾‹'console.log(person.name); // æˆ‘æ¥è‡ªå®žä¾‹delete person.nameconsole.log(person.name)); // æˆ‘æ¥è‡ªåŽŸåž‹ é¦–å…ˆpersonå®žä¾‹ä¸­æœ‰è¿™ä¸ªå±žæ€§ï¼Œè¿”å›žæˆ‘æ¥è‡ªå®žä¾‹,ç„¶åŽå°†å®ƒåˆ é™¤ä¹‹åŽï¼Œä¼šä»ŽåŽŸåž‹ä¸­æ‹›ï¼Œä¹Ÿå°±æ˜¯person.__proto__ï¼Œå› ä¸ºPerson.prototype === person.__proto__ï¼Œæ‰€ä»¥å¾—åˆ°æˆ‘æ¥è‡ªåŽŸåž‹ æ€»ç»“åŽŸåž‹å’ŒåŽŸåž‹é“¾åŸºæœ¬å·²ç»è®²è§£å®Œï¼Œä¸è¿‡è¿˜æœ‰å¾…å®Œå–„ï¼Œå¦‚æœ‰é”™è¯¯ï¼Œè¿˜æœ›æŒ‡æ­£ GitHubï¼šwclimb ä¸ªäººå°ç¨‹åº QQç¾¤æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥åŠ qqç¾¤: 725165362 ç‚¹å‡»åŠ å…¥]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[JavaScriptä¹‹èŠ‚æµä¸Žé˜²æŠ–]]></title>
    <url>%2F2018%2F06%2F12%2FJavaScript%E4%B9%8B%E8%8A%82%E6%B5%81%E4%B8%8E%E9%98%B2%E6%8A%96%2F</url>
    <content type="text"><![CDATA[èƒŒæ™¯æˆ‘ä»¬åœ¨å¼€å‘çš„è¿‡ç¨‹ä¸­ä¼šç»å¸¸ä½¿ç”¨å¦‚scrollã€resizeã€touchmoveç­‰äº‹ä»¶ï¼Œå¦‚æžœæ­£å¸¸ç»‘å®šäº‹ä»¶å¤„ç†å‡½æ•°çš„è¯ï¼Œæœ‰å¯èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å¤šæ¬¡è¿žç»­è§¦å‘äº‹ä»¶ï¼Œååˆ†å½±å“æ€§èƒ½ã€‚å› æ­¤é’ˆå¯¹è¿™ç±»äº‹ä»¶è¦è¿›è¡ŒèŠ‚æµæˆ–è€…é˜²æŠ–å¤„ç† èŠ‚æµèŠ‚æµçš„æ„æ€æ˜¯ï¼Œåœ¨è§„å®šçš„æ—¶é—´å†…åªä¼šè§¦å‘ä¸€æ¬¡å‡½æ•°ï¼Œå¦‚æˆ‘ä»¬è®¾ç½®å‡½æ•°500msè§¦å‘ä¸€æ¬¡ï¼Œä¹‹åŽä½ æ— è®ºä½ è§¦å‘äº†å¤šå°‘æ¬¡å‡½æ•°ï¼Œåœ¨è¿™ä¸ªæ—¶é—´å†…ä¹Ÿåªä¼šæœ‰ä¸€æ¬¡æ‰§è¡Œæ•ˆæžœ å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ See the Pen gKWLpO by wclimb (@wclimb) on CodePen. æˆ‘ä»¬çœ‹åˆ°ä½¿ç”¨äº†èŠ‚æµçš„åœ¨1000mså†…åªè§¦å‘äº†ä¸€æ¬¡ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨èŠ‚æµçš„åˆ™é¢‘ç¹è§¦å‘äº†è°ƒç”¨çš„å‡½æ•° æŽ¥ä¸‹æ¥çœ‹çœ‹ä»£ç å®žçŽ°v1 ç¬¬ä¸€æ¬¡ä¸è§¦å‘ï¼Œä¸ä¼ å‚å®žçŽ°12345678910111213function throttle(fn,interval)&#123; var timer; return function()&#123; if(timer)&#123; return &#125; timer = setTimeout(() =&gt; &#123; clearTimeout(timer) timer = null fn() &#125;, interval || 1000); &#125; &#125; æ•ˆæžœæ˜¯å®žçŽ°äº†ï¼Œä½†æ˜¯æˆ‘åœ¨å°è¯•åœ¨æ‰§è¡Œå‡½æ•°é‡Œconsole.log(this)ï¼Œç»“æžœå‘çŽ°thisæŒ‡å‘çš„æ˜¯windowï¼Œè€Œä¸”è¿˜å‘çŽ°æˆ‘ä»¬ä¸èƒ½ä¼ é€’å‚æ•°ï¼Œä¸‹é¢å°±æ¥æ”¹è¿›ä¸€ä¸‹v2 ç¬¬ä¸€æ¬¡è§¦å‘å‡½æ•°ï¼ŒæŽ¥æ”¶å‚æ•°1234567891011121314151617181920function throttle(fn,interval)&#123; var timer, isFirst = true; return function()&#123; var args = arguments, that = this; if(isFirst)&#123; fn.apply(that,args) return isFirst = false &#125; if(timer)&#123; return &#125; timer = setTimeout(() =&gt; &#123; clearTimeout(timer) timer = null fn.apply(that,args) &#125;, interval || 1000); &#125; &#125; é˜²æŠ–é˜²æŠ–çš„æ„æ€æ˜¯æ— è®ºä½ è§¦å‘å¤šå°‘æ¬¡å‡½æ•°ï¼Œåªä¼šè§¦å‘æœ€åŽä¸€æ¬¡å‡½æ•°ã€‚æœ€å¸¸ç”¨çš„å°±æ˜¯åœ¨è¡¨å•æäº¤çš„æ—¶å€™ï¼Œç”¨æˆ·å¯èƒ½ä¼šä¸€æ®µæ—¶é—´å†…ç‚¹å‡»å¾ˆå¤šæ¬¡ï¼Œè¿™ä¸ªæ—¶å€™å¯ä»¥å¢žåŠ é˜²æŠ–å¤„ç†ï¼Œæˆ‘ä»¬åªéœ€è¦æœ€åŽä¸€æ¬¡è§¦å‘çš„äº‹ä»¶ å…ˆæ¥çœ‹ä¸€ä¸ªä¾‹å­ See the Pen pKPeyv by wclimb (@wclimb) on CodePen. æˆ‘ä»¬çœ‹åˆ°ä½¿ç”¨äº†é˜²æŠ–çš„æ–¹æ¡†ï¼Œæ— è®ºä½ åœ¨é‡Œé¢è§¦å‘äº†å¤šå°‘æ¬¡å‡½æ•°ï¼Œéƒ½åªä¼šè§¦å‘æœ€åŽçš„é‚£ä¸€æ¬¡å‡½æ•°ï¼Œè€Œæ²¡æœ‰ä½¿ç”¨é˜²æŠ–çš„åˆ™é¢‘ç¹è§¦å‘äº†è°ƒç”¨çš„å‡½æ•° v1 ç¬¬ä¸€æ¬¡ä¸è§¦å‘å‡½æ•° 1234567891011121314function debounce(fn,interval)&#123; var timer; return function()&#123; var args = arguments, that = this; if(timer)&#123; clearTimeout(timer) timer = null &#125; timer = setTimeout(() =&gt; &#123; fn.apply(null,args) &#125;, interval || 1000); &#125;&#125; ä¸Šé¢è¿™æ®µä»£ç ä»ç„¶å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œä½†æ˜¯æˆ‘ä»¬å¹¶æ²¡æœ‰æŒ‡å®šä»–çš„this v2 ç¬¬ä¸€æ¬¡å°±è§¦å‘å‡½æ•°123456789101112131415161718192021222324function debounce(fn,interval)&#123; var timer, isFirst = true, can = false; return function()&#123; var args = arguments, that = this; if(timer)&#123; clearTimeout(timer) timer = null &#125; if(isFirst)&#123; fn.apply(that,args) isFirst = false setTimeout(() =&gt; &#123; can = true &#125;, interval || 1000); &#125;else if(can)&#123; timer = setTimeout(() =&gt; &#123; fn.apply(null,args) &#125;, interval || 1000); &#125; &#125;&#125; å¦‚æœ‰é›·åŒï¼Œçº¯å±žæŠ„æˆ‘ï¼ˆå¼€çŽ©ç¬‘ï¼‰ å¦‚æœ‰é”™è¯¯ï¼Œè¿˜æœ›æŒ‡æ­£ï¼Œä»…ä¾›å‚è€ƒ GitHubï¼šwclimb QQç¾¤æœ‰å…´è¶£çš„åŒå­¦å¯ä»¥åŠ qqç¾¤: 725165362 ç‚¹å‡»åŠ å…¥ ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[HTTPç¼“å­˜â€”â€”304ä¸Ž200 from cache]]></title>
    <url>%2F2018%2F03%2F06%2FHTTP%E7%BC%93%E5%AD%98%E2%80%94%E2%80%94304%E4%B8%8E200-from-cache%2F</url>
    <content type="text"><![CDATA[HTTPä¸Žç¼“å­˜ç›¸å…³çš„å­—æ®µ1. é€šç”¨å­—æ®µ å­—æ®µåç§° é‡Šä¹‰ Cache-Control æŽ§åˆ¶ç¼“å­˜å…·ä½“çš„è¡Œä¸º Pragma HTTP1.0æ—¶çš„é—ç•™å­—æ®µï¼Œå½“å€¼ä¸ºâ€no-cacheâ€æ—¶å¼ºåˆ¶éªŒè¯ç¼“å­˜ Date åˆ›å»ºæŠ¥æ–‡çš„æ—¥æœŸæ—¶é—´(å¯å‘å¼ç¼“å­˜é˜¶æ®µæ‰€ç”¨) 2. responseå­—æ®µ å­—æ®µåç§° é‡Šä¹‰ ETag æœåŠ¡å™¨ç”Ÿæˆèµ„æºçš„å”¯ä¸€æ ‡è¯† Vary ä»£ç†æœåŠ¡å™¨ç¼“å­˜çš„ç®¡ç†ä¿¡æ¯ Age èµ„æºåœ¨ç¼“å­˜ä»£ç†ä¸­å­˜è´®çš„æ—¶é•¿(å–å†³äºŽmax-ageå’Œs-maxageçš„å¤§å°) 3. requestå­—æ®µ å­—æ®µåç§° é‡Šä¹‰ If-Match æ¡ä»¶è¯·æ±‚ï¼Œæºå¸¦ä¸Šä¸€æ¬¡è¯·æ±‚ä¸­èµ„æºçš„ETagï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå­—æ®µåˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰æ–°çš„ä¿®æ”¹ If-None-Match å’ŒIf-Matchä½œç”¨ç›¸åï¼ŒæœåŠ¡å™¨æ ¹æ®è¿™ä¸ªå­—æ®µåˆ¤æ–­æ–‡ä»¶æ˜¯å¦æœ‰æ–°çš„ä¿®æ”¹ If-Modified-Since æ¯”è¾ƒèµ„æºå‰åŽä¸¤æ¬¡è®¿é—®æœ€åŽçš„ä¿®æ”¹æ—¶é—´æ˜¯å¦ä¸€è‡´ If-Unmodified-Since æ¯”è¾ƒèµ„æºå‰åŽä¸¤æ¬¡è®¿é—®æœ€åŽçš„ä¿®æ”¹æ—¶é—´æ˜¯å¦ä¸€è‡´ 4. å®žä½“å­—æ®µ å­—æ®µåç§° é‡Šä¹‰ Expires å‘ŠçŸ¥å®¢æˆ·ç«¯èµ„æºç¼“å­˜å¤±æ•ˆçš„ç»å¯¹æ—¶é—´ Last-Modified èµ„æºæœ€åŽä¸€æ¬¡ä¿®æ”¹çš„æ—¶é—´ åå•†ç¼“å­˜ï¼ˆ304ï¼‰ If-modified-Since/Last-Modified æµè§ˆå™¨åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™æœåŠ¡å™¨ä¼šæ£€æŸ¥è¯·æ±‚å¤´request headeré‡Œé¢çš„If-modified-Sinceï¼Œå¦‚æžœæœ€åŽä¿®æ”¹æ—¶é—´ç›¸åŒåˆ™è¿”å›ž304ï¼Œå¦åˆ™ç»™è¿”å›žå¤´(response header)æ·»åŠ last-Modifiedå¹¶ä¸”è¿”å›žæ•°æ®(response body)ã€‚12if-modified-since:Wed, 31 May 2017 03:21:09 GMTif-none-match:&quot;42DD5684635105372FE7720E3B39B96A&quot; If-None-Match/Etag æµè§ˆå™¨åœ¨å‘é€è¯·æ±‚çš„æ—¶å€™æœåŠ¡å™¨ä¼šæ£€æŸ¥è¯·æ±‚å¤´(request header)é‡Œé¢çš„if-none-matchçš„å€¼ä¸Žå½“å‰æ–‡ä»¶çš„å†…å®¹é€šè¿‡hashç®—æ³•ï¼ˆä¾‹å¦‚ nodejs: cryto.createHash(&#39;sha1&#39;)ï¼‰ç”Ÿæˆçš„å†…å®¹æ‘˜è¦å­—ç¬¦å¯¹æ¯”ï¼Œç›¸åŒåˆ™ç›´æŽ¥è¿”å›ž304ï¼Œå¦åˆ™ç»™è¿”å›žå¤´(response header)æ·»åŠ etagå±žæ€§ä¸ºå½“å‰çš„å†…å®¹æ‘˜è¦å­—ç¬¦ï¼Œå¹¶ä¸”è¿”å›žå†…å®¹ã€‚12etag:&quot;42DD5684635105372FE7720E3B39B96A&quot;last-modified:Wed, 31 May 2017 03:21:09 GMT è¯·æ±‚å¤´last-modifiedçš„æ—¥æœŸä¸Žå“åº”å¤´çš„last-modifiedä¸€è‡´è¯·æ±‚å¤´if-none-matchçš„hashä¸Žå“åº”å¤´çš„etagä¸€è‡´æ‰€ç”¨ä¼šè¿”å›žStatus Code: 304 å¼ºç¼“å­˜ï¼ˆ200 from cacheï¼‰ å¦‚æžœè®¾ç½®äº†Expires(XXæ—¶é—´è¿‡æœŸ)æˆ–è€…Cache-Controlï¼ˆhttp1.0ä¸æ”¯æŒï¼‰(ç»åŽ†XXæ—¶é—´åŽè¿‡æœŸ)ä¸”æ²¡æœ‰è¿‡æœŸï¼Œå‘½ä¸­cacheçš„æƒ…å†µä¸‹ï¼Œfrom cacheä¸åŽ»å‘å‡ºè¯·æ±‚ã€‚å¦‚æžœå¼ºåˆ·ï¼ˆå¦‚ctrl+rï¼‰ä¼šå‘èµ·è¯·æ±‚ï¼Œä½†æ˜¯å¦‚æžœæ²¡æœ‰ä¿®æ”¹ä¼šè¿”å›ž304å†…å®¹æœªä¿®æ”¹ï¼Œå¦‚æžœå·²ç»æ”¹å˜åˆ™è¿”å›žæ–°å†…å®¹ã€‚max-age &gt; Expiresã€‚ expires/cache-controlè™½ç„¶æ˜¯å¼ºç¼“å­˜ï¼Œä½†ç”¨æˆ·ä¸»åŠ¨è§¦å‘çš„åˆ·æ–°è¡Œä¸ºï¼Œè¿˜æ˜¯ä¼šé‡‡ç”¨ç¼“å­˜åå•†çš„ç­–ç•¥ï¼Œä¸»åŠ¨è§¦å‘çš„åˆ·æ–°è¡Œä¸ºåŒ…æ‹¬ç‚¹å‡»åˆ·æ–°æŒ‰é’®ã€å³é”®åˆ·æ–°ã€f5åˆ·æ–°ã€ctrl+f5åˆ·æ–°ç­‰ã€‚ å½“ç„¶å¦‚æžœåœ¨æŽ§åˆ¶å°é‡Œé¢é€‰ä¸­äº†disable cahceåˆ™æ— è®ºå¦‚ä½•éƒ½ä¼šè¯·æ±‚æœ€æ–°å†…å®¹(304åå•†ç¼“å­˜ã€å¼ºç¼“å­˜éƒ½æ— æ•ˆ)ï¼Œå› ä¸º1.ä¸ä¼šæ£€æŸ¥æœ¬åœ°æ˜¯å¦æœ‰ç¼“å­˜ã€‚2.è¯·æ±‚å¤´ä¿¡æ¯(request header)æ—¢æ²¡æœ‰If-Modified-Sinceä¹Ÿæ²¡æœ‰If-None-Matchæ¥è®©æœåŠ¡ç«¯åˆ¤æ–­ã€‚åœ°å€æ è¾“å…¥çš„åœ°å€æŒ‰ä¸‹å›žè½¦é”®ï¼Œè¯¥åœ°å€é¡µé¢è¯·æ±‚ï¼ˆä»…ä»…æ˜¯è¯¥urlï¼‰çš„request headeréƒ½ä¼šå¸¦ä¸Šcache-contro:max-age=0ï¼Œæ‰€ä»¥ä¸ä¼šå‘½ä¸­å¼ºç¼“å­˜ï¼Œä½†æ˜¯é€šè¿‡é“¾æŽ¥ç‚¹å‡»çš„åœ°å€ä¼šå‘½ä¸­ç¼“å­˜ chromeä¸‹æŸ¥çœ‹æ‰€æœ‰çš„from cacheæ–‡ä»¶ï¼šchrome://view-http-cache/ åŒºåˆ« è§¦å‘ 200 from cacheï¼š ç›´æŽ¥ç‚¹å‡»é“¾æŽ¥è®¿é—® è¾“å…¥ç½‘å€æŒ‰å›žè½¦è®¿é—® äºŒç»´ç æ‰«æ è§¦å‘ 304ï¼š åˆ·æ–°é¡µé¢æ—¶è§¦å‘ è®¾ç½®äº†é•¿ç¼“å­˜ã€ä½†Entity Tagsæ²¡æœ‰ç§»é™¤æ—¶è§¦å‘ æµç¨‹å›¾ GitHubï¼šwclimb ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
        <category>HTTP</category>
      </categories>
      <tags>
        <tag>HTTP</tag>
        <tag>ç¼“å­˜</tag>
        <tag>Mysql</tag>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[nodejså¾®ä¿¡æ”¯ä»˜ä¹‹æ‰«ç æ”¯ä»˜]]></title>
    <url>%2F2018%2F02%2F14%2Fnodejs%E5%BE%AE%E4%BF%A1%E6%94%AF%E4%BB%98%E4%B9%8B%E6%89%AB%E7%A0%81%E6%94%AF%E4%BB%98%2F</url>
    <content type="text"><![CDATA[å‰è¨€æœ¬ç¯‡æ–‡ç« ä¸»è¦æ˜¯è®°å½•æœ¬äººåœ¨å¾®ä¿¡æ‰«ç æ”¯ä»˜è¿‡ç¨‹ä¸­æ‰€é‡åˆ°çš„é—®é¢˜ï¼Œç»™å¤§å®¶ä¸€ä¸ªå€Ÿé‰´ä½œç”¨ï¼Œå¸Œæœ›å¯¹ä½ ä»¬æœ‰å¸®åŠ© å¼€å‘çŽ¯å¢ƒ nodejs v8.1.0 egg v1.1.0 å‡†å¤‡å·¥ä½œ å¾®ä¿¡å…¬ä¼—å·-appid å¾®ä¿¡å•†æˆ·å·-mch_id keyå€¼(ç­¾åç®—æ³•æ‰€éœ€,å…¶å®žå°±æ˜¯ä¸€ä¸ª32ä½çš„å¯†ç ï¼Œå¯ä»¥ç”¨md5ç”Ÿæˆä¸€ä¸ª)(keyè®¾ç½®è·¯å¾„ï¼šå¾®ä¿¡å•†æˆ·å¹³å°(pay.weixin.qq.com)â€“&gt;è´¦æˆ·è®¾ç½®â€“&gt;APIå®‰å…¨â€“&gt;å¯†é’¥è®¾ç½®) æ‰«ç æ”¯ä»˜-ç»Ÿä¸€ä¸‹å•ä»¥ä¸‹æ‰ç”¨çš„æ˜¯å¾®ä¿¡æ¨¡å¼äºŒï¼Œå› ä¸ºæ¯”è¾ƒç®€å•123456789101112131415 let MD5 = require('md5'), xml2js = require('xml2js'), url = "https://api.mch.weixin.qq.com/pay/unifiedorder",// ä¸‹å•è¯·æ±‚åœ°å€ appid = 'å…¬ä¼—å·id', mch_id = 'å¾®ä¿¡å•†æˆ·å·'ï¼› notify_url = 'å›žè°ƒåœ°å€', out_trade_no = 'è‡ªå·±è®¾ç½®çš„è®¢å•å·',// å¾®ä¿¡ä¼šæœ‰è‡ªå·±è®¢å•å·ã€æˆ‘ä»¬è‡ªå·±çš„ç³»ç»Ÿéœ€è¦è®¾ç½®è‡ªå·±çš„è®¢å•å· total_fee = 'è®¢å•é‡‘é¢',// æ³¨æ„ï¼Œå•ä½ä¸ºåˆ† body = 'å•†å“ç®€å•æè¿°', trade_type = 'NATIVE',// äº¤æ˜“ç±»åž‹ï¼ŒJSAPI--å…¬ä¼—å·æ”¯ä»˜ã€NATIVE--åŽŸç”Ÿæ‰«ç æ”¯ä»˜ã€APP--appæ”¯ä»˜ nonce_str = moment().format('YYYYMMDDHHmmssSSS'),// éšæœºå­—ç¬¦ä¸²32ä½ä»¥ä¸‹ stringA = `appid=$&#123;å…¬ä¼—å·id&#125;&amp;body=$&#123;body&#125;&amp;mch_id=$&#123;å¾®ä¿¡å•†æˆ·å·&#125;&amp;nonce_str=$&#123;nonce_str&#125;&amp;notify_url=$&#123;notify_url&#125;&amp;out_trade_no=$&#123;out_trade_no&#125;&amp;spbill_create_ip=$&#123;ctx.request.ip&#125;&amp;total_fee=$&#123;total_fee&#125;&amp;trade_type=$&#123;trade_type&#125;`, stringSignTemp = stringA + "&amp;key=xxxxxxxxxxxxxxxxx", //æ³¨ï¼škeyä¸ºå•†æˆ·å¹³å°è®¾ç½®çš„å¯†é’¥key sign = MD5(stringSignTemp).toUpperCase(); //æ³¨ï¼šMD5ç­¾åæ–¹å¼ ä»¥ä¸Šå°±æ˜¯æˆ‘ä»¬æ‰€éœ€è¦çš„ä¸€äº›å‚æ•°ç­¾åç”Ÿæˆç®—æ³•è§å¾®ä¿¡å®˜æ–¹spbill_create_ip æ˜¯ ç»ˆç«¯ipåœ°å€ ä¸‹é¢æŠŠæ‰€æœ‰çš„å‚æ•°æ‹¼æŽ¥æˆxml123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657 const formData = "&lt;xml&gt;"; formData += "&lt;appid&gt;" + appid + "&lt;/appid&gt;"; //appid formData += "&lt;body&gt;" + body + "&lt;/body&gt;"; //å•†å“æˆ–æ”¯ä»˜å•ç®€è¦æè¿° formData += "&lt;mch_id&gt;" + mch_id + "&lt;/mch_id&gt;"; //å•†æˆ·å· formData += "&lt;nonce_str&gt;" + nonce_str + "&lt;/nonce_str&gt;"; //éšæœºå­—ç¬¦ä¸²ï¼Œä¸é•¿äºŽ32ä½ formData += "&lt;notify_url&gt;" + notify_url + "&lt;/notify_url&gt;"; //æ”¯ä»˜æˆåŠŸåŽå¾®ä¿¡æœåŠ¡å™¨é€šè¿‡POSTè¯·æ±‚é€šçŸ¥è¿™ä¸ªåœ°å€ formData += "&lt;out_trade_no&gt;" + out_trade_no + "&lt;/out_trade_no&gt;"; //è®¢å•å· formData += "&lt;total_fee&gt;" + total_fee + "&lt;/total_fee&gt;"; //é‡‘é¢ formData += "&lt;spbill_create_ip&gt;" + ctx.request.ip + "&lt;/spbill_create_ip&gt;"; //ip formData += "&lt;trade_type&gt;NATIVE&lt;/trade_type&gt;"; //NATIVEä¼šè¿”å›žcode_url ï¼ŒJSAPIä¸ä¼šè¿”å›ž formData += "&lt;sign&gt;" + sign + "&lt;/sign&gt;"; formData += "&lt;/xml&gt;"; // è¿™é‡Œä½¿ç”¨äº†eggé‡Œé¢è¯·æ±‚çš„æ–¹å¼const resultData = yield ctx.curl(url, &#123; method: 'POST', content: formData, headers: &#123; 'content-type': 'text/html', &#125;, &#125;);// xmlè½¬jsonæ ¼å¼xml2js.parseString(resultData.data, function (err, json) &#123; if (err) &#123; new Error("è§£æžxmlæŠ¥é”™") &#125; else &#123; var result = formMessage(json.xml); // è½¬æ¢æˆæ­£å¸¸çš„json æ•°æ® console.log(result) //æ‰“å°å‡ºè¿”å›žçš„ç»“æžœ &#125;&#125;) var formMessage = function (result) &#123; var message = &#123;&#125;; if (typeof result === 'object') &#123; var keys = Object.keys(result); for (var i = 0; i &lt; keys.length; i++) &#123; var item = result[keys[i]]; var key = keys[i]; if (!(item instanceof Array) || item.length === 0) &#123; continue; &#125; if (item.length === 1) &#123; var val = item[0]; if (typeof val === 'object') &#123; message[key] = formMessage(val); &#125; else &#123; message[key] = (val || '').trim(); &#125; &#125; else &#123; message[key] = []; for (var j = 0, k = item.length; j &lt; k; j++) &#123; message[key].push(formMessage(itemp[j])); &#125; &#125; &#125; &#125; return message; &#125; ä¸Šé¢ä½¿ç”¨äº†eggçš„è¯·æ±‚æ–¹å¼ï¼Œnodeå¯ä»¥ä½¿ç”¨request123456789var request = require('request');request(&#123; url: url, method: "POST", body: formData&#125;, function(error, response, body) &#123; if (!error &amp;&amp; response.statusCode == 200) &#123; &#125;&#125;); å¦‚æžœè¯·æ±‚æˆåŠŸä¼šæœ€ç»ˆè¿”å›žä¸€ä¸ªxml,ç„¶åŽæˆ‘ä»¬è¿›è¡Œè§£æžæˆjsonçš„æ ¼å¼,é‡Œé¢ä¼šæœ‰ä¸€ä¸ªcode_urlå’Œout_trade_no,æˆ‘ä»¬éœ€è¦æŠŠè¿™ä¸¤ä¸ªè¿”å›žç»™å‰ç«¯ï¼Œç„¶åŽé€šè¿‡ç”ŸæˆäºŒç»´ç å±•ç¤ºç»™ç”¨æˆ·æ‰«ç ï¼Œå®Œæˆæ”¯ä»˜ ç›‘å¬æ”¯ä»˜æ˜¯å¦æˆåŠŸä¸Šé¢æ“ä½œå®Œæˆä¹‹åŽï¼Œæˆ‘ä»¬éœ€è¦çŸ¥é“ç”¨æˆ·æ˜¯å¦å®Œæˆæ”¯ä»˜ï¼Œå› ä¸ºç”¨æˆ·ä¼šåœç•™åœ¨è¯¥é¡µé¢ï¼Œæˆ‘ä»¬éœ€è¦åœ¨ç”¨æˆ·ä»˜å®Œæ¬¾ä¹‹åŽï¼Œé€šçŸ¥ç”¨æˆ·æ”¯ä»˜æˆåŠŸã€‚é¦–å…ˆï¼Œç”¨æˆ·å‘èµ·æ”¯ä»˜çš„æ—¶å€™æˆ‘ä»¬ä¼šç”ŸæˆäºŒç»´ç ï¼Œè®©ç”¨æˆ·å®Œæˆæ‰«ç æ”¯ä»˜ï¼Œæˆ‘ä»¬è¿˜è¦åšçš„æ˜¯ï¼Œå¼€ä¸€ä¸ªå®šæ—¶å™¨ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´åŽ»å‘é€ä¸€ä¸ªè¯·æ±‚ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæˆ‘ä»¬nodeåŽå°å°±éœ€è¦å†™ä¸€ä¸ªæŸ¥è¯¢è®¢å•çš„æŽ¥å£ï¼Œä¹‹å‰æˆ‘ä»¬æ‹¿åˆ°äº†out_trade_noï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç³»ç»Ÿå†…éƒ¨çš„è®¢å•å·ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ•°æ®å‘é€ç»™åŽå°æŸ¥è¯¢è®¢å•çš„æŽ¥å£ï¼Œç„¶åŽåŽå°æŽ¥æ”¶åˆ°ä¹‹åŽä¼šè¯·æ±‚å¾®ä¿¡çš„æŸ¥è¯¢æŽ¥å£åœ°å€https://api.mch.weixin.qq.com/pay/orderquery,æµç¨‹è·Ÿä¸Šé¢ä¸€æ ·ï¼Œåªæ˜¯æŽ¥å£åœ°å€å’Œå¾®ä¿¡è¿”å›žçš„xmlä¸ä¸€æ ·è€Œå·²ï¼Œè¿”å›žçš„å­—æ®µä¼šæœ‰ä¸€ä¸ªçŠ¶æ€å³SUCCESSå’ŒNOTPAYï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡åˆ¤æ–­æ˜¯å¦æ”¯ä»˜è¿”å›žç»™å‰ç«¯ï¼ŒæˆåŠŸä¹‹åŽæç¤ºç»™ç”¨æˆ·æ”¯ä»˜æˆåŠŸï¼Œå…³é—­å®šæ—¶å™¨ã€‚ å›žè°ƒåœ°å€è¿™ä¸ªæ˜¯éžå¸¸é‡è¦çš„ä¸€çŽ¯ï¼Œå¤§éƒ¨åˆ†çš„æ“ä½œå…¶å®žåœ¨ä¸Šé¢å°±å¯ä»¥å®Œæˆï¼Œä½†æ˜¯æœ‰ç‰¹æ®Šçš„æƒ…å†µï¼Œæ¯”å¦‚ç”¨æˆ·ç”µè„‘æ–­ç½‘å‘é€ä¸äº†è¯·æ±‚ï¼Œä½†æ˜¯æ‰‹æœºä»˜æ¬¾äº†ï¼Œè¿™å°±ä¼šå¯¼è‡´æˆ‘ä»¬è®°å½•ä¸åˆ°ç”¨æˆ·æ”¯ä»˜çš„ä¿¡æ¯ã€‚è¿™ä¸ªæ—¶å€™å›žè°ƒåœ°å€å°±å¾ˆé‡è¦äº† è®¾ç½®å›žè°ƒåœ°å€å¾®ä¿¡å•†æˆ·ä¸­å¿ƒ-&gt;äº§å“ä¸­å¿ƒ-&gt;å¼€å‘é…ç½®-&gt;æ‰«ç æ”¯ä»˜ ä¹‹åŽæˆ‘ä»¬éœ€è¦åšçš„æ˜¯åŽç«¯ç”¨postæ¥æŽ¥æ”¶å¾®ä¿¡å‘é€çš„å¼‚æ­¥å›žè°ƒä¿¡æ¯ï¼Œä¹Ÿæ˜¯xmlçš„æ ¼å¼ï¼Œè¿™é‡Œæ³¨æ„ï¼Œå¦‚æžœä¸æ”¯æŒæŽ¥æ”¶xmlï¼Œå¯èƒ½ä¼šå¾—åˆ°ç©ºçš„æ•°æ®è¿™é‡Œè¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæˆ‘ä»¬åœ¨ä¿å­˜ç”¨æˆ·æ”¯ä»˜ä¿¡æ¯çš„åŒæ—¶ï¼Œå¾—å…ˆæŸ¥æ”¹è®¢å•æ˜¯å¦æ”¯ä»˜ï¼Œä»¥å…é‡å¤æ“ä½œï¼Œå¯èƒ½ä¼šæ’å…¥å¤šæ¡è®°å½•çš„æƒ…å†µ æ€»ç»“å¾®ä¿¡æ‰«ç æ”¯ä»˜å‘è¿˜æ˜¯æœ‰çš„ï¼Œå¦‚æžœä½ æ˜¯ç¬¬ä¸€æ¬¡æ‘¸ç´¢çš„è¯ï¼Œä¸‹é¢ç½—åˆ—ä¸€ä¸‹éœ€è¦æ³¨æ„çš„åœ°æ–¹ ç­¾åç®—æ³•è¦å†™æ­£ç¡®ï¼Œä¸ç„¶æ˜¯ä¸ä¼šæˆåŠŸçš„ï¼Œè¦æ‹¼æŽ¥æ­£ç¡®æ‰è¡Œ å¾®ä¿¡è¿”å›žçš„æ˜¯xmlæ ¼å¼çš„æ•°æ®ï¼Œæˆ‘ä»¬å¾—é€šè¿‡æ’ä»¶è½¬æˆjsonï¼Œè¿™æ ·æ‰æ–¹ä¾¿èŽ·å–æ•°æ® è¿”å›žçš„code_urlè¦ç»™å‰ç«¯ç”ŸæˆäºŒç»´ç ç”¨ï¼Œç„¶åŽéœ€è¦å¼€ä¸€ä¸ªå®šæ—¶å™¨æŸ¥è¯¢è¯¥è®¢å•æ˜¯å¦å®Œæˆæ”¯ä»˜ï¼Œæœ€ç»ˆé€šçŸ¥ç”¨æˆ·ç»“æžœ å›žè°ƒåœ°å€å¾ˆé‡è¦ï¼Œæˆ‘ä»¬åŽç«¯éœ€è¦postæŽ¥æ”¶å¾®ä¿¡è¿”å›žçš„å›žè°ƒä¿¡æ¯ï¼Œç„¶åŽä¿å­˜ä¿¡æ¯ï¼Œä¸è¿‡åœ¨ä¿å­˜ç”¨æˆ·æ”¯ä»˜ä¿¡æ¯çš„ä¹‹å‰ï¼Œæˆ‘ä»¬å¾—çŸ¥é“è¯¥è®¢å•æ˜¯å¦å·²ç»ä¿å­˜è¿‡ï¼Œä»¥å…é‡å¤æ·»åŠ ã€‚è¿˜æœ‰å°±æ˜¯è¿”å›žçš„æ˜¯xmlçš„æ•°æ®ï¼ŒåŽç«¯ä¸€å®šè¦ä¿è¯èƒ½å¤ŸæŽ¥æ”¶å¾—åˆ°ï¼ŒæŒ‰ç…§æ­£å¸¸çš„æ–¹å¼æ˜¯æŽ¥æ”¶ä¸äº†çš„ï¼Œå¾—é¢å¤–è®¾ç½®ã€‚ ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
        <category>node</category>
        <category>å¾®ä¿¡æ”¯ä»˜</category>
        <category>egg</category>
      </categories>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>Node</tag>
        <tag>Egg</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[ä½¿ç”¨ Vue2.js + Node.js æ­å»ºä¸€ä¸ªå°åž‹çš„å…¨æ ˆé¡¹ç›®]]></title>
    <url>%2F2017%2F09%2F08%2F%E4%BD%BF%E7%94%A8-Vue2-js-Node-js-%E6%90%AD%E5%BB%BA%E4%B8%80%E4%B8%AA%E5%B0%8F%E5%9E%8B%E7%9A%84%E5%85%A8%E6%A0%88%E9%A1%B9%E7%9B%AE%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢ç”±äºŽæœ€è¿‘å…¬å¸ä¸šåŠ¡ä¸æ˜¯å¾ˆå¿™ï¼Œç©ºé—²æ—¶é—´æ¯”è¾ƒå¤šï¼ŒäºŽæ˜¯å°±åœ¨çº ç»“Vue.jsï¼ˆä¹‹å‰å°±å­¦ä¹ è¿‡ï¼‰å’ŒNode.jså…ˆä¸“ç ”å“ªä¸ªæ¯”è¾ƒå¥½ï¼Œæœ€ç»ˆé€‰æ‹©äº†å…ˆçŽ©çŽ©Node.jsã€‚ç»è¿‡ä¸€æ®µæ—¶é—´çš„å­¦ä¹ ï¼Œå°±æœ‰äº†æ•™ç¨‹ Node+Koa2+Mysql æ­å»ºç®€æ˜“åšå®¢ GitHubåœ°å€ï¼Œæƒ³è¦äº†è§£çš„å¯ä»¥å…ˆçœ‹çœ‹ï¼Œä¸ªäººæ°´å¹³æœ‰é™ï¼Œå¸Œæœ›å¯ä»¥å¸®åˆ°ä½ ã€‚å¤§æ¦‚è¿‡æ¥ä¸€ä¸ªå¤šæœˆï¼Œæˆ‘å†³å®šä¸¤è·¯å¼€å·¥ã€‚ä½¿ç”¨Node.jsç»™å‰ç«¯å†™æŽ¥å£ï¼Œé…å¤‡åŽå°ç®¡ç†åŠŸèƒ½ï¼Œå…ˆæŠŠåŽå°æ­å»ºå¥½ã€‚å¤§æ¦‚å‡ å¤©è¿‡åŽï¼ŒåŽå°ä¸€äº›ç®€å•çš„åŠŸèƒ½å®žçŽ°åŽï¼Œå°±å¼€å§‹ç”¨Vue.jså¼€å§‹æ­å»ºå‰å°ï¼Œä¹Ÿä¸€ç›´åœ¨æƒ³åšç‚¹ä»€ä¹ˆæ¯”è¾ƒå¥½ï¼ŒäºŽæ˜¯å°±åšäº†ä¸ªè±†ç“£è¯„åˆ†ç±»ä¼¼çš„é¡¹ç›®ã€‚ å‰ç«¯é¡¹ç›®åœ°å€ https://github.com/wclimb/vue-videoå‰ç«¯é¢„è§ˆ http://video.wclimb.site åŽç«¯é¡¹ç›®åœ°å€ https://github.com/wclimb/video-adminåŽå°ç®¡ç† http://vue.wclimb.site APIæŽ¥å£åœ°å€ https://github.com/wclimb/video-admin/blob/master/API.md æŠ€æœ¯æ ˆ(Vue2.js + Node.js å…¨æ ˆé¡¹ç›®) ç”±äºŽé¡µé¢ä¸æ˜¯å¾ˆå¤šï¼Œvuexç”¨çš„ä¸å¤šï¼Œå…³é”®æŽŒæ¡æ€Žä¹ˆå®žçŽ°å°±å¥½äº† vue2 + vuex + vue-router + webpack + fetch + sass + flex + svg + é˜¿é‡Œå­—ä½“å›¾æ ‡ è¿è¡Œ1234567891011git clone https://github.com/wclimb/vue-video.gitcd vue-videonpm install å»ºè®®ä½¿ç”¨æ·˜å®é•œåƒ(https://npm.taobao.org/) =&gt; cnpm inpm run dev (è¿è¡Œé¡¹ç›®)npm run build (æ‰“åŒ…é¡¹ç›®)ps: å¦‚æžœæ‰“åŒ…ä¹‹åŽæ–‡ä»¶è¿è¡Œä¸äº†ï¼Œè¯·æ‰“åŒ…ä¹‹å‰æŠŠè·¯ç”±çš„ mode:&apos;history&apos;æ³¨é‡ŠæŽ‰ï¼Œè¯¥åŠŸèƒ½åŽ»æŽ‰äº†urlä¸­ä¸‘é™‹çš„ # å· åŠŸèƒ½ æ³¨å†Œç™»å½•ç™»å‡º + éªŒè¯ç  å¯†ç æ£€æµ‹ï¼Œå¦‚æžœç”¨æˆ·ä¸å­˜åœ¨åˆ™è‡ªåŠ¨åˆ›å»º æ£€æµ‹æ˜¯å¦ç™»å½•ï¼Œå¦‚æžœæ²¡æœ‰ç™»å½•åˆ™ä¸å…è®¸è¯„è®ºå’Œè¯„ä»· å¯ä»¥ä¸Šä¼ å½±ç‰‡åˆ°åŽå°ï¼Œè¿›è¡Œå‰å°å±•ç¤º è¯„åˆ†åŠŸèƒ½ï¼Œåˆå§‹åŒ–è¯„åˆ†å¯ä»¥è‡ªç”±è®¾ç½®ï¼Œå¦‚æžœæ²¡æœ‰äººlikeåˆ™é»˜è®¤æ˜¾ç¤ºåŽŸå§‹è¯„åˆ†ï¼Œå¦‚æžœæœ‰åˆ™è®¡ç®—å½“å‰videçš„è¯„åˆ† ä¿®æ”¹ç”¨æˆ·åï¼Œæ£€æµ‹ç”¨æˆ·åæ˜¯å¦è·Ÿå…¶ä»–äººé‡å¤ ä¸Šä¼ å¤´åƒï¼Œé»˜è®¤æ²¡æœ‰å¤´åƒ è¯„è®ºåŠŸèƒ½ï¼Œè¯„è®ºä¹‹åŽå¯ä»¥åœ¨ä¸ªäººä¸­å¿ƒå±•ç¤ºï¼Œå¹¶ä¸”å¯ä»¥åˆ é™¤ æœç´¢åŠŸèƒ½ï¼Œå¯ä»¥æœç´¢å­˜åœ¨çš„å½±ç‰‡ï¼Œå¦‚æžœæ²¡æœ‰åˆ™æ˜¾ç¤ºæ— ç»“æžœ è‡ªå·±å–œæ¬¢çš„videoå’Œè¯„è®ºçš„å†…å®¹ä¼šåœ¨ä¸ªäººä¸­å¿ƒæ˜¾ç¤º ç»¼ä¸Šï¼š [x] æ³¨å†Œ [x] ç™»å½• [x] ç™»å‡º [x] éªŒè¯ç  [x] è¯¦æƒ…é¡µ [x] åˆ†ç±» [x] åˆ†ç±»å½±è§†åˆ—è¡¨ [x] ä¿®æ”¹ç”¨æˆ·å [x] ä¸Šä¼ å¤´åƒ [x] è¯„è®º [x] åˆ é™¤è¯„è®º [x] æœç´¢ [x] ä¸ªäººä¸­å¿ƒæ•°æ® å¦‚æžœè§‰å¾—å¯¹ä½ æœ‰å¸®åŠ©è¿˜æœ›å…³æ³¨ä¸€ä¸‹ï¼Œæœ‰é—®é¢˜å¯ä»¥å³ä½¿æå“Ÿï¼Œè§‰å¾—ä¸é”™çš„è¯starä¸€ä¸‹ä¹Ÿæ˜¯å¯ä»¥çš„å“Ÿ å‰ç«¯çº¿ä¸Šåœ°å€é¡¹ç›®æ˜¯æ‰‹æœºç«¯çš„ï¼Œè¯·ä½¿ç”¨è°·æ­Œæµè§ˆå™¨æ‰‹æœºé¢„è§ˆæ¨¡å¼ é¦–é¡µé»˜è®¤ä¸€ç§ç±»åˆ«åªæ˜¾ç¤º10ä¸ªï¼Œå¯ä»¥æŸ¥çœ‹æ›´å¤šæ˜¾ç¤ºå…¨éƒ¨ é¢„è§ˆï¼švue-video æ‰‹æœºæ‰«æå›¾ä¸‹äºŒç»´ç é¢„è§ˆ åŽç«¯çº¿ä¸Šåœ°å€æŠ€æœ¯æ ˆï¼šNode + Koa2 + Mysqlé¢„è§ˆï¼švideo-adminGitHub: ç®¡ç†åŽå° å‰ç«¯æ¼”ç¤º ä¸»é¡µ ç™»å½•é¡µ ä¸ªäººä¸­å¿ƒé¡µ è¯¦æƒ…é¡µ åŽå°æ¼”ç¤º æœ‰é—®é¢˜æ¬¢è¿Žåé¦ˆåœ¨ä½¿ç”¨ä¸­æœ‰ä»»ä½•é—®é¢˜ï¼Œæ¬¢è¿Žåé¦ˆç»™æˆ‘ï¼Œå¯ä»¥ç”¨ä»¥ä¸‹è”ç³»æ–¹å¼è·Ÿæˆ‘äº¤æµ é‚®ä»¶(875246904#qq.com, æŠŠ#æ¢æˆ@) QQ: 875246904 weibo: @wclimb ç›®å½•ç»“æž„12345678910111213141516171819|-- build // webpacké…ç½®æ–‡ä»¶|-- config // é¡¹ç›®æ‰“åŒ…è·¯å¾„|-- src // æºç ç›®å½•| |-- assets // å›¾ç‰‡æ–‡ä»¶| |-- base // ç§»åŠ¨ç«¯é€‚é…| |-- components // ç»„ä»¶| |-- data // æŽ¥å£| |-- router // è·¯ç”±é…ç½®| |-- store // çŠ¶æ€ç®¡ç†| |-- style // æ ·å¼| App.vue // é¡µé¢å…¥å£æ–‡ä»¶| main.js // ç¨‹åºå…¥å£æ–‡ä»¶|-- static // é™æ€èµ„æº|-- .babelrc // ES6è¯­æ³•ç¼–è¯‘é…ç½®|-- .editorconfig // ä»£ç ç¼–å†™è§„æ ¼|-- .gitignore // gitå¿½ç•¥çš„æ–‡ä»¶|-- .postcssrc.js // post-loaderçš„æ’ä»¶é…ç½®æ–‡ä»¶|-- index.html // å…¥å£htmlæ–‡ä»¶|-- package.json // é¡¹ç›®åŠå·¥å…·çš„ä¾èµ–é…ç½®æ–‡ä»¶ ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
        <category>node</category>
        <category>vue</category>
      </categories>
      <tags>
        <tag>Mysql</tag>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>Node</tag>
        <tag>Koa</tag>
        <tag>Vue</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[MySQLåŸºç¡€]]></title>
    <url>%2F2017%2F07%2F20%2FMySQL%E5%9F%BA%E7%A1%80%2F</url>
    <content type="text"><![CDATA[è½¬è½½è‡ª mysql-tutorial å¼€å§‹ä½¿ç”¨MySQL ä¸ºå…³ç³»åž‹æ•°æ®åº“(Relational Database Management System)ï¼Œä¸€ä¸ªå…³ç³»åž‹æ•°æ®åº“ç”±ä¸€ä¸ªæˆ–æ•°ä¸ªè¡¨æ ¼ç»„æˆ, å¦‚å›¾æ‰€ç¤ºçš„ä¸€ä¸ªè¡¨æ ¼ï¼š è¡¨å¤´(header): æ¯ä¸€åˆ—çš„åç§°; åˆ—(col): å…·æœ‰ç›¸åŒæ•°æ®ç±»åž‹çš„æ•°æ®çš„é›†åˆ; è¡Œ(row): æ¯ä¸€è¡Œç”¨æ¥æè¿°æŸä¸ªäºº/ç‰©çš„å…·ä½“ä¿¡æ¯; å€¼(value): è¡Œçš„å…·ä½“ä¿¡æ¯, æ¯ä¸ªå€¼å¿…é¡»ä¸Žè¯¥åˆ—çš„æ•°æ®ç±»åž‹ç›¸åŒ; é”®(key): è¡¨ä¸­ç”¨æ¥è¯†åˆ«æŸä¸ªç‰¹å®šçš„äºº\ç‰©çš„æ–¹æ³•, é”®çš„å€¼åœ¨å½“å‰åˆ—ä¸­å…·æœ‰å”¯ä¸€æ€§ã€‚ç™»å½•MySQL 123456mysql -h 127.0.0.1 -u ç”¨æˆ·å -pmysql -D æ‰€é€‰æ‹©çš„æ•°æ®åº“å -h ä¸»æœºå -u ç”¨æˆ·å -pmysql&gt; exit # é€€å‡º ä½¿ç”¨ â€œquit;â€ æˆ– â€œ\q;â€ ä¸€æ ·çš„æ•ˆæžœmysql&gt; status; # æ˜¾ç¤ºå½“å‰mysqlçš„versionçš„å„ç§ä¿¡æ¯mysql&gt; select version(); # æ˜¾ç¤ºå½“å‰mysqlçš„versionä¿¡æ¯mysql&gt; show global variables like 'port'; # æŸ¥çœ‹MySQLç«¯å£å· åˆ›å»ºæ•°æ®åº“å¯¹äºŽè¡¨çš„æ“ä½œéœ€è¦å…ˆè¿›å…¥åº“use åº“å; 12345678-- åˆ›å»ºä¸€ä¸ªåä¸º samp_db çš„æ•°æ®åº“ï¼Œæ•°æ®åº“å­—ç¬¦ç¼–ç æŒ‡å®šä¸º gbkcreate database samp_db character set gbk;drop database samp_db; -- åˆ é™¤ åº“åä¸ºsamp_dbçš„åº“show databases; -- æ˜¾ç¤ºæ•°æ®åº“åˆ—è¡¨ã€‚use samp_db; -- é€‰æ‹©åˆ›å»ºçš„æ•°æ®åº“samp_dbshow tables; -- æ˜¾ç¤ºsamp_dbä¸‹é¢æ‰€æœ‰çš„è¡¨åå­—describe è¡¨å; -- æ˜¾ç¤ºæ•°æ®è¡¨çš„ç»“æž„delete from è¡¨å; -- æ¸…ç©ºè¡¨ä¸­è®°å½• åˆ›å»ºæ•°æ®åº“è¡¨ ä½¿ç”¨ create table è¯­å¥å¯å®Œæˆå¯¹è¡¨çš„åˆ›å»º, create table çš„å¸¸è§å½¢å¼:è¯­æ³•ï¼šcreate table è¡¨åç§°(åˆ—å£°æ˜Ž); 1234567891011121314-- å¦‚æžœæ•°æ®åº“ä¸­å­˜åœ¨user_accountsè¡¨ï¼Œå°±æŠŠå®ƒä»Žæ•°æ®åº“ä¸­dropæŽ‰DROP TABLE IF EXISTS `user_accounts`;CREATE TABLE `user_accounts` ( `id` int(100) unsigned NOT NULL AUTO_INCREMENT primary key, `password` varchar(32) NOT NULL DEFAULT '' COMMENT 'ç”¨æˆ·å¯†ç ', `reset_password` tinyint(32) NOT NULL DEFAULT 0 COMMENT 'ç”¨æˆ·ç±»åž‹ï¼š0ï¼ä¸éœ€è¦é‡ç½®å¯†ç ï¼›1-éœ€è¦é‡ç½®å¯†ç ', `mobile` varchar(20) NOT NULL DEFAULT '' COMMENT 'æ‰‹æœº', `create_at` timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6), `update_at` timestamp(6) NOT NULL DEFAULT CURRENT_TIMESTAMP(6) ON UPDATE CURRENT_TIMESTAMP(6), -- åˆ›å»ºå”¯ä¸€ç´¢å¼•ï¼Œä¸å…è®¸é‡å¤ UNIQUE INDEX idx_user_mobile(`mobile`))ENGINE=InnoDB DEFAULT CHARSET=utf8COMMENT='ç”¨æˆ·è¡¨ä¿¡æ¯'; æ•°æ®ç±»åž‹çš„å±žæ€§è§£é‡Š NULLï¼šæ•°æ®åˆ—å¯åŒ…å«NULLå€¼ï¼› NOT NULLï¼šæ•°æ®åˆ—ä¸å…è®¸åŒ…å«NULLå€¼ï¼› DEFAULTï¼šé»˜è®¤å€¼ï¼› PRIMARYï¼šKEY ä¸»é”®ï¼› AUTO_INCREMENTï¼šè‡ªåŠ¨é€’å¢žï¼Œé€‚ç”¨äºŽæ•´æ•°ç±»åž‹ï¼› UNSIGNEDï¼šæ˜¯æŒ‡æ•°å€¼ç±»åž‹åªèƒ½ä¸ºæ­£æ•°ï¼› CHARACTER SET nameï¼šæŒ‡å®šä¸€ä¸ªå­—ç¬¦é›†ï¼› COMMENTï¼šå¯¹è¡¨æˆ–è€…å­—æ®µè¯´æ˜Žï¼› å¢žåˆ æ”¹æŸ¥SELECT SELECT è¯­å¥ç”¨äºŽä»Žè¡¨ä¸­é€‰å–æ•°æ®ã€‚è¯­æ³•ï¼šSELECT åˆ—åç§° FROM è¡¨åç§°è¯­æ³•ï¼šSELECT * FROM è¡¨åç§° 12345678910111213141516171819-- è¡¨stationå–ä¸ªåˆ«åå«sï¼Œè¡¨stationä¸­ä¸åŒ…å« å­—æ®µid=13æˆ–è€…14 çš„ï¼Œå¹¶ä¸”idä¸ç­‰äºŽ4çš„ æŸ¥è¯¢å‡ºæ¥ï¼Œåªæ˜¾ç¤ºidSELECT s.id from station s WHERE id in (13,14) and id not in (4);-- ä»Žè¡¨ Persons é€‰å– LastName åˆ—çš„æ•°æ®SELECT LastName FROM Persons-- ä»Žè¡¨ users é€‰å– id=3 çš„æ•°æ®ï¼Œå¹¶åªæ‹‰ä¸€æ¡æ•°æ®(æ®è¯´èƒ½ä¼˜åŒ–æ€§èƒ½)SELECT * FROM users where id=3 limit 1-- ç»“æžœé›†ä¸­ä¼šè‡ªåŠ¨åŽ»é‡å¤æ•°æ®SELECT DISTINCT Company FROM Orders -- è¡¨ Persons å­—æ®µ Id_P ç­‰äºŽ Orders å­—æ®µ Id_P çš„å€¼ï¼Œ-- ç»“æžœé›†æ˜¾ç¤º Personsè¡¨çš„ LastNameã€FirstNameå­—æ®µï¼ŒOrdersè¡¨çš„OrderNoå­—æ®µSELECT p.LastName, p.FirstName, o.OrderNo FROM Persons p, Orders o WHERE p.Id_P = o.Id_P -- gbk å’Œ utf8 ä¸­è‹±æ–‡æ··åˆæŽ’åºæœ€ç®€å•çš„åŠžæ³• -- ciæ˜¯ case insensitive, å³ â€œå¤§å°å†™ä¸æ•æ„Ÿâ€SELECT tag, COUNT(tag) from news GROUP BY tag order by convert(tag using gbk) collate gbk_chinese_ci;SELECT tag, COUNT(tag) from news GROUP BY tag order by convert(tag using utf8) collate utf8_unicode_ci; UPDATE Update è¯­å¥ç”¨äºŽä¿®æ”¹è¡¨ä¸­çš„æ•°æ®ã€‚è¯­æ³•ï¼šUPDATE è¡¨åç§° SET åˆ—åç§° = æ–°å€¼ WHERE åˆ—åç§° = æŸå€¼ 12345-- updateè¯­å¥è®¾ç½®å­—æ®µå€¼ä¸ºå¦ä¸€ä¸ªç»“æžœå–å‡ºæ¥çš„å­—æ®µupdate user set name = (select name from user1 where user1 .id = 1 )where id = (select id from user2 where user2 .name='å°è‹');-- æ›´æ–°è¡¨ orders ä¸­ id=1 çš„é‚£ä¸€è¡Œæ•°æ®æ›´æ–°å®ƒçš„ title å­—æ®µUPDATE `orders` set title='è¿™é‡Œæ˜¯æ ‡é¢˜' WHERE id=1; INSERT INSERT INTO è¯­å¥ç”¨äºŽå‘è¡¨æ ¼ä¸­æ’å…¥æ–°çš„è¡Œã€‚è¯­æ³•ï¼šINSERT INTO è¡¨åç§° VALUES (å€¼1, å€¼2,....)è¯­æ³•ï¼šINSERT INTO è¡¨åç§° (åˆ—1, åˆ—2,...) VALUES (å€¼1, å€¼2,....) 123456789101112-- å‘è¡¨ Persons æ’å…¥ä¸€æ¡å­—æ®µ LastName = JSLite å­—æ®µ Address = shanghaiINSERT INTO Persons (LastName, Address) VALUES ('JSLite', 'shanghai');-- å‘è¡¨ meeting æ’å…¥ å­—æ®µ a=1 å’Œå­—æ®µ b=2INSERT INTO meeting SET a=1,b=2;-- -- SQLå®žçŽ°å°†ä¸€ä¸ªè¡¨çš„æ•°æ®æ’å…¥åˆ°å¦å¤–ä¸€ä¸ªè¡¨çš„ä»£ç -- å¦‚æžœåªå¸Œæœ›å¯¼å…¥æŒ‡å®šå­—æ®µï¼Œå¯ä»¥ç”¨è¿™ç§æ–¹æ³•ï¼š-- INSERT INTO ç›®æ ‡è¡¨ (å­—æ®µ1, å­—æ®µ2, ...) SELECT å­—æ®µ1, å­—æ®µ2, ... FROM æ¥æºè¡¨;INSERT INTO orders (user_account_id, title) SELECT m.user_id, m.title FROM meeting m where m.id=1;-- å‘è¡¨ charger æ’å…¥ä¸€æ¡æ•°æ®ï¼Œå·²å­˜åœ¨å°±å¯¹è¡¨ charger æ›´æ–° `type`,`update_at` å­—æ®µï¼›INSERT INTO `charger` (`id`,`type`,`create_at`,`update_at`) VALUES (3,2,'2017-05-18 11:06:17','2017-05-18 11:06:17') ON DUPLICATE KEY UPDATE `id`=VALUES(`id`), `type`=VALUES(`type`), `update_at`=VALUES(`update_at`); DELETE DELETE è¯­å¥ç”¨äºŽåˆ é™¤è¡¨ä¸­çš„è¡Œã€‚è¯­æ³•ï¼šDELETE FROM è¡¨åç§° WHERE åˆ—åç§° = å€¼ 12345678-- åœ¨ä¸åˆ é™¤table_nameè¡¨çš„æƒ…å†µä¸‹åˆ é™¤æ‰€æœ‰çš„è¡Œï¼Œæ¸…ç©ºè¡¨ã€‚DELETE FROM table_name-- æˆ–è€…DELETE * FROM table_name-- åˆ é™¤ Personè¡¨å­—æ®µ LastName = 'JSLite' DELETE FROM Person WHERE LastName = 'JSLite' -- åˆ é™¤ è¡¨meeting id ä¸º2å’Œ3çš„ä¸¤æ¡æ•°æ®DELETE from meeting where id in (2,3); WHERE WHERE å­å¥ç”¨äºŽè§„å®šé€‰æ‹©çš„æ ‡å‡†ã€‚è¯­æ³•ï¼šSELECT åˆ—åç§° FROM è¡¨åç§° WHERE åˆ— è¿ç®—ç¬¦ å€¼ 12-- ä»Žè¡¨ Persons ä¸­é€‰å‡º Year å­—æ®µå¤§äºŽ 1965 çš„æ•°æ®SELECT * FROM Persons WHERE Year&gt;1965 AND å’Œ OR AND - å¦‚æžœç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶éƒ½æˆç«‹ï¼›OR - å¦‚æžœç¬¬ä¸€ä¸ªæ¡ä»¶å’Œç¬¬äºŒä¸ªæ¡ä»¶ä¸­åªè¦æœ‰ä¸€ä¸ªæˆç«‹ï¼› AND1234567-- åˆ é™¤ meeting è¡¨å­—æ®µ -- id=2 å¹¶ä¸” user_id=5 çš„æ•°æ® å’Œ-- id=3 å¹¶ä¸” user_id=6 çš„æ•°æ® DELETE from meeting where id in (2,3) and user_id in (5,6);-- ä½¿ç”¨ AND æ¥æ˜¾ç¤ºæ‰€æœ‰å§“ä¸º "Carter" å¹¶ä¸”åä¸º "Thomas" çš„äººï¼šSELECT * FROM Persons WHERE FirstName='Thomas' AND LastName='Carter'; OR12-- ä½¿ç”¨ OR æ¥æ˜¾ç¤ºæ‰€æœ‰å§“ä¸º "Carter" æˆ–è€…åä¸º "Thomas" çš„äººï¼šSELECT * FROM Persons WHERE firstname='Thomas' OR lastname='Carter' ORDER BY è¯­å¥é»˜è®¤æŒ‰ç…§å‡åºå¯¹è®°å½•è¿›è¡ŒæŽ’åºã€‚ORDER BY - è¯­å¥ç”¨äºŽæ ¹æ®æŒ‡å®šçš„åˆ—å¯¹ç»“æžœé›†è¿›è¡ŒæŽ’åºã€‚DESC - æŒ‰ç…§é™åºå¯¹è®°å½•è¿›è¡ŒæŽ’åºã€‚ASC - æŒ‰ç…§é¡ºåºå¯¹è®°å½•è¿›è¡ŒæŽ’åºã€‚ 12345678-- Companyåœ¨è¡¨Ordersä¸­ä¸ºå­—æ¯ï¼Œåˆ™ä¼šä»¥å­—æ¯é¡ºåºæ˜¾ç¤ºå…¬å¸åç§°SELECT Company, OrderNumber FROM Orders ORDER BY Company-- åŽé¢è·Ÿä¸Š DESC åˆ™ä¸ºé™åºæ˜¾ç¤ºSELECT Company, OrderNumber FROM Orders ORDER BY Company DESC-- Companyä»¥é™åºæ˜¾ç¤ºå…¬å¸åç§°ï¼Œå¹¶OrderNumberä»¥é¡ºåºæ˜¾ç¤ºSELECT Company, OrderNumber FROM Orders ORDER BY Company DESC, OrderNumber ASC IN IN - æ“ä½œç¬¦å…è®¸æˆ‘ä»¬åœ¨ WHERE å­å¥ä¸­è§„å®šå¤šä¸ªå€¼ã€‚IN - æ“ä½œç¬¦ç”¨æ¥æŒ‡å®šèŒƒå›´ï¼ŒèŒƒå›´ä¸­çš„æ¯ä¸€æ¡ï¼Œéƒ½è¿›è¡ŒåŒ¹é…ã€‚INå–å€¼è§„å¾‹ï¼Œç”±é€—å·åˆ†å‰²ï¼Œå…¨éƒ¨æ”¾ç½®æ‹¬å·ä¸­ã€‚è¯­æ³•ï¼šSELECT &quot;å­—æ®µå&quot;FROM &quot;è¡¨æ ¼å&quot;WHERE &quot;å­—æ®µå&quot; IN (&#39;å€¼ä¸€&#39;, &#39;å€¼äºŒ&#39;, ...); 12-- ä»Žè¡¨ Persons é€‰å– å­—æ®µ LastName ç­‰äºŽ Adamsã€CarterSELECT * FROM Persons WHERE LastName IN ('Adams','Carter') NOT NOT - æ“ä½œç¬¦æ€»æ˜¯ä¸Žå…¶ä»–æ“ä½œç¬¦ä¸€èµ·ä½¿ç”¨ï¼Œç”¨åœ¨è¦è¿‡æ»¤çš„å‰é¢ã€‚ 1SELECT vend_id, prod_name FROM Products WHERE NOT vend_id = 'DLL01' ORDER BY prod_name; UNION UNION - æ“ä½œç¬¦ç”¨äºŽåˆå¹¶ä¸¤ä¸ªæˆ–å¤šä¸ª SELECT è¯­å¥çš„ç»“æžœé›†ã€‚ 123456789-- åˆ—å‡ºæ‰€æœ‰åœ¨ä¸­å›½è¡¨ï¼ˆEmployees_Chinaï¼‰å’Œç¾Žå›½ï¼ˆEmployees_USAï¼‰çš„ä¸åŒçš„é›‡å‘˜åSELECT E_Name FROM Employees_China UNION SELECT E_Name FROM Employees_USA-- åˆ—å‡º meeting è¡¨ä¸­çš„ pic_urlï¼Œ-- station è¡¨ä¸­çš„ number_station åˆ«åè®¾ç½®æˆ pic_url é¿å…å­—æ®µä¸ä¸€æ ·æŠ¥é”™-- æŒ‰æ›´æ–°æ—¶é—´æŽ’åºSELECT id,pic_url FROM meeting UNION ALL SELECT id,number_station AS pic_url FROM station ORDER BY update_at;-- é€šè¿‡ UNION è¯­æ³•åŒæ—¶æŸ¥è¯¢äº† products è¡¨ å’Œ comments è¡¨çš„æ€»è®°å½•æ•°ï¼Œå¹¶ä¸”æŒ‰ç…§ count æŽ’åºSELECT 'product' AS type, count(*) as count FROM `products` union select 'comment' as type, count(*) as count FROM `comments` order by count; AS as - å¯ç†è§£ä¸ºï¼šç”¨ä½œã€å½“æˆï¼Œä½œä¸ºï¼›åˆ«åä¸€èˆ¬æ˜¯é‡å‘½ååˆ—åæˆ–è€…è¡¨åã€‚è¯­æ³•ï¼šselect column_1 as åˆ—1,column_2 as åˆ—2 from table as è¡¨ 12345678910111213141516SELECT * FROM Employee AS emp-- è¿™å¥æ„æ€æ˜¯æŸ¥æ‰¾æ‰€æœ‰Employee è¡¨é‡Œé¢çš„æ•°æ®ï¼Œå¹¶æŠŠEmployeeè¡¨æ ¼å‘½åä¸º empã€‚-- å½“ä½ å‘½åä¸€ä¸ªè¡¨ä¹‹åŽï¼Œä½ å¯ä»¥åœ¨ä¸‹é¢ç”¨ emp ä»£æ›¿ Employee.-- ä¾‹å¦‚ SELECT * FROM emp.SELECT MAX(OrderPrice) AS LargestOrderPrice FROM Orders-- åˆ—å‡ºè¡¨ Orders å­—æ®µ OrderPrice åˆ—æœ€å¤§å€¼ï¼Œ-- ç»“æžœé›†åˆ—ä¸æ˜¾ç¤º OrderPrice æ˜¾ç¤º LargestOrderPrice-- æ˜¾ç¤ºè¡¨ users_profile ä¸­çš„ name åˆ—SELECT t.name from (SELECT * from users_profile a) AS t;-- è¡¨ user_accounts å‘½ååˆ«å uaï¼Œè¡¨ users_profile å‘½ååˆ«å up-- æ»¡è¶³æ¡ä»¶ è¡¨ user_accounts å­—æ®µ id ç­‰äºŽ è¡¨ users_profile å­—æ®µ user_id-- ç»“æžœé›†åªæ˜¾ç¤ºmobileã€nameä¸¤åˆ—SELECT ua.mobile,up.name FROM user_accounts as ua INNER JOIN users_profile as up ON ua.id = up.user_id; JOIN ç”¨äºŽæ ¹æ®ä¸¤ä¸ªæˆ–å¤šä¸ªè¡¨ä¸­çš„åˆ—ä¹‹é—´çš„å…³ç³»ï¼Œä»Žè¿™äº›è¡¨ä¸­æŸ¥è¯¢æ•°æ®ã€‚ JOIN: å¦‚æžœè¡¨ä¸­æœ‰è‡³å°‘ä¸€ä¸ªåŒ¹é…ï¼Œåˆ™è¿”å›žè¡Œ INNER JOIN:åœ¨è¡¨ä¸­å­˜åœ¨è‡³å°‘ä¸€ä¸ªåŒ¹é…æ—¶ï¼ŒINNER JOIN å…³é”®å­—è¿”å›žè¡Œã€‚ LEFT JOIN: å³ä½¿å³è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»Žå·¦è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œ RIGHT JOIN: å³ä½¿å·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…ï¼Œä¹Ÿä»Žå³è¡¨è¿”å›žæ‰€æœ‰çš„è¡Œ FULL JOIN: åªè¦å…¶ä¸­ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨åŒ¹é…ï¼Œå°±è¿”å›žè¡Œ 12345SELECT Persons.LastName, Persons.FirstName, Orders.OrderNoFROM PersonsINNER JOIN OrdersON Persons.Id_P = Orders.Id_PORDER BY Persons.LastName; SQL å‡½æ•°COUNT COUNT è®©æˆ‘ä»¬èƒ½å¤Ÿæ•°å‡ºåœ¨è¡¨æ ¼ä¸­æœ‰å¤šå°‘ç¬”èµ„æ–™è¢«é€‰å‡ºæ¥ã€‚è¯­æ³•ï¼šSELECT COUNT(&quot;å­—æ®µå&quot;) FROM &quot;è¡¨æ ¼å&quot;; 1234567-- è¡¨ Store_Information æœ‰å‡ ç¬” store_name æ ä¸æ˜¯ç©ºç™½çš„èµ„æ–™ã€‚-- "IS NOT NULL" æ˜¯ "è¿™ä¸ªæ ä½ä¸æ˜¯ç©ºç™½" çš„æ„æ€ã€‚SELECT COUNT (Store_Name) FROM Store_Information WHERE Store_Name IS NOT NULL; -- èŽ·å– Persons è¡¨çš„æ€»æ•°SELECT COUNT(1) AS totals FROM Persons;-- èŽ·å–è¡¨ station å­—æ®µ user_id ç›¸åŒçš„æ€»æ•°select user_id, count(*) as totals from station group by user_id; MAX MAX å‡½æ•°è¿”å›žä¸€åˆ—ä¸­çš„æœ€å¤§å€¼ã€‚NULL å€¼ä¸åŒ…æ‹¬åœ¨è®¡ç®—ä¸­ã€‚è¯­æ³•ï¼šSELECT MAX(&quot;å­—æ®µå&quot;) FROM &quot;è¡¨æ ¼å&quot; 123-- åˆ—å‡ºè¡¨ Orders å­—æ®µ OrderPrice åˆ—æœ€å¤§å€¼ï¼Œ-- ç»“æžœé›†åˆ—ä¸æ˜¾ç¤º OrderPrice æ˜¾ç¤º LargestOrderPriceSELECT MAX(OrderPrice) AS LargestOrderPrice FROM Orders è§¦å‘å™¨ è¯­æ³•ï¼šcreate trigger &lt;è§¦å‘å™¨åç§°&gt;{ before | after} # ä¹‹å‰æˆ–è€…ä¹‹åŽå‡ºå‘insert | update | delete # æŒ‡æ˜Žäº†æ¿€æ´»è§¦å‘ç¨‹åºçš„è¯­å¥çš„ç±»åž‹on &lt;è¡¨å&gt; # æ“ä½œå“ªå¼ è¡¨for each row # è§¦å‘å™¨çš„æ‰§è¡Œé—´éš”ï¼Œfor each row é€šçŸ¥è§¦å‘å™¨æ¯éš”ä¸€è¡Œæ‰§è¡Œä¸€æ¬¡åŠ¨ä½œï¼Œè€Œä¸æ˜¯å¯¹æ•´ä¸ªè¡¨æ‰§è¡Œä¸€æ¬¡ã€‚&lt;è§¦å‘å™¨SQLè¯­å¥&gt; 123456789101112delimiter $CREATE TRIGGER set_userdate BEFORE INSERT on `message`for EACH ROWBEGIN set @statu = new.status; -- å£°æ˜Žå¤åˆ¶å˜é‡ statu if @statu = 0 then -- åˆ¤æ–­ statu æ˜¯å¦ç­‰äºŽ 0 UPDATE `user_accounts` SET status=1 WHERE openid=NEW.openid; end if;END$DELIMITER ; -- æ¢å¤ç»“æŸç¬¦å· OLDå’ŒNEWä¸åŒºåˆ†å¤§å°å†™ NEW ç”¨NEW.col_nameï¼Œæ²¡æœ‰æ—§è¡Œã€‚åœ¨DELETEè§¦å‘ç¨‹åºä¸­ï¼Œä»…èƒ½ä½¿ç”¨OLD.col_nameï¼Œæ²¡æœ‰æ–°è¡Œã€‚ OLD ç”¨OLD.col_nameæ¥å¼•ç”¨æ›´æ–°å‰çš„æŸä¸€è¡Œçš„åˆ— æ·»åŠ ç´¢å¼•æ™®é€šç´¢å¼•(INDEX) è¯­æ³•ï¼šALTER TABLE è¡¨åå­— ADD INDEX ç´¢å¼•åå­— ( å­—æ®µåå­— ) 1234567891011121314151617-- â€“ç›´æŽ¥åˆ›å»ºç´¢å¼•CREATE INDEX index_user ON user(title)-- â€“ä¿®æ”¹è¡¨ç»“æž„çš„æ–¹å¼æ·»åŠ ç´¢å¼•ALTER TABLE table_name ADD INDEX index_name ON (column(length))-- ç»™ user è¡¨ä¸­çš„ nameå­—æ®µ æ·»åŠ æ™®é€šç´¢å¼•(INDEX)ALTER TABLE `table` ADD INDEX index_name (name)-- â€“åˆ›å»ºè¡¨çš„æ—¶å€™åŒæ—¶åˆ›å»ºç´¢å¼•CREATE TABLE `table` ( `id` int(11) NOT NULL AUTO_INCREMENT , `title` char(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL , `content` text CHARACTER SET utf8 COLLATE utf8_general_ci NULL , `time` int(10) NULL DEFAULT NULL , PRIMARY KEY (`id`), INDEX index_name (title(length)))-- â€“åˆ é™¤ç´¢å¼•DROP INDEX index_name ON table ä¸»é”®ç´¢å¼•(PRIMARY key) è¯­æ³•ï¼šALTER TABLE è¡¨åå­— ADD PRIMARY KEY ( å­—æ®µåå­— ) 12-- ç»™ user è¡¨ä¸­çš„ idå­—æ®µ æ·»åŠ ä¸»é”®ç´¢å¼•(PRIMARY key)ALTER TABLE `user` ADD PRIMARY key (id); å”¯ä¸€ç´¢å¼•(UNIQUE) è¯­æ³•ï¼šALTER TABLE è¡¨åå­— ADD UNIQUE (å­—æ®µåå­—) 12-- ç»™ user è¡¨ä¸­çš„ creattime å­—æ®µæ·»åŠ å”¯ä¸€ç´¢å¼•(UNIQUE)ALTER TABLE `user` ADD UNIQUE (creattime); å…¨æ–‡ç´¢å¼•(FULLTEXT) è¯­æ³•ï¼šALTER TABLE è¡¨åå­— ADD FULLTEXT (å­—æ®µåå­—) 12-- ç»™ user è¡¨ä¸­çš„ description å­—æ®µæ·»åŠ å…¨æ–‡ç´¢å¼•(FULLTEXT)ALTER TABLE `user` ADD FULLTEXT (description); æ·»åŠ å¤šåˆ—ç´¢å¼• è¯­æ³•ï¼šALTER TABLE table_name ADD INDEX index_name ( column1, column2, column3) 12-- ç»™ user è¡¨ä¸­çš„ nameã€cityã€age å­—æ®µæ·»åŠ åå­—ä¸ºname_city_ageçš„æ™®é€šç´¢å¼•(INDEX)ALTER TABLE user ADD INDEX name_city_age (name(10),city,age); å»ºç«‹ç´¢å¼•çš„æ—¶æœºåœ¨WHEREå’ŒJOINä¸­å‡ºçŽ°çš„åˆ—éœ€è¦å»ºç«‹ç´¢å¼•ï¼Œä½†ä¹Ÿä¸å®Œå…¨å¦‚æ­¤ï¼š MySQLåªå¯¹&lt;ï¼Œ&lt;=ï¼Œ=ï¼Œ&gt;ï¼Œ&gt;=ï¼ŒBETWEENï¼ŒINä½¿ç”¨ç´¢å¼• æŸäº›æ—¶å€™çš„LIKEä¹Ÿä¼šä½¿ç”¨ç´¢å¼•ã€‚ åœ¨LIKEä»¥é€šé…ç¬¦%å’Œ_å¼€å¤´ä½œæŸ¥è¯¢æ—¶ï¼ŒMySQLä¸ä¼šä½¿ç”¨ç´¢å¼•ã€‚ 12345678-- æ­¤æ—¶å°±éœ€è¦å¯¹cityå’Œageå»ºç«‹ç´¢å¼•ï¼Œ-- ç”±äºŽmytableè¡¨çš„userameä¹Ÿå‡ºçŽ°åœ¨äº†JOINå­å¥ä¸­ï¼Œä¹Ÿæœ‰å¯¹å®ƒå»ºç«‹ç´¢å¼•çš„å¿…è¦ã€‚SELECT t.Name FROM mytable t LEFT JOIN mytable m ON t.Name=m.username WHERE m.age=20 AND m.city='ä¸Šæµ·';SELECT * FROM mytable WHERE username like'admin%'; -- è€Œä¸‹å¥å°±ä¸ä¼šä½¿ç”¨ï¼šSELECT * FROM mytable WHEREt Name like'%admin'; -- å› æ­¤ï¼Œåœ¨ä½¿ç”¨LIKEæ—¶åº”æ³¨æ„ä»¥ä¸Šçš„åŒºåˆ«ã€‚ ç´¢å¼•çš„æ³¨æ„äº‹é¡¹ ç´¢å¼•ä¸ä¼šåŒ…å«æœ‰NULLå€¼çš„åˆ— ä½¿ç”¨çŸ­ç´¢å¼• ä¸è¦åœ¨åˆ—ä¸Šè¿›è¡Œè¿ç®— ç´¢å¼•ä¼šå¤±æ•ˆ åˆ›å»ºåŽè¡¨çš„ä¿®æ”¹æ·»åŠ åˆ— è¯­æ³•ï¼šalter table è¡¨å add åˆ—å åˆ—æ•°æ®ç±»åž‹ [after æ’å…¥ä½ç½®]; ç¤ºä¾‹: 123456-- åœ¨è¡¨studentsçš„æœ€åŽè¿½åŠ åˆ— address: alter table students add address char(60);-- åœ¨åä¸º age çš„åˆ—åŽæ’å…¥åˆ— birthday: alter table students add birthday date after age;-- åœ¨åä¸º number_people çš„åˆ—åŽæ’å…¥åˆ— weeks: alter table students add column `weeks` varchar(5) not null default "" after `number_people`; ä¿®æ”¹åˆ— è¯­æ³•ï¼šalter table è¡¨å change åˆ—åç§° åˆ—æ–°åç§° æ–°æ•°æ®ç±»åž‹; 123456789-- å°†è¡¨ tel åˆ—æ”¹åä¸º telphone: alter table students change tel telphone char(13) default "-";-- å°† name åˆ—çš„æ•°æ®ç±»åž‹æ”¹ä¸º char(16): alter table students change name name char(16) not null;-- ä¿®æ”¹ COMMENT å‰é¢å¿…é¡»å¾—æœ‰ç±»åž‹å±žæ€§alter table students change name name char(16) COMMENT 'è¿™é‡Œæ˜¯åå­—';-- ä¿®æ”¹åˆ—å±žæ€§çš„æ—¶å€™ å»ºè®®ä½¿ç”¨modify,ä¸éœ€è¦é‡å»ºè¡¨-- changeç”¨äºŽä¿®æ”¹åˆ—åå­—ï¼Œè¿™ä¸ªéœ€è¦é‡å»ºè¡¨alter table meeting modify `weeks` varchar(20) NOT NULL DEFAULT "" COMMENT "å¼€æ”¾æ—¥æœŸ å‘¨ä¸€åˆ°å‘¨æ—¥ï¼š0~6ï¼Œé—´éš”ç”¨è‹±æ–‡é€—å·éš”å¼€"; åˆ é™¤åˆ— è¯­æ³•ï¼šalter table è¡¨å drop åˆ—åç§°; 12-- åˆ é™¤è¡¨studentsä¸­çš„ birthday åˆ—: alter table students drop birthday; é‡å‘½åè¡¨ è¯­æ³•ï¼šalter table è¡¨å rename æ–°è¡¨å; 12-- é‡å‘½å students è¡¨ä¸º workmates: alter table students rename workmates; æ¸…ç©ºè¡¨æ•°æ® æ–¹æ³•ä¸€ï¼šdelete from è¡¨å;æ–¹æ³•äºŒï¼štruncate from &quot;è¡¨å&quot;; DELETE:1. DMLè¯­è¨€;2. å¯ä»¥å›žé€€;3. å¯ä»¥æœ‰æ¡ä»¶çš„åˆ é™¤; TRUNCATE:1. DDLè¯­è¨€;2. æ— æ³•å›žé€€;3. é»˜è®¤æ‰€æœ‰çš„è¡¨å†…å®¹éƒ½åˆ é™¤;4. åˆ é™¤é€Ÿåº¦æ¯”deleteå¿«ã€‚ 1234-- æ¸…ç©ºè¡¨ä¸º workmates é‡Œé¢çš„æ•°æ®ï¼Œä¸åˆ é™¤è¡¨ã€‚ delete from workmates;-- åˆ é™¤workmatesè¡¨ä¸­çš„æ‰€æœ‰æ•°æ®ï¼Œä¸”æ— æ³•æ¢å¤truncate from workmates; åˆ é™¤æ•´å¼ è¡¨ è¯­æ³•ï¼šdrop table è¡¨å; 12-- åˆ é™¤ workmates è¡¨: drop table workmates; åˆ é™¤æ•´ä¸ªæ•°æ®åº“ è¯­æ³•ï¼šdrop database æ•°æ®åº“å; 12-- åˆ é™¤ samp_db æ•°æ®åº“: drop database samp_db; ä¸ªäººå°ç¨‹åº]]></content>
      <tags>
        <tag>æ•°æ®åº“</tag>
        <tag>mysql</tag>
        <tag>è½¬è½½</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¯»zeptoæºç ï¼Œå°è£…è‡ªå·±çš„zeptoåº“ ï¼ˆä¸‰ï¼‰]]></title>
    <url>%2F2017%2F07%2F18%2F%E8%AF%BBzepto%E6%BA%90%E7%A0%81%EF%BC%8C%E5%B0%81%E8%A3%85%E8%87%AA%E5%B7%B1%E7%9A%84zepto%E5%BA%93-%EF%BC%88%E4%B8%89%EF%BC%89%2F</url>
    <content type="text"><![CDATA[æœ¬ç¯‡ç€é‡è®²é€‰æ‹©å™¨$()é€‰æ‹©å™¨æœ¬ä¾‹æˆ‘ä»¬ä¸»è¦ä¿®æ”¹wclimb.init=function(selector){}é‡Œé¢çš„ä»£ç å°†wclimb.initä»£ç ä¿®æ”¹ä¸ºï¼š1234567891011121314151617181920var domif (!selector) return wclimb.Z()else if (typeof selector == 'string') &#123; dom = wclimb.qsa(document, selector)&#125;else if (typeof selector == 'function')&#123; return wclimb.ready(selector)&#125;else&#123; if (isArray(selector)) &#123; dom = compact(selector) &#125; else if (wclimb.isZ(selector)) return selector else&#123; if (isObject(selector)) dom = [selector], selector = null ; else dom=wclimb.qsa(document,selector) &#125;&#125;return wclimb.Z(dom, selector) é¦–å…ˆåˆ¤æ–­æ˜¯å¦å­˜åœ¨selectorï¼Œå¦‚æžœä¸å­˜åœ¨åˆ™ç›´æŽ¥return ç„¶åŽåˆ¤æ–­æ˜¯å¦æ˜¯å­—ç¬¦ä¸²ç±»åž‹ï¼Œå¦‚$(&#39;a b&#39;)ï¼Œå°†é€‰æ‹©çš„å…ƒç´ ä¿å­˜èµ·æ¥ å¦‚æžœæ˜¯å‡½æ•°åˆ™return wclimb.ready(selector)å°±æ˜¯æˆ‘ä»¬ç»å¸¸ç”¨çš„$(function(){}) åŽé¢åˆ¤æ–­æ˜¯å¦æ˜¯å½“å‰å¯¹è±¡çš„å®žä¾‹ï¼ˆç”¨äº†isZæ–¹æ³•ï¼‰è¿˜æœ‰åˆ¤æ–­æ˜¯å¦æ˜¯æ•°ç»„æˆ–å¯¹è±¡ æˆ‘ä»¬å…ˆåœ¨å‡½æ•°é¡¶éƒ¨æ·»åŠ å¦‚ä¸‹123emptyArray = [], concat = emptyArray.concat, filter = emptyArray.filterslice = emptyArray.slicefunction compact(array) &#123; return filter.call(array, function(item)&#123; return item != null &#125;) &#125; emptyArray = []ï¼Œé¿å…å‡ºçŽ°æ¯æ¬¡éƒ½é‡å¤åˆ›å»ºçš„ä¸€ä¸ªæ•°ç»„[]ç„¶åŽæ‹¿åˆ°æ•°ç»„é‡Œé¢çš„æ–¹æ³•compactå°±æ˜¯ä¸€ä¸ªæ•°ç»„ç­›é€‰ï¼Œå¦‚æžœæŸä¸ªå…ƒç´ ä¸å­˜åœ¨$([1,2,,,4]);åªä¼šåˆ›å»ºä¸€ä¸ª[1,2,4]çš„æ•°ç»„ wclimb.qsaæ–¹æ³•1234567891011121314151617wclimb.qsa=function(element, selector)&#123; var found, maybeID = selector[0] == '#', maybeClass = !maybeID &amp;&amp; selector[0] == '.', nameOnly = maybeID || maybeClass ? selector.slice(1) : selector, // Ensure that a 1 char tag name still gets checked isSimple = /^[\w-]*$/.test(nameOnly) return (element.getElementById &amp;&amp; isSimple &amp;&amp; maybeID) ? // Safari DocumentFragment doesn't have getElementById ( (found = element.getElementById(nameOnly)) ? [found] : [] ) : (element.nodeType !== 1 &amp;&amp; element.nodeType !== 9 &amp;&amp; element.nodeType !== 11) ? [] : slice.call( isSimple &amp;&amp; !maybeID &amp;&amp; element.getElementsByClassName ? // DocumentFragment doesn't have getElementsByClassName/TagName maybeClass ? element.getElementsByClassName(nameOnly) : // If it's simple, it could be a class element.getElementsByTagName(selector) : // Or a tag element.querySelectorAll(selector) // Or it's not simple, and we need to query all )&#125; è¿™é‡Œæˆ‘ç›´æŽ¥ç”¨äº†zeptoçš„ä»£ç wclimb.init=function(selector){}é‡Œçš„ä»£ç è¿˜ä½¿ç”¨äº†åˆ¤æ–­æ•°æ®ç±»åž‹çš„ä»£ç isArray`isObject` åˆ¤æ–­æ•°æ®ç±»åž‹åœ¨å‡½æ•°å¤–é¢æ·»åŠ å¦‚ä¸‹ä»£ç æ¥è¿›è¡Œæ•°æ®ç±»åž‹åˆ¤æ–­ 123456789101112// åˆ¤æ–­ç±»åž‹var obj_i=&#123;&#125;;['Boolean', 'Number','String', 'Function', 'Array' ,'Date', 'RegExp', 'Object' ,'Error'].forEach(function(el,idx)&#123; obj_i["[object " + el + "]"] = el.toLowerCase()&#125;)function type(obj) &#123; return obj == null ? String(obj) : obj_i[Object.prototype.toString.call(obj)] || "object"&#125;function isObject(obj) &#123; return type(obj) == "object" &#125; function isArray(obj) &#123; return type(obj) == "array" &#125;function isString(obj) &#123; return type(obj) == "string" &#125; wclimb.readyå‡½æ•°åœ¨å¤–é¢è®¾ç½®å¦‚ä¸‹å‡½æ•°123456wclimb.ready = function(fn) &#123; document.addEventListener('DOMContentLoaded',function() &#123; fn &amp;&amp; fn(); &#125;,false); document.removeEventListener('DOMContentLoaded',fn,true);&#125;; wclimb.isZå‡½æ•°ä¸‹é¢ä»£ç åˆ¤æ–­objectæ˜¯ä¸æ˜¯wclimb.Zçš„å®žä¾‹123wclimb.isZ = function(object) &#123; return object instanceof wclimb.Z&#125; çŽ°åœ¨è¯•è¯•ä»£ç å§ï¼Œæˆ‘ä»¬é¡ºä¾¿æŠŠaddClassé‡Œåˆ¤æ–­hasClassä»£ç æ³¨é‡ŠåŽ»æŽ‰äº† 123456789101112&lt;script&gt; // ready $(function()&#123; alert(1) &#125;) // addClass $('p').addClass('a b') // å®žä¾‹ console.log($(this)) // æ•°ç»„ $([1,23,3,,4])&lt;/script&gt; å…¨éƒ¨ä»£ç 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131(function()&#123; var wclimb = &#123;&#125;,$ emptyArray = [], concat = emptyArray.concat, filter = emptyArray.filter slice = emptyArray.slice function compact(array) &#123; return filter.call(array, function(item)&#123; return item != null &#125;) &#125; $ = function(selector)&#123; return wclimb.init(selector) &#125; wclimb.init = function(selector)&#123; var dom if (!selector) return wclimb.Z() else if (typeof selector == 'string') &#123; dom = wclimb.qsa(document, selector) &#125; else if (typeof selector == 'function')&#123; return wclimb.ready(selector) &#125; else&#123; if (isArray(selector)) &#123; dom = compact(selector) &#125; else if (wclimb.isZ(selector)) return selector else&#123; if (isObject(selector)) dom = [selector], selector = null ; else dom=wclimb.qsa(document,selector) &#125; &#125; return wclimb.Z(dom, selector) &#125; wclimb.Z = function(dom,selector)&#123; return new Z(dom,selector) &#125; function className(node, value)&#123; var klass = node.className || '' if (value === undefined) return klass node.className = value &#125; wclimb.Z.prototype = Z.prototype = &#123; each:function(callback)&#123; [].every.call(this, function(el, idx)&#123; return callback.call(el, idx, el) !== false &#125;) return this; &#125;, addClass:function(name)&#123; if (!name) return this return this.each(function(el,idx)&#123; if (!('className' in this)) return classList = []; var cls = className(this) name.split(/\s+/g).forEach(function(klass)&#123; if (!$(this).hasClass(klass)) classList.push(klass) &#125;, this) classList.length &amp;&amp; className(this, cls + (cls ? " " : "") + classList.join(" ")) &#125;) &#125;, hasClass : function(cls) &#123; var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)'); for (var i = 0; i &lt; this.length; i++) &#123; if (this[i].className.match(reg)) return true; return false; &#125; return this; &#125; &#125; wclimb.ready = function(fn) &#123; document.addEventListener('DOMContentLoaded',function() &#123; fn &amp;&amp; fn(); &#125;,false); document.removeEventListener('DOMContentLoaded',fn,true); &#125;; wclimb.qsa=function(element, selector)&#123; var found, maybeID = selector[0] == '#', maybeClass = !maybeID &amp;&amp; selector[0] == '.', nameOnly = maybeID || maybeClass ? selector.slice(1) : selector, // Ensure that a 1 char tag name still gets checked isSimple = /^[\w-]*$/.test(nameOnly) return (element.getElementById &amp;&amp; isSimple &amp;&amp; maybeID) ? // Safari DocumentFragment doesn't have getElementById ( (found = element.getElementById(nameOnly)) ? [found] : [] ) : (element.nodeType !== 1 &amp;&amp; element.nodeType !== 9 &amp;&amp; element.nodeType !== 11) ? [] : slice.call( isSimple &amp;&amp; !maybeID &amp;&amp; element.getElementsByClassName ? // DocumentFragment doesn't have getElementsByClassName/TagName maybeClass ? element.getElementsByClassName(nameOnly) : // If it's simple, it could be a class element.getElementsByTagName(selector) : // Or a tag element.querySelectorAll(selector) // Or it's not simple, and we need to query all ) &#125; function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length &#125; wclimb.isZ = function(object) &#123; return object instanceof wclimb.Z &#125; // åˆ¤æ–­ç±»åž‹ var obj_i=&#123;&#125;; ['Boolean', 'Number','String', 'Function', 'Array' ,'Date', 'RegExp', 'Object' ,'Error'].forEach(function(el,idx)&#123; obj_i["[object " + el + "]"] = el.toLowerCase() &#125;) function type(obj) &#123; return obj == null ? String(obj) : obj_i[Object.prototype.toString.call(obj)] || "object" &#125; function isObject(obj) &#123; return type(obj) == "object" &#125; function isArray(obj) &#123; return type(obj) == "array" &#125; function isString(obj) &#123; return type(obj) == "string" &#125; window.$ = window.wclimb = $&#125;)()]]></content>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>zepto</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¯»zeptoæºç ï¼Œå°è£…è‡ªå·±çš„zeptoåº“ï¼ˆäºŒï¼‰]]></title>
    <url>%2F2017%2F07%2F17%2F%E8%AF%BBzepto%E6%BA%90%E7%A0%81%EF%BC%8C%E5%B0%81%E8%A3%85%E8%87%AA%E5%B7%B1%E7%9A%84zepto%E5%BA%93%EF%BC%88%E4%BA%8C%EF%BC%89%2F</url>
    <content type="text"><![CDATA[è·ç¦»ä¸Šä¸€ç¯‡zeptoæºç åˆ†æžå·²ç»è¿‡åŽ»å¤§åŠä¸ªæœˆï¼Œæƒ³æƒ³è‡ªå·±éƒ½è¿‡æ„ä¸åŽ»ï¼Œä¸è¿‡ä¹‹å‰åˆ†äº«äº†ä¸€ç¯‡nodeåšå®¢æ•™ç¨‹ï¼Œè¿˜ç®—å¹²äº†ç‚¹æ­£äº‹ã€‚æŽ¥ä¸‹æ¥æˆ‘ä»¬ç»§ç»­å°è£…è‡ªå·±çš„åº“å§ ä¸ŠèŠ‚ä»£ç æ¦‚è§ˆ12345678910111213141516171819202122232425262728293031323334(function()&#123; var wclimb = &#123;&#125;,$ $ = function(selector)&#123; return wclimb.init(selector) &#125; wclimb.init = function(selector)&#123; var dom; dom = document.querySelectorAll(selector); return wclimb.Z(dom,selector) &#125; wclimb.Z = function(dom,selector)&#123; return new Z(dom,selector) &#125; wclimb.Z.prototype = Z.prototype = &#123; test:function()&#123; alert(1) &#125; &#125; function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length &#125; window.$ = window.wclimb = $&#125;)() eachæ–¹æ³• åœ¨wclimb.Z.prototype=Z.prototype=é‡Œé¢æ·»åŠ æ–¹æ³•each 12345678wclimb.Z.prototype = Z.prototype = &#123; each:function(callback)&#123; [].every.call(this, function(el, idx)&#123; return callback.call(el, idx, el) !== false &#125;) return this; &#125;&#125; é€šè¿‡æ•°ç»„çš„everyæ–¹æ³•è¿›è¡ŒéåŽ†ï¼Œç„¶åŽçœ‹çœ‹æ¯æ¬¡callbackæ˜¯ä¸æ˜¯éƒ½ä¸æ˜¯falseï¼Œå¦‚æžœæ˜¯åˆ™ç»“æŸéåŽ† æœ€åŽé€šè¿‡ return this æ¥è¾¾åˆ°é“¾å¼è°ƒç”¨çš„æ•ˆæžœ addClassæ–¹æ³•ç»§ç»­åœ¨é‡Œé¢æ·»åŠ addClassæ–¹æ³• 123456789101112131415161718addClass:function(name)&#123; if (!name) return this return this.each(function(el,idx)&#123; if (!('className' in this)) return classList = []; var cls = className(this) // newName = funcArg(this, name, idx, cls) name.split(/\s+/g).forEach(function(klass)&#123; // if (!$(this).hasClass(klass)) classList.push(klass) &#125;, this) classList.length &amp;&amp; className(this, cls + (cls ? " " : "") + classList.join(" ")) &#125;)&#125; æˆ‘ä»¬å…ˆåˆ¤æ–­nameå­˜åœ¨ä¸Žå¦ï¼Œæ²¡æœ‰å°±ç›´æŽ¥return thisï¼Œæ”¯æŒé“¾å¼è°ƒç”¨ æ–°å»ºä¸€ä¸ªæ•°ç»„ï¼Œå­˜æ”¾æˆ‘ä»¬è¦æ·»åŠ çš„classï¼Œå› ä¸ºå¯èƒ½è¦åŒæ—¶æ·»åŠ å¤šä¸ª é€šè¿‡è°ƒç”¨classNameæ–¹æ³•æ¥èŽ·å–ä¹‹å‰çš„classï¼Œå¹¶ä¿å­˜èµ·æ¥ã€‚clasNameæ–¹æ³•åœ¨ä¸‹é¢ æˆ‘ä»¬æ·»åŠ classä¸€èˆ¬æ˜¯è¿™æ ·addClass(&#39;a b c&#39;)ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡æ­£åˆ™è¡¨è¾¾å¼æŠŠä»–ä»¬ç”¨ç©ºæ ¼åˆ†å¼€/\s+/g,ç”¨+çš„åŽŸå› æ˜¯ï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªç©ºæ ¼çš„å­˜åœ¨ï¼ŒæŽ¥ç€å¯¹ä»–ä»¬è¿›è¡Œå¾ªçŽ¯ é€šè¿‡hasClassåˆ¤æ–­ä¹‹å‰æ˜¯å¦å·²ç»å­˜åœ¨éœ€è¦æ·»åŠ çš„classï¼Œå¦‚æžœæœ‰å°±pushåˆ°classListæ•°ç»„é‡Œé¢ã€‚æˆ‘ä»¬å…ˆæ³¨é‡ŠæŽ‰hasClassè¿™æ®µä»£ç ï¼Œå› ä¸ºå…¶ä¸­ç”¨åˆ°äº†$(this) ,querySelectoræ˜¯ä¸æ”¯æŒçš„å“Ÿï¼Œæ‰€ä»¥åŽé¢æˆ‘ä»¬å¾—ä½œåˆ¤æ–­ï¼Œåˆ¤æ–­$()è¿™é‡Œé¢æ”¾çš„æ˜¯å…ƒç´ ã€å‡½æ•°ã€ç±»æ•°ç»„ç­‰ç­‰ã€‚ æœ€åŽé€šè¿‡å‡½æ•°classNameæ–¹æ³•æŠŠä»–ä»¬ç”¨ç©ºæ ¼è¿žæŽ¥èµ·æ¥ å‘çŽ°é‡Œé¢æœ‰ä¸€ä¸ªæ²¡æœ‰å£°æ˜Žçš„classNameæ–¹æ³•æ‰€ä»¥æˆ‘ä»¬åœ¨wclimb.Z.prototype=Z.prototype=ä¸Šé¢å£°æ˜Žè¯¥å‡½æ•°1234567//èŽ·å–æˆ–è€…è®¾ç½®classfunction className(node, value)&#123; var klass = node.className || '' if (value === undefined) return klass node.className = value&#125; è¯¥æ–¹æ³•ä¸»è¦æ˜¯èŽ·å–classå’Œè®¾ç½®classçš„ä½œç”¨ hasClassæ–¹æ³•12345678hasClass : function(cls) &#123; var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)'); for (var i = 0; i &lt; this.length; i++) &#123; if (this[i].className.match(reg)) return true; return false; &#125; return this;&#125; é€šè¿‡æ­£åˆ™åŒ¹é…ï¼Œå¦‚æžœå­˜åœ¨åˆ™è¿”å›žtrueï¼Œå¦åˆ™è¿”å›žfalseï¼Œæœ€åŽreturn thisæ”¯æŒé“¾å¼è°ƒç”¨ çŽ°åœ¨æ¥è¯•è¯•æ•ˆæžœå§12345html: &lt;p class="a"&gt;&lt;/p&gt;js: $('p').addClass('test other') // &lt;p class="a test other"&gt;&lt;/p&gt; console.log($('p').hasClass('a')) // true ä»£ç 12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273(function()&#123; var wclimb = &#123;&#125;,$ $ = function(selector)&#123; return wclimb.init(selector) &#125; wclimb.init = function(selector)&#123; var dom; dom = document.querySelectorAll(selector); return wclimb.Z(dom,selector) &#125; wclimb.Z = function(dom,selector)&#123; return new Z(dom,selector) &#125; function className(node, value)&#123;//èŽ·å–æˆ–è€…è®¾ç½®class var klass = node.className || '' if (value === undefined) return klass node.className = value &#125; wclimb.Z.prototype = Z.prototype = &#123; each:function(callback)&#123; [].every.call(this, function(el, idx)&#123; return callback.call(el, idx, el) !== false &#125;) return this; &#125;, addClass:function(name)&#123; if (!name) return this return this.each(function(el,idx)&#123; if (!('className' in this)) return classList = []; var cls = className(this) name.split(/\s+/g).forEach(function(klass)&#123; // if (!$(this).hasClass(klass)) classList.push(klass) &#125;, this) classList.length &amp;&amp; className(this, cls + (cls ? " " : "") + classList.join(" ")) &#125;) &#125;, hasClass : function(cls) &#123; var reg = new RegExp('(\\s|^)' + cls + '(\\s|$)'); for (var i = 0; i &lt; this.length; i++) &#123; if (this[i].className.match(reg)) return true; return false; &#125; return this; &#125; &#125; function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length &#125; window.$ = window.wclimb = $&#125;)()]]></content>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>zepto</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[Node+Koa2+Mysql æ­å»ºç®€æ˜“åšå®¢]]></title>
    <url>%2F2017%2F07%2F12%2FNode-Koa2-Mysql-%E6%90%AD%E5%BB%BA%E7%AE%80%E6%98%93%E5%8D%9A%E5%AE%A2%2F</url>
    <content type="text"><![CDATA[Koa2-blog 2018-1-5 æ›´æ–°æ•™ç¨‹ï¼ˆæ–°å¢žä¸Šä¼ å¤´åƒã€æ–°å¢žåˆ†é¡µã€æ ·å¼æ”¹ç‰ˆã€å‘å¸ƒæ–‡ç« å’Œè¯„è®ºæ”¯æŒmarkdownè¯­æ³•ï¼‰çŽ°åœ¨GitHubçš„ä»£ç ç»“æž„æœ‰å˜ï¼Œä¼˜åŒ–äº†è›®å¤šä¸œè¥¿ Node+Koa2+Mysql æ­å»ºç®€æ˜“åšå®¢ é¢„è§ˆåœ°å€http://blog.wclimb.site å†™åœ¨å‰é¢æœ¬ç¯‡æ•™ç¨‹ä¸€æ–¹é¢æ˜¯ä¸ºäº†è‡ªå·±åœ¨å­¦ä¹ çš„è¿‡ç¨‹åŠ æ·±è®°å¿†ï¼Œä¹Ÿæ˜¯æ€»ç»“çš„è¿‡ç¨‹ã€‚å¦ä¸€æ–¹é¢ç»™å¯¹è¿™æ–¹é¢ä¸å¤ªäº†è§£çš„åŒå­¦ä»¥å€Ÿé‰´ç»éªŒã€‚å¦‚å‘çŽ°é—®é¢˜è¿˜æœ›æŒ‡æ­£ï¼Œå¦‚æžœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¸®åŠ©åˆ°äº†ä½ ï¼Œé‚£å°±èµè„¸ç»™ä¸ªstarå§ï¼Œhttps://github.com/wclimb/Koa2-blogä¸‹ä¸€ç¯‡å¯èƒ½æ˜¯ Node + express + mongoose æˆ– zeptoæºç ç³»åˆ—æ„Ÿè°¢æ‚¨çš„é˜…è¯»^_^psï¼šå…³äºŽmarkdownä»£ç ç¼©è¿›é—®é¢˜ï¼Œçœ‹èµ·æ¥ä¸å¤ªèˆ’æœï¼Œä½†å¤åˆ¶åˆ°ç¼–è¾‘å™¨æ˜¯æ­£å¸¸çš„å“Ÿï¼ æ¼”ç¤ºæ•ˆæžœ å¼€å‘çŽ¯å¢ƒ nodejs v8.1.0 koa v2.3.0 mysql v5.7.0 å‡†å¤‡å·¥ä½œæ–‡ä¸­ç”¨åˆ°äº†promiseã€async awaitç­‰è¯­æ³•ï¼Œæ‰€ä»¥ä½ éœ€è¦ä¸€ç‚¹es6çš„è¯­æ³•ï¼Œä¼ é€é—¨å½“ç„¶æ˜¯é˜®è€å¸ˆçš„æ•™ç¨‹äº† http://es6.ruanyifeng.com/ å¦‚æžœä½ å·²ç»é…ç½®å¥½nodeå’Œmysqlå¯ä»¥è·³è¿‡ ç»å¸¸ä¼šæœ‰äººé—®æŠ¥é”™çš„é—®é¢˜ï¼Œè¿è¡Œå‡ºé”™å¤§éƒ¨åˆ†æ˜¯å› ä¸ºä¸æ”¯æŒasyncï¼Œå‡çº§nodeç‰ˆæœ¬å¯è§£å†³ 1$ node -v æŸ¥çœ‹ä½ çš„nodeç‰ˆæœ¬ï¼Œå¦‚æžœè¿‡ä½Žåˆ™åŽ»nodejså®˜ç½‘ä¸‹è½½æ›¿æ¢ä¹‹å‰çš„ç‰ˆæœ¬ ä¸‹è½½mysqlï¼Œå¹¶è®¾ç½®å¥½ç”¨æˆ·åå’Œå¯†ç ï¼Œé»˜è®¤å¯ä»¥ä¸ºç”¨æˆ·åï¼šrootï¼Œå¯†ç ï¼š123456 1è¿›å…¥åˆ° bin ç›®å½•ä¸‹ æ¯”å¦‚ cd C:\Program Files\MySQL\MySQL Server 5.7\bin ç„¶åŽå¼€å¯mysql1$ mysql -u root -p è¾“å…¥å¯†ç ä¹‹åŽåˆ›å»ºdatabase(æ•°æ®åº“)ï¼Œnodesqlæ˜¯æˆ‘ä»¬åˆ›å»ºçš„æ•°æ®åº“1$ create database nodesql; è®°ä½sqlè¯­å¥åŽé¢ä¸€å®šè¦è·Ÿ;ç¬¦å·ï¼ŒæŽ¥ä¸‹æ¥çœ‹çœ‹æˆ‘ä»¬åˆ›å»ºå¥½çš„æ•°æ®åº“åˆ—è¡¨ 1$ show databases; å¯ç”¨åˆ›å»ºçš„æ•°æ®åº“1$ use nodesql; æŸ¥çœ‹æ•°æ®åº“ä¸­çš„è¡¨1$ show tables; æ˜¾ç¤ºEmpty set (0.00 sec)ï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å»ºè¡¨ï¼Œç¨åŽä¼šç”¨ä»£ç å»ºè¡¨æ³¨é‡Šï¼šè¿™æ˜¯åŽé¢å»ºè¡¨ä¹‹åŽçš„çŠ¶æ€ ç›®å½•ç»“æž„ config å­˜æ”¾é»˜è®¤æ–‡ä»¶ lib å­˜æ”¾æ“ä½œæ•°æ®åº“æ–‡ä»¶ middlewares å­˜æ”¾åˆ¤æ–­ç™»å½•ä¸Žå¦æ–‡ä»¶ public å­˜æ”¾æ ·å¼å’Œå¤´åƒæ–‡ä»¶ routes å­˜æ”¾è·¯ç”±æ–‡ä»¶ views å­˜æ”¾æ¨¡æ¿æ–‡ä»¶ index ç¨‹åºä¸»æ–‡ä»¶ package.json åŒ…æ‹¬é¡¹ç›®åã€ä½œè€…ã€ä¾èµ–ç­‰ç­‰ é¦–å…ˆæˆ‘ä»¬åˆ›å»ºkoa2-blogæ–‡ä»¶å¤¹ï¼Œç„¶åŽcd koa2-blog1æŽ¥ç€ä½¿ç”¨ npm init æ¥åˆ›å»ºpackage.json æŽ¥ç€å®‰è£…åŒ…ï¼Œå®‰è£…ä¹‹å‰æˆ‘ä»¬ä½¿ç”¨cnpmå®‰è£…1$ npm install -g cnpm --registry=https://registry.npm.taobao.org 1$ cnpm i koa koa-bodyparser koa-mysql-session koa-router koa-session-minimal koa-static koa-views md5 moment mysql ejs markdown-it chai mocha koa-static-cache --save-dev å„æ¨¡å—ç”¨å¤„ koa nodeæ¡†æž¶ koa-bodyparser è¡¨å•è§£æžä¸­é—´ä»¶ koa-mysql-sessionã€koa-session-minimal å¤„ç†æ•°æ®åº“çš„ä¸­é—´ä»¶ koa-router è·¯ç”±ä¸­é—´ä»¶ koa-static é™æ€èµ„æºåŠ è½½ä¸­é—´ä»¶ ejs æ¨¡æ¿å¼•æ“Ž md5 å¯†ç åŠ å¯† moment æ—¶é—´ä¸­é—´ä»¶ mysql æ•°æ®åº“ markdown-it markdownè¯­æ³• koa-views æ¨¡æ¿å‘ˆçŽ°ä¸­é—´ä»¶ chai mocha æµ‹è¯•ä½¿ç”¨ koa-static-cache æ–‡ä»¶ç¼“å­˜ åœ¨æ–‡ä»¶å¤¹é‡Œé¢æ–°å»ºæ‰€éœ€æ–‡ä»¶ é¦–å…ˆé…ç½®configæˆ‘ä»¬æ–°å»ºdefault.jsæ–‡ä»¶ 123456789101112131415const config = &#123; // å¯åŠ¨ç«¯å£ port: 3000, // æ•°æ®åº“é…ç½® database: &#123; DATABASE: &apos;nodesql&apos;, USERNAME: &apos;root&apos;, PASSWORD: &apos;123456&apos;, PORT: &apos;3306&apos;, HOST: &apos;localhost&apos; &#125;&#125;module.exports = config è¿™æ˜¯æˆ‘ä»¬æ‰€éœ€çš„ä¸€äº›å­—æ®µï¼ŒåŒ…æ‹¬ç«¯å£å’Œæ•°æ®åº“è¿žæŽ¥æ‰€éœ€ï¼Œæœ€åŽæˆ‘ä»¬æŠŠå®ƒexportsæš´éœ²å‡ºåŽ»ï¼Œä»¥ä¾¿å¯ä»¥åœ¨åˆ«çš„åœ°æ–¹ä½¿ç”¨ é…ç½®index.jsæ–‡ä»¶index.js 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859const Koa=require('koa');const path=require('path')const bodyParser = require('koa-bodyparser');const ejs=require('ejs');const session = require('koa-session-minimal');const MysqlStore = require('koa-mysql-session');const config = require('./config/default.js');const router=require('koa-router')const views = require('koa-views')// const koaStatic = require('koa-static')const staticCache = require('koa-static-cache')const app = new Koa()// sessionå­˜å‚¨é…ç½®const sessionMysqlConfig= &#123; user: config.database.USERNAME, password: config.database.PASSWORD, database: config.database.DATABASE, host: config.database.HOST,&#125;// é…ç½®sessionä¸­é—´ä»¶app.use(session(&#123; key: 'USER_SID', store: new MysqlStore(sessionMysqlConfig)&#125;))// é…ç½®é™æ€èµ„æºåŠ è½½ä¸­é—´ä»¶// app.use(koaStatic(// path.join(__dirname , './public')// ))// ç¼“å­˜app.use(staticCache(path.join(__dirname, './public'), &#123; dynamic: true &#125;, &#123; maxAge: 365 * 24 * 60 * 60&#125;))app.use(staticCache(path.join(__dirname, './images'), &#123; dynamic: true &#125;, &#123; maxAge: 365 * 24 * 60 * 60&#125;))// é…ç½®æœåŠ¡ç«¯æ¨¡æ¿æ¸²æŸ“å¼•æ“Žä¸­é—´ä»¶app.use(views(path.join(__dirname, './views'), &#123; extension: 'ejs'&#125;))app.use(bodyParser(&#123; formLimit: '1mb'&#125;))// è·¯ç”±(æˆ‘ä»¬å…ˆæ³¨é‡Šä¸‰ä¸ªï¼Œç­‰åŽé¢æ·»åŠ å¥½äº†å†å–æ¶ˆæ³¨é‡Šï¼Œå› ä¸ºæˆ‘ä»¬è¿˜æ²¡æœ‰å®šä¹‰è·¯ç”±ï¼Œç¨åŽä¼šå…ˆå®žçŽ°æ³¨å†Œ)//app.use(require('./routers/signin.js').routes())app.use(require('./routers/signup.js').routes())//app.use(require('./routers/posts.js').routes())//app.use(require('./routers/signout.js').routes())app.listen(3000)console.log(`listening on port $&#123;config.port&#125;`) æˆ‘ä»¬ä½¿ç”¨koa-session-minimal`koa-mysql-sessionæ¥è¿›è¡Œæ•°æ®åº“çš„æ“ä½œ ä½¿ç”¨koa-staticé…ç½®é™æ€èµ„æºï¼Œç›®å½•è®¾ç½®ä¸ºpublicä½¿ç”¨ejsæ¨¡æ¿å¼•æ“Ž ä½¿ç”¨koa-bodyparseræ¥è§£æžæäº¤çš„è¡¨å•ä¿¡æ¯ ä½¿ç”¨koa-routeråšè·¯ç”± ä½¿ç”¨koa-static-cache`æ¥ç¼“å­˜æ–‡ä»¶ä¹‹å‰æˆ‘ä»¬é…ç½®äº†default.jsï¼Œæˆ‘ä»¬å°±å¯ä»¥åœ¨è¿™é‡Œä½¿ç”¨äº†é¦–å…ˆå¼•å…¥è¿›æ¥ var config = require(â€˜./config/default.jsâ€™);ç„¶åŽåœ¨æ•°æ®åº“çš„æ“ä½œçš„æ—¶å€™ï¼Œå¦‚config.database.USERNAMEï¼Œå¾—åˆ°çš„å°±æ˜¯rootã€‚ å¦‚æžœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¸®åŠ©åˆ°äº†ä½ ï¼Œé‚£å°±èµè„¸ç»™ä¸ªstarå§ï¼Œhttps://github.com/wclimb/Koa2-blog é…ç½®libçš„mysql.jsæ–‡ä»¶å…³äºŽæ•°æ®åº“çš„ä½¿ç”¨è¿™é‡Œä»‹ç»ä¸€ä¸‹ï¼Œé¦–å…ˆæˆ‘ä»¬å»ºç«‹äº†æ•°æ®åº“çš„è¿žæŽ¥æ± ï¼Œä»¥ä¾¿åŽé¢çš„æ“ä½œéƒ½å¯ä»¥ä½¿ç”¨åˆ°ï¼Œæˆ‘ä»¬åˆ›å»ºäº†ä¸€ä¸ªå‡½æ•°queryï¼Œé€šè¿‡è¿”å›žpromiseçš„æ–¹å¼ä»¥ä¾¿å¯ä»¥æ–¹ä¾¿ç”¨.then()æ¥èŽ·å–æ•°æ®åº“è¿”å›žçš„æ•°æ®ï¼Œç„¶åŽæˆ‘ä»¬å®šä¹‰äº†ä¸‰ä¸ªè¡¨çš„å­—æ®µï¼Œé€šè¿‡createTableæ¥åˆ›å»ºæˆ‘ä»¬åŽé¢æ‰€éœ€çš„ä¸‰ä¸ªè¡¨ï¼ŒåŒ…æ‹¬posts(å­˜å‚¨æ–‡ç« )ï¼Œusers(å­˜å‚¨ç”¨æˆ·)ï¼Œcomment(å­˜å‚¨è¯„è®º)ï¼Œcreate table if not exists users()è¡¨ç¤ºå¦‚æžœusersè¡¨ä¸å­˜åœ¨åˆ™åˆ›å»ºè¯¥è¡¨ï¼Œé¿å…æ¯æ¬¡é‡å¤å»ºè¡¨æŠ¥é”™çš„æƒ…å†µã€‚åŽé¢æˆ‘ä»¬å®šä¹‰äº†ä¸€ç³»åˆ—çš„æ–¹æ³•ï¼Œæœ€åŽæŠŠä»–ä»¬exportsæš´éœ²å‡ºåŽ»ã€‚ è¿™é‡Œåªä»‹ç»æ³¨å†Œç”¨æˆ·insertDataï¼ŒåŽç»­çš„å¯ä»¥è‡ªè¡ŒæŸ¥çœ‹ï¼Œéƒ½å·®ä¸å¤š 12345// æ³¨å†Œç”¨æˆ·let insertData = function( value ) &#123; let _sql = "insert into users set name=?,pass=?,avator=?,moment=?;" return query( _sql, value )&#125; æˆ‘ä»¬å†™äº†ä¸€ä¸ª_sqlçš„sqlè¯­å¥ï¼Œæ„æ€æ˜¯æ’å…¥åˆ°usersçš„è¡¨ä¸­ï¼ˆåœ¨è¿™ä¹‹å‰æˆ‘ä»¬å·²ç»å»ºç«‹äº†usersè¡¨ï¼‰ç„¶åŽè¦æ’å…¥çš„æ•°æ®åˆ†åˆ«æ˜¯nameã€passã€avatorã€momentï¼Œå°±æ˜¯ç”¨æˆ·åã€å¯†ç ã€å¤´åƒã€æ³¨å†Œæ—¶é—´ï¼Œæœ€åŽè°ƒç”¨queryå‡½æ•°æŠŠsqlè¯­å¥ä¼ è¿›åŽ»ï¼ˆä¹‹å‰çš„å†™æ³•æ˜¯&quot;insert into users(name,pass) values(?,?);&quot;,æ¢æˆçŽ°åœ¨å¾—æ›´å®¹æ˜“ç†è§£ï¼‰ lib/mysql.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225var mysql = require('mysql');var config = require('../config/default.js')var pool = mysql.createPool(&#123; host : config.database.HOST, user : config.database.USERNAME, password : config.database.PASSWORD, database : config.database.DATABASE&#125;);let query = function( sql, values ) &#123; return new Promise(( resolve, reject ) =&gt; &#123; pool.getConnection(function(err, connection) &#123; if (err) &#123; reject( err ) &#125; else &#123; connection.query(sql, values, ( err, rows) =&gt; &#123; if ( err ) &#123; reject( err ) &#125; else &#123; resolve( rows ) &#125; connection.release() &#125;) &#125; &#125;) &#125;)&#125;// let query = function( sql, values ) &#123;// pool.getConnection(function(err, connection) &#123;// // ä½¿ç”¨è¿žæŽ¥// connection.query( sql,values, function(err, rows) &#123;// // ä½¿ç”¨è¿žæŽ¥æ‰§è¡ŒæŸ¥è¯¢// console.log(rows)// connection.release();// //è¿žæŽ¥ä¸å†ä½¿ç”¨ï¼Œè¿”å›žåˆ°è¿žæŽ¥æ± // &#125;);// &#125;);// &#125;let users = `create table if not exists users( id INT NOT NULL AUTO_INCREMENT, name VARCHAR(100) NOT NULL, pass VARCHAR(100) NOT NULL, avator VARCHAR(100) NOT NULL, moment VARCHAR(100) NOT NULL, PRIMARY KEY ( id ) );`let posts = `create table if not exists posts( id INT NOT NULL AUTO_INCREMENT, name VARCHAR(100) NOT NULL, title TEXT(0) NOT NULL, content TEXT(0) NOT NULL, md TEXT(0) NOT NULL, uid VARCHAR(40) NOT NULL, moment VARCHAR(100) NOT NULL, comments VARCHAR(200) NOT NULL DEFAULT '0', pv VARCHAR(40) NOT NULL DEFAULT '0', avator VARCHAR(100) NOT NULL, PRIMARY KEY ( id ) );`let comment = `create table if not exists comment( id INT NOT NULL AUTO_INCREMENT, name VARCHAR(100) NOT NULL, content TEXT(0) NOT NULL, moment VARCHAR(40) NOT NULL, postid VARCHAR(40) NOT NULL, avator VARCHAR(100) NOT NULL, PRIMARY KEY ( id ) );`let createTable = function( sql ) &#123; return query( sql, [] )&#125;// å»ºè¡¨createTable(users)createTable(posts)createTable(comment)// æ³¨å†Œç”¨æˆ·let insertData = function( value ) &#123; let _sql = "insert into users set name=?,pass=?,avator=?,moment=?;" return query( _sql, value )&#125;// åˆ é™¤ç”¨æˆ·let deleteUserData = function( name ) &#123; let _sql = `delete from users where name="$&#123;name&#125;";` return query( _sql )&#125;// æŸ¥æ‰¾ç”¨æˆ·let findUserData = function( name ) &#123; let _sql = `select * from users where name="$&#123;name&#125;";` return query( _sql )&#125;// å‘è¡¨æ–‡ç« let insertPost = function( value ) &#123; let _sql = "insert into posts set name=?,title=?,content=?,md=?,uid=?,moment=?,avator=?;" return query( _sql, value )&#125;// æ›´æ–°æ–‡ç« è¯„è®ºæ•°let updatePostComment = function( value ) &#123; let _sql = "update posts set comments=? where id=?" return query( _sql, value )&#125;// æ›´æ–°æµè§ˆæ•°let updatePostPv = function( value ) &#123; let _sql = "update posts set pv=? where id=?" return query( _sql, value )&#125;// å‘è¡¨è¯„è®ºlet insertComment = function( value ) &#123; let _sql = "insert into comment set name=?,content=?,moment=?,postid=?,avator=?;" return query( _sql, value )&#125;// é€šè¿‡åå­—æŸ¥æ‰¾ç”¨æˆ·let findDataByName = function ( name ) &#123; let _sql = `select * from users where name="$&#123;name&#125;";` return query( _sql)&#125;// é€šè¿‡æ–‡ç« çš„åå­—æŸ¥æ‰¾ç”¨æˆ·let findDataByUser = function ( name ) &#123; let _sql = `select * from posts where name="$&#123;name&#125;";` return query( _sql)&#125;// é€šè¿‡æ–‡ç« idæŸ¥æ‰¾let findDataById = function ( id ) &#123; let _sql = `select * from posts where id="$&#123;id&#125;";` return query( _sql)&#125;// é€šè¿‡è¯„è®ºidæŸ¥æ‰¾let findCommentById = function ( id ) &#123; let _sql = `select * FROM comment where postid="$&#123;id&#125;";` return query( _sql)&#125;// æŸ¥è¯¢æ‰€æœ‰æ–‡ç« let findAllPost = function () &#123; let _sql = ` select * FROM posts;` return query( _sql)&#125;// æŸ¥è¯¢åˆ†é¡µæ–‡ç« let findPostByPage = function (page) &#123; let _sql = ` select * FROM posts limit $&#123;(page-1)*10&#125;,10;` return query( _sql)&#125;// æŸ¥è¯¢ä¸ªäººåˆ†é¡µæ–‡ç« let findPostByUserPage = function (name,page) &#123; let _sql = ` select * FROM posts where name="$&#123;name&#125;" order by id desc limit $&#123;(page-1)*10&#125;,10 ;` return query( _sql)&#125;// æ›´æ–°ä¿®æ”¹æ–‡ç« let updatePost = function(values)&#123; let _sql = `update posts set title=?,content=?,md=? where id=?` return query(_sql,values)&#125;// åˆ é™¤æ–‡ç« let deletePost = function(id)&#123; let _sql = `delete from posts where id = $&#123;id&#125;` return query(_sql)&#125;// åˆ é™¤è¯„è®ºlet deleteComment = function(id)&#123; let _sql = `delete from comment where id=$&#123;id&#125;` return query(_sql)&#125;// åˆ é™¤æ‰€æœ‰è¯„è®ºlet deleteAllPostComment = function(id)&#123; let _sql = `delete from comment where postid=$&#123;id&#125;` return query(_sql)&#125;// æŸ¥æ‰¾è¯„è®ºæ•°let findCommentLength = function(id)&#123; let _sql = `select content from comment where postid in (select id from posts where id=$&#123;id&#125;)` return query(_sql)&#125;// æ»šåŠ¨æ— é™åŠ è½½æ•°æ®let findPageById = function(page)&#123; let _sql = `select * from posts limit $&#123;(page-1)*5&#125;,5;` return query(_sql)&#125;// è¯„è®ºåˆ†é¡µlet findCommentByPage = function(page,postId)&#123; let _sql = `select * from comment where postid=$&#123;postId&#125; order by id desc limit $&#123;(page-1)*10&#125;,10;` return query(_sql)&#125;module.exports = &#123; query, createTable, insertData, deleteUserData, findUserData, findDataByName, insertPost, findAllPost, findPostByPage, findPostByUserPage, findDataByUser, findDataById, insertComment, findCommentById, updatePost, deletePost, deleteComment, findCommentLength, updatePostComment, deleteAllPostComment, updatePostPv, findPageById, findCommentByPage&#125; ä¸‹é¢æ˜¯æˆ‘ä»¬å»ºçš„è¡¨ users posts comment id id id name name name pass title content avator content moment moment md postid - uid avator - moment - - comments - - pv - - avator - idä¸»é”®é€’å¢ž name: ç”¨æˆ·å passï¼šå¯†ç  avatorï¼šå¤´åƒ titleï¼šæ–‡ç« æ ‡é¢˜ contentï¼šæ–‡ç« å†…å®¹å’Œè¯„è®º mdï¼šmarkdownè¯­æ³• uidï¼šå‘è¡¨æ–‡ç« çš„ç”¨æˆ·id momentï¼šåˆ›å»ºæ—¶é—´ commentsï¼šæ–‡ç« è¯„è®ºæ•° pvï¼šæ–‡ç« æµè§ˆæ•° postidï¼šæ–‡ç« id çŽ°åœ¨æ„Ÿè§‰æœ‰ç‚¹æž¯ç‡¥ï¼Œé‚£æˆ‘ä»¬å…ˆæ¥å®žçŽ°ä¸€ä¸‹æ³¨å†Œå§ å®žçŽ°æ³¨å†Œé¡µé¢routers/singup.js12345678910111213141516const router = require('koa-router')();const userModel = require('../lib/mysql.js');const md5 = require('md5')const checkNotLogin = require('../middlewares/check.js').checkNotLoginconst checkLogin = require('../middlewares/check.js').checkLoginconst moment = require('moment');const fs = require('fs')// æ³¨å†Œé¡µé¢router.get('/signup', async(ctx, next) =&gt; &#123; await checkNotLogin(ctx) await ctx.render('signup', &#123; session: ctx.session, &#125;)&#125;) module.exports = router ä½¿ç”¨getæ–¹å¼å¾—åˆ°â€™/signupâ€™é¡µé¢ï¼Œç„¶åŽæ¸²æŸ“signupæ¨¡æ¿ï¼Œè¿™é‡Œæˆ‘ä»¬è¿˜æ²¡æœ‰åœ¨å†™signup.ejs views/signup.ejs 1234567891011121314151617181920212223242526272829303132&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;æ³¨å†Œ&lt;/title&gt;&lt;/head&gt;&lt;body&gt; &lt;div class="container"&gt; &lt;form class="form create" method="post"&gt; &lt;div&gt; &lt;label&gt;ç”¨æˆ·åï¼š&lt;/label&gt; &lt;input placeholder="è¯·è¾“å…¥ç”¨æˆ·å" type="text" name="name"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="è¯·è¾“å…¥å¯†ç " class="password" type="password" name="password"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;é‡å¤å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="è¯·ç¡®è®¤å¯†ç " class="repeatpass" type="password" name="repeatpass"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;ä¸Šä¼ å¤´åƒï¼š&lt;/label&gt; &lt;input type="file" name="avator" id="avator"&gt; &lt;input type="hidden" id="avatorVal"&gt; &lt;img class="preview" alt="é¢„è§ˆå¤´åƒ"&gt; &lt;/div&gt; &lt;div class="submit"&gt;æ³¨å†Œ&lt;/div&gt; &lt;/form&gt; &lt;/div&gt;&lt;/body&gt;&lt;/html&gt; æˆ‘ä»¬å…ˆå®‰è£…supervisor 1$ cnpm i supervisor -g supervisorçš„ä½œç”¨æ˜¯ä¼šç›‘å¬æ–‡ä»¶çš„å˜åŒ–ï¼Œè€Œæˆ‘ä»¬ä¿®æ”¹æ–‡ä»¶ä¹‹åŽä¸å¿…åŽ»é‡å¯ç¨‹åº1supervisor --harmony index çŽ°åœ¨è®¿é—® localhost:3000/signup çœ‹çœ‹æ•ˆæžœå§ã€‚æ³¨æ„æ•°æ®åº“ä¸€å®šè¦æ˜¯å¼€å¯çš„çŠ¶æ€ï¼Œä¸èƒ½å…³é—­ å®Œå–„æ³¨å†ŒåŠŸèƒ½é¦–å…ˆæˆ‘ä»¬æ¥å®Œå–„ä¸€ä¸‹æ ·å¼å§ï¼Œç¨å¾®ç¾ŽåŒ–ä¸€ä¸‹ public/index.css 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186187188189190191192193194195196197198199200201202203204205206207208209210211212213214215216217218219220221222223224225226227228229230231232233234235236237238239240241242243244245246247248249250251252253254255256257258259260261262263264265266267268269270271272273274275276277278279280281282283284285286287288289290291292293294295296297298299300301302303304305306307308309310311312313314315316317318319320321322323324325326327328329330331332333334335336337338339340341342343344345346347348349350351352353354355356357358359360body,header,ul,li,p,div,html,span,h3,a,blockquote &#123; margin: 0; padding: 0; color: #333;&#125;body &#123; margin-bottom: 20px;&#125;ul,li&#123; list-style-type: none;&#125;a &#123; text-decoration: none;&#125;header &#123; width: 60%; margin: 20px auto;&#125;header:after&#123; content: ''; clear: both; display: table;&#125;header .user_right&#123; float: right&#125;header .user_right .active&#123; color: #5FB878; background: #fff; border: 1px solid #5FB878; box-shadow: 0 5px 5px #ccc;&#125;header .user_name &#123; float: left&#125;.user_name &#123; font-size: 20px;&#125;.has_user a,.has_user span,.none_user a &#123; padding: 5px 15px; background: #5FB878; border-radius: 15px; color: #fff; cursor: pointer; border: 1px solid #fff; transition: all 0.3s;&#125;.has_user a:hover,.has_user span:hover&#123; color: #5FB878; background: #fff; border: 1px solid #5FB878; box-shadow: 0 5px 5px #ccc;&#125;.posts&#123; border-radius: 4px; border: 1px solid #ddd;&#125;.posts &gt; li&#123; padding: 10px; position: relative; padding-bottom: 40px;&#125;.posts .comment_pv&#123; position: absolute; bottom: 5px; right: 10px;&#125;.posts .author&#123; position: absolute; left: 10px; bottom: 5px;&#125;.posts .author span&#123; margin-right: 5px;&#125;.posts &gt; li:hover &#123; background: #f2f2f2;&#125;.posts &gt; li:hover pre&#123; border: 1px solid #666;&#125;.posts &gt; li:hover .content&#123; border-top: 1px solid #fff; border-bottom: 1px solid #fff;&#125;.posts &gt; li + li&#123; border-top: 1px solid #ddd;&#125;.posts li .title span&#123; position: absolute; left: 10px; top: 10px; color: #5FB878; font-size: 14px;&#125;.posts li .title&#123; margin-left: 40px; font-size: 20px; color: #222;&#125;.posts .userAvator&#123; position: absolute; left: 3px; top: 3px; width: 40px; height: 40px; border-radius: 5px;&#125;.posts .content&#123; border-top: 1px solid #f2f2f2; border-bottom: 1px solid #f2f2f2; margin: 10px 0 0 0 ; padding: 10px 0; margin-left: 40px;&#125;.userMsg img&#123; width: 40px; height: 40px; border-radius: 5px; margin-right: 10px; vertical-align: middle; display: inline-block;&#125;.userMsg span&#123; font-size: 18px; color:#333; position: relative; top: 2px;&#125;.posts li img&#123; max-width: 100%;&#125;.spost .comment_pv&#123; position: absolute; top: 10px;&#125;.spost .edit &#123; position: absolute; right: 20px; bottom: 5px;&#125;.spost .edit p &#123; display: inline-block; margin-left: 10px;&#125;.comment_wrap &#123; width: 60%; margin: 20px auto;&#125;.submit &#123; display: block; width: 100px; height: 40px; line-height: 40px; text-align: center; border-radius: 4px; background: #5FB878; cursor: pointer; color: #fff; float: left; margin-top: 20px ; border:1px solid #fff;&#125;.submit:hover&#123; background: #fff; color: #5FB878; border:1px solid #5FB878;&#125;.comment_list&#123; border: 1px solid #ddd; border-radius: 4px;&#125;.cmt_lists:hover&#123; background: #f2f2f2;&#125;.cmt_lists + .cmt_lists&#123; border-top: 1px solid #ddd;&#125;.cmt_content &#123; padding: 10px; position: relative; border-radius: 4px; word-break: break-all;&#125;.cmt_detail&#123; margin-left: 48px;&#125;.cmt_content img&#123; max-width: 100%;&#125;/* .cmt_content:after &#123; content: '#content'; position: absolute; top: 5px; right: 5px; color: #aaa; font-size: 13px;&#125; */.cmt_name &#123; position: absolute; right: 8px; bottom: 5px; color: #333;&#125;.cmt_name a &#123; margin-left: 5px; color: #1E9FFF;&#125;.cmt_time&#123; position: absolute; font-size: 12px; right: 5px; top: 5px; color: #aaa&#125;.form &#123; margin: 0 auto; width: 50%; margin-top: 20px;&#125;textarea &#123; width: 100%; height: 150px; padding:10px 0 0 10px; font-size: 20px; border-radius: 4px; border: 1px solid #d7dde4; -webkit-appearance: none; resize: none;&#125;textarea#spContent&#123; width: 98%;&#125;.tips &#123; margin: 20px 0; color: #ec5051; text-align: center;&#125;.container &#123; width: 60%; margin: 0 auto;&#125;.form img.preview &#123; width:100px; height:100px; border-radius: 50%; display: none; margin-top:10px;&#125;input &#123; display: block; width: 100%; height: 35px; font-size: 18px; padding: 6px 7px; border-radius: 4px; border: 1px solid #d7dde4; -webkit-appearance: none;&#125;input:focus,textarea:focus&#123; outline: 0; box-shadow: 0 0 0 2px rgba(51,153,255,.2); border-color: #5cadff;&#125;input:hover,input:active,textarea:hover,textarea:active&#123; border-color: #5cadff;&#125;.create label &#123; display: block; margin: 10px 0;&#125;.comment_wrap form &#123; width: 100%; margin-bottom: 85px;&#125;.delete_comment,.delete_post &#123; cursor: pointer;&#125;.delete_comment:hover,.delete_post:hover,a:hover &#123; color: #ec5051;&#125;.disabled&#123; user-select: none; cursor: not-allowed !important;&#125;.error&#123; color: #ec5051;&#125;.success&#123; color: #1E9FFF;&#125;.container&#123; width: 60%; margin:0 auto;&#125;.message&#123; position: fixed; top: -100%; left: 50%; transform: translateX(-50%); padding: 10px 20px; background: rgba(0, 0, 0, 0.7); color: #fff; border-bottom-left-radius: 15px; border-bottom-right-radius: 15px; z-index: 99999;&#125;.markdown pre&#123; display: block; overflow-x: auto; padding: 0.5em; background: #F0F0F0; border-radius: 3px; border: 1px solid #fff;&#125;.markdown blockquote&#123; padding: 0 1em; color: #6a737d; border-left: 0.25em solid #dfe2e5; margin: 10px 0;&#125;.markdown ul li&#123; list-style: circle; margin-top: 5px;&#125; æˆ‘ä»¬å†æŠŠæ¨¡æ¿å¼•æ“Žçš„headerå’Œfooterç‹¬ç«‹å‡ºæ¥ /views/header.ejsé¡ºä¾¿å¼•å…¥index.csså’Œjq123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899&lt;!DOCTYPE html&gt;&lt;html lang="en"&gt;&lt;head&gt; &lt;meta charset="UTF-8"&gt; &lt;title&gt;koa2-blog&lt;/title&gt; &lt;link rel="icon" href="http://www.wclimb.site/images/avatar.png"&gt; &lt;link rel="stylesheet" href="/index.css"&gt; &lt;script src="http://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"&gt;&lt;/script&gt; &lt;script&gt; function fade(txt)&#123; $('.message').text(txt) $('.message').animate(&#123; top:0 &#125;) setTimeout(function()&#123; $('.message').animate(&#123; top: '-100%' &#125;) &#125;,1500) &#125; $(function()&#123; $('.signout').click(()=&gt;&#123; $.ajax(&#123; url: "/signout", type: "GET", cache: false, dataType: 'json', success: function (msg) &#123; if (msg) &#123; fade('ç™»å‡ºæˆåŠŸ') setTimeout(()=&gt;&#123; window.location.href = "/posts" &#125;,1500) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125;) &#125;) &lt;/script&gt;&lt;/head&gt;&lt;body&gt; &lt;header&gt; &lt;div class="user_name"&gt; &lt;% if(session.user)&#123; %&gt; Hello,&lt;%= session.user %&gt; &lt;% &#125; %&gt; &lt;% if(!session.user)&#123; %&gt; æ¬¢è¿Žæ³¨å†Œç™»å½•^_^ &lt;% &#125; %&gt; &lt;/div&gt; &lt;div class="message"&gt;ç™»å½•æˆåŠŸ&lt;/div&gt; &lt;div class="user_right"&gt; &lt;% if(session.user)&#123; %&gt; &lt;div class="has_user"&gt; &lt;a target="__blank" href="https://github.com/wclimb/Koa2-blog"&gt;GitHub&lt;/a&gt; &lt;% if(type == 'all')&#123; %&gt; &lt;a class="active" href="/posts"&gt;å…¨éƒ¨æ–‡ç« &lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/posts"&gt;å…¨éƒ¨æ–‡ç« &lt;/a&gt; &lt;% &#125;%&gt; &lt;% if(type == 'my')&#123; %&gt; &lt;a class="active" href="/posts?author=&lt;%= session.user %&gt;"&gt;æˆ‘çš„æ–‡ç« &lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/posts?author=&lt;%= session.user %&gt;"&gt;æˆ‘çš„æ–‡ç« &lt;/a&gt; &lt;% &#125;%&gt; &lt;% if(type == 'create')&#123; %&gt; &lt;a class="active" href="/create"&gt;å‘è¡¨æ–‡ç« &lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/create"&gt;å‘è¡¨æ–‡ç« &lt;/a&gt; &lt;% &#125;%&gt; &lt;span class="signout"&gt;ç™»å‡º&lt;/span&gt; &lt;/div&gt; &lt;% &#125; %&gt; &lt;% if(!session.user)&#123; %&gt; &lt;div class="none_user has_user"&gt; &lt;a target="__blank" href="https://github.com/wclimb/Koa2-blog"&gt;GitHub&lt;/a&gt; &lt;% if(type == 'all')&#123; %&gt; &lt;a class="active" href="/posts"&gt;å…¨éƒ¨æ–‡ç« &lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/posts"&gt;å…¨éƒ¨æ–‡ç« &lt;/a&gt; &lt;% &#125;%&gt; &lt;% if(type == 'signup')&#123; %&gt; &lt;a class="active" href="/signup"&gt;æ³¨å†Œ&lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/signup"&gt;æ³¨å†Œ&lt;/a&gt; &lt;% &#125;%&gt; &lt;% if(type == 'signin')&#123; %&gt; &lt;a class="active" href="/signin"&gt;ç™»å½•&lt;/a&gt; &lt;% &#125;else&#123; %&gt; &lt;a href="/signin"&gt;ç™»å½•&lt;/a&gt; &lt;% &#125;%&gt; &lt;/div&gt; &lt;% &#125; %&gt; &lt;/div&gt; &lt;/header&gt; é¦–å…ˆæˆ‘ä»¬çœ‹åˆ°ç”¨åˆ°äº†session.userï¼Œè¿™ä¸ªå€¼ä»Žå“ªæ¥å‘¢ï¼Ÿè¯·çœ‹ä¸‹é¢çš„ä»£ç 1234567// æ³¨å†Œé¡µé¢router.get('/signup', async(ctx, next) =&gt; &#123; await checkNotLogin(ctx) await ctx.render('signup', &#123; session: ctx.session, &#125;)&#125;) æˆ‘ä»¬å¯ä»¥çœ‹åˆ°æˆ‘ä»¬å‘æ¨¡æ¿ä¼ äº†ä¸€ä¸ªsessionå€¼ï¼Œsession:ctx.sessionï¼Œè¿™ä¸ªå€¼å­˜å–çš„å°±æ˜¯ç”¨æˆ·çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç”¨æˆ·åã€ç™»å½•ä¹‹åŽçš„idç­‰ï¼Œsessionä¸€èˆ¬æ˜¯ä½ å…³é—­æµè§ˆå™¨å°±è¿‡æœŸäº†ï¼Œç­‰äºŽä¸‹æ¬¡æ‰“å¼€æµè§ˆå™¨çš„æ—¶å€™å°±å¾—é‡æ–°ç™»å½•äº†ï¼Œç”¨ifåˆ¤æ–­ä»–å­˜ä¸å­˜åœ¨ï¼Œå°±å¯ä»¥çŸ¥é“ç”¨æˆ·æ˜¯å¦éœ€è¦ç™»å½•ï¼Œå¦‚æžœä¸å­˜åœ¨ç”¨æˆ·ï¼Œåˆ™åªæ˜¾ç¤ºå…¨éƒ¨æ–‡ç«  æ³¨å†Œ ç™»å½• ,å¦‚æžœsession.userå­˜åœ¨åˆ™æœ‰ç™»å‡ºçš„æŒ‰é’®ã€‚ åœ¨ä¸Šé¢æˆ‘ä»¬ä¼šçœ‹åˆ°æˆ‘ç”¨äº†å¦å¤–ä¸€ä¸ªifåˆ¤æ–­ï¼Œåˆ¤æ–­typeç±»åž‹ï¼Œè¿™æ ·åšçš„ç›®çš„æ˜¯æ¯”å¦‚æˆ‘ä»¬ç™»å½•æ³¨å†Œé¡µé¢ï¼Œæ³¨å†Œé¡µé¢çš„å¯¼èˆªä¼šé«˜äº®ï¼Œå…¶å®žå°±æ˜¯æ·»åŠ äº†classï¼šactive;ä¹‹åŽæˆ‘ä»¬æ¯ä¸ªejsæ–‡ä»¶çš„å¤´éƒ¨ä¼šè¿™æ ·å†™&lt;%- include(&quot;header&quot;,{type:&#39;signup&#39;}) %&gt; ç™»å½•é¡µé¢åˆ™æ˜¯&lt;%- include(&quot;header&quot;,{type:&#39;signin&#39;}) %&gt; /views/footer.ejs123 &lt;/body&gt;&lt;/html&gt; ä¿®æ”¹views/signup.ejs12345678910111213141516171819202122232425262728293031323334353637383940414243444546474849505152535455565758596061626364656667686970717273747576777879808182838485868788899091929394959697&lt;%- include("header",&#123;type:'signup'&#125;) %&gt; &lt;div class="container"&gt; &lt;form class="form create" method="post"&gt; &lt;div&gt; &lt;label&gt;ç”¨æˆ·åï¼š&lt;/label&gt; &lt;input placeholder="è¯·è¾“å…¥ç”¨æˆ·å" type="text" name="name"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="è¯·è¾“å…¥å¯†ç " class="password" type="password" name="password"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;é‡å¤å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="è¯·ç¡®è®¤å¯†ç " class="repeatpass" type="password" name="repeatpass"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;ä¸Šä¼ å¤´åƒï¼š&lt;/label&gt; &lt;input type="file" name="avator" id="avator"&gt; &lt;input type="hidden" id="avatorVal"&gt; &lt;img class="preview" alt="é¢„è§ˆå¤´åƒ"&gt; &lt;/div&gt; &lt;div class="submit"&gt;æ³¨å†Œ&lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;script&gt; $(window).keyup(function (e) &#123; //console.log(e.keyCode) if (e.keyCode == 13) &#123; $('.submit').click() &#125; &#125;) $('#avator').change(function()&#123; if (this.files.length != 0) &#123; var file = this.files[0], reader = new FileReader(); if (!reader) &#123; this.value = ''; return; &#125;; console.log(file.size) if (file.size &gt;= 1024 * 1024 / 2) &#123; fade("è¯·ä¸Šä¼ å°äºŽ512kbçš„å›¾ç‰‡!") return &#125; reader.onload = function (e) &#123; this.value = ''; $('form .preview').attr('src', e.target.result) $('form .preview').fadeIn() $('#avatorVal').val(e.target.result) &#125;; reader.readAsDataURL(file); &#125;; &#125;) $('.submit').click(()=&gt;&#123; // console.log($('.form').serialize()) if ($('input[name=name]').val().trim() == '') &#123; fade('è¯·è¾“å…¥ç”¨æˆ·åï¼') &#125;else if($('input[name=name]').val().match(/[&lt;'"&gt;]/g))&#123; fade('è¯·è¾“å…¥åˆæ³•å­—ç¬¦ï¼') &#125;else if($('#avatorVal').val() == '')&#123; fade('è¯·ä¸Šä¼ å¤´åƒï¼') &#125;else&#123; $.ajax(&#123; url: "/signup", data: &#123; name: $('input[name=name]').val(), password: $('input[name=password]').val(), repeatpass: $('input[name=repeatpass]').val(), avator: $('#avatorVal').val(), &#125;, type: "POST", cache: false, dataType: 'json', success: function (msg) &#123; if (msg.data == 1) &#123; $('input').val('') fade('ç”¨æˆ·åå­˜åœ¨') &#125; else if (msg.data == 2)&#123; fade('è¯·è¾“å…¥é‡å¤çš„å¯†ç ') &#125; else if(msg.data == 3)&#123; fade('æ³¨å†ŒæˆåŠŸ') setTimeout(()=&gt;&#123; window.location.href="/signin" &#125;,1000) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125; &#125;) &lt;/script&gt;&lt;% include footer %&gt; å…ˆçœ‹æˆ‘ä»¬è¯·æ±‚çš„urlåœ°å€ï¼Œæ˜¯â€™/signupâ€™ï¼Œä¸ºä»€ä¹ˆæ˜¯è¿™ä¸ªå‘¢ï¼Ÿæˆ‘ä»¬çœ‹ä¸‹é¢è¿™æ®µä»£ç (åŽé¢æœ‰å®Œæ•´çš„)12345678910router.post('/signup', async(ctx, next) =&gt; &#123; //console.log(ctx.request.body) let user = &#123; name: ctx.request.body.name, pass: ctx.request.body.password, repeatpass: ctx.request.body.repeatpass, avator: ctx.request.body.avator &#125; ....&#125; æˆ‘ä»¬çš„è¯·æ±‚æ–¹å¼æ˜¯postï¼Œåœ°å€æ˜¯/signupæ‰€ä»¥èµ°äº†è¿™æ®µä»£ç ï¼Œä¹‹åŽä¼šèŽ·å–æˆ‘ä»¬è¾“å…¥çš„ä¿¡æ¯ï¼Œé€šè¿‡ctx.request.bodyæ‹¿åˆ° è¿™é‡Œé‡ç‚¹å°±åœ¨äºŽajaxæäº¤äº†ï¼Œæäº¤ä¹‹åŽæ¢å›žæ•°æ® 1 2 3ï¼Œç„¶åŽåˆ†åˆ«åšæ­£ç¡®é”™è¯¯å¤„ç†ï¼ŒæŠŠä¿¡æ¯å†™åœ¨errorå’Œsuccessä¸­ ä¿®æ”¹routers/signup.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263const router = require('koa-router')();const userModel = require('../lib/mysql.js');const md5 = require('md5')const checkNotLogin = require('../middlewares/check.js').checkNotLoginconst checkLogin = require('../middlewares/check.js').checkLoginconst moment = require('moment');const fs = require('fs')// æ³¨å†Œé¡µé¢router.get('/signup', async(ctx, next) =&gt; &#123; await checkNotLogin(ctx) await ctx.render('signup', &#123; session: ctx.session, &#125;)&#125;)// post æ³¨å†Œrouter.post('/signup', async(ctx, next) =&gt; &#123; //console.log(ctx.request.body) let user = &#123; name: ctx.request.body.name, pass: ctx.request.body.password, repeatpass: ctx.request.body.repeatpass, avator: ctx.request.body.avator &#125; await userModel.findDataByName(user.name) .then(async (result) =&gt; &#123; console.log(result) if (result.length) &#123; try &#123; throw Error('ç”¨æˆ·å·²ç»å­˜åœ¨') &#125; catch (error) &#123; //å¤„ç†err console.log(error) &#125; // ç”¨æˆ·å­˜åœ¨ ctx.body = &#123; data: 1 &#125;;; &#125; else if (user.pass !== user.repeatpass || user.pass === '') &#123; ctx.body = &#123; data: 2 &#125;; &#125; else &#123; // ctx.session.user=ctx.request.body.name let base64Data = user.avator.replace(/^data:image\/\w+;base64,/, ""); let dataBuffer = new Buffer(base64Data, 'base64'); let getName = Number(Math.random().toString().substr(3)).toString(36) + Date.now() await fs.writeFile('./public/images/' + getName + '.png', dataBuffer, err =&gt; &#123; if (err) throw err; console.log('å¤´åƒä¸Šä¼ æˆåŠŸ') &#125;); await userModel.insertData([user.name, md5(user.pass), getName, moment().format('YYYY-MM-DD HH:mm:ss')]) .then(res=&gt;&#123; console.log('æ³¨å†ŒæˆåŠŸ',res) //æ³¨å†ŒæˆåŠŸ ctx.body = &#123; data: 3 &#125;; &#125;) &#125; &#125;)&#125;)module.exports = router æˆ‘ä»¬ä½¿ç”¨md5å®žçŽ°å¯†ç åŠ å¯†ï¼Œé•¿åº¦æ˜¯32ä½çš„ ä½¿ç”¨æˆ‘ä»¬ä¹‹å‰è¯´çš„bodyParseæ¥è§£æžæäº¤çš„æ•°æ®ï¼Œé€šè¿‡ctx.request.bodyå¾—åˆ° æˆ‘ä»¬å¼•å…¥äº†æ•°æ®åº“çš„æ“ä½œ findDataByNameå’ŒinsertDataï¼Œå› ä¸ºä¹‹å‰æˆ‘ä»¬åœ¨/lib/mysql.jsä¸­å·²ç»æŠŠä»–ä»¬å†™å¥½ï¼Œå¹¶æš´éœ²å‡ºæ¥äº†ã€‚æ„æ€æ˜¯å…ˆä»Žæ•°æ®åº“é‡Œé¢æŸ¥æ‰¾æ³¨å†Œçš„ç”¨æˆ·åï¼Œå¦‚æžœæ‰¾åˆ°äº†è¯æ˜Žè¯¥ç”¨æˆ·åå·²ç»è¢«æ³¨å†Œè¿‡äº†ï¼Œå¦‚æžœæ²¡æœ‰æ‰¾åˆ°åˆ™ä½¿ç”¨insertDataå¢žåŠ åˆ°æ•°æ®åº“ä¸­ ctx.body æ˜¯æˆ‘ä»¬é€šè¿‡ajaxæäº¤ä¹‹åŽç»™é¡µé¢è¿”å›žçš„æ•°æ®ï¼Œæ¯”å¦‚æäº¤ajaxæˆåŠŸä¹‹åŽmsg.data=1çš„æ—¶å€™å°±ä»£è¡¨ç”¨æˆ·å­˜åœ¨ï¼Œmsg.dataå‡ºçŽ°åœ¨åŽé¢çš„signup.ejsæ¨¡æ¿ajaxè¯·æ±‚ä¸­ ä¸Šä¼ å¤´åƒä¹‹å‰è¦æ–°å»ºå¥½æ–‡ä»¶å¤¹ï¼Œæˆ‘ä»¬ajaxå‘é€çš„æ˜¯base64çš„æ ¼å¼ï¼Œç„¶åŽä½¿ç”¨fs.writeFileæ¥ç”Ÿæˆå›¾ç‰‡ æˆ‘ä»¬ä½¿ç”¨ajaxæ¥æäº¤æ•°æ®ï¼Œæ–¹ä¾¿æ¥åšæˆåŠŸé”™è¯¯çš„å¤„ç† æ¨¡æ¿å¼•æ“Žejsæˆ‘ä»¬ä½¿ç”¨çš„æ˜¯ejsï¼Œè¯­æ³•å¯ä»¥è§ejs ä¹‹å‰æˆ‘ä»¬å†™äº†è¿™ä¹ˆä¸€æ®µä»£ç 12345router.get('/signup',async (ctx,next)=&gt;&#123; await ctx.render('signup',&#123; session:ctx.session, &#125;)&#125;) è¿™é‡Œå°±ç”¨åˆ°äº†ejsæ‰€éœ€çš„session æˆ‘ä»¬é€šè¿‡æ¸²æŸ“signup.ejsæ¨¡æ¿ï¼Œå°†å€¼ctx.sessionèµ‹å€¼ç»™sessionï¼Œä¹‹åŽæˆ‘ä»¬å°±å¯ä»¥åœ¨signup.ejsä¸­ä½¿ç”¨äº†ejsçš„å¸¸ç”¨æ ‡ç­¾ä¸ºï¼š &lt;% code %&gt;ï¼šè¿è¡Œ JavaScript ä»£ç ï¼Œä¸è¾“å‡º &lt;%= code %&gt;ï¼šæ˜¾ç¤ºè½¬ä¹‰åŽçš„ HTMLå†…å®¹ &lt;%- code %&gt;ï¼šæ˜¾ç¤ºåŽŸå§‹ HTML å†…å®¹ &lt;%= code %&gt;å’Œ&lt;%- code %&gt;çš„åŒºåˆ«åœ¨äºŽï¼Œ&lt;%= code %&gt;ä¸ç®¡ä½ å†™ä»€ä¹ˆéƒ½ä¼šåŽŸæ ·è¾“å‡ºï¼Œæ¯”å¦‚codeä¸º &lt;strong&gt;hello&lt;/strong&gt;çš„æ—¶å€™ &lt;%= code %&gt; ä¼šæ˜¾ç¤º&lt;strong&gt;hello&lt;/strong&gt;è€Œ&lt;%- code %&gt;åˆ™æ˜¾ç¤ºåŠ ç²—çš„hello å®žçŽ°ç™»å½•é¡µé¢ ä¿®æ”¹ /routers/signin.js12345678910111213const router = require('koa-router')();const userModel = require('../lib/mysql.js')const md5 = require('md5')const checkNotLogin = require('../middlewares/check.js').checkNotLoginconst checkLogin = require('../middlewares/check.js').checkLoginrouter.get('/signin', async(ctx, next) =&gt; &#123; await checkNotLogin(ctx) await ctx.render('signin', &#123; session: ctx.session, &#125;)&#125;)module.exports=router ä¿®æ”¹ /views/signin.ejs 123456789101112131415&lt;%- include("header",&#123;type:'signin'&#125;) %&gt; &lt;div class="container"&gt; &lt;form class="form create" method="post "&gt; &lt;div&gt; &lt;label&gt;ç”¨æˆ·åï¼š&lt;/label&gt; &lt;input placeholder="ç”¨æˆ·å" type="text" name="name"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="å¯†ç " type="password" name="password"&gt; &lt;/div&gt; &lt;div class="submit"&gt;ç™»å½•&lt;/div&gt; &lt;/form&gt; &lt;/div&gt;&lt;% include footer %&gt; ä¿®æ”¹ index.js æ–‡ä»¶ æŠŠä¸‹é¢è¿™æ®µä»£ç æ³¨é‡ŠåŽ»æŽ‰ï¼Œä¹‹å‰æ³¨é‡Šæ˜¯å› ä¸ºæˆ‘ä»¬æ²¡æœ‰å†™signinçš„è·¯ç”±ï¼Œä»¥å…æŠ¥é”™ï¼ŒåŽé¢è¿˜æœ‰æ–‡ç« é¡µå’Œç™»å‡ºé¡µçš„è·¯ç”±ï¼Œå¤§å®¶è®°ä½ä¸€ä¸‹ 1app.use(require('./routers/signin.js').routes()) çŽ°åœ¨æ³¨å†Œä¸€ä¸‹æ¥çœ‹çœ‹æ•ˆæžœå§1$ supervisor --harmony index æˆ‘ä»¬æ€Žä¹ˆæŸ¥çœ‹æˆ‘ä»¬æ³¨å†Œå¥½çš„è´¦å·å’Œå¯†ç å‘¢ï¼Ÿæ‰“å¼€mysqlæŽ§åˆ¶å° 1$ select * from users; è¿™æ ·åˆšåˆšæˆ‘ä»¬æ³¨å†Œçš„ç”¨æˆ·ä¿¡æ¯éƒ½å‡ºçŽ°äº† å¦‚æžœä½ è§‰å¾—è¿™ç¯‡æ–‡ç« å¸®åŠ©åˆ°äº†ä½ ï¼Œé‚£å°±èµè„¸ç»™ä¸ªstarå§ï¼Œhttps://github.com/wclimb/Koa2-blog ç™»å½•é¡µé¢ä¿®æ”¹signinrouters/signin.js123456789101112131415161718192021222324252627282930313233343536373839const router = require('koa-router')();const userModel = require('../lib/mysql.js')const md5 = require('md5')const checkNotLogin = require('../middlewares/check.js').checkNotLoginconst checkLogin = require('../middlewares/check.js').checkLoginrouter.get('/signin', async(ctx, next) =&gt; &#123; await checkNotLogin(ctx) await ctx.render('signin', &#123; session: ctx.session, &#125;)&#125;)router.post('/signin', async(ctx, next) =&gt; &#123; console.log(ctx.request.body) let name = ctx.request.body.name; let pass = ctx.request.body.password; await userModel.findDataByName(name) .then(result =&gt; &#123; let res = result if (name === res[0]['name'] &amp;&amp; md5(pass) === res[0]['pass']) &#123; ctx.body = true ctx.session.user = res[0]['name'] ctx.session.id = res[0]['id'] console.log('ctx.session.id', ctx.session.id) console.log('session', ctx.session) console.log('ç™»å½•æˆåŠŸ') &#125;else&#123; ctx.body = false console.log('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯!') &#125; &#125;).catch(err =&gt; &#123; console.log(err) &#125;)&#125;)module.exports = router æˆ‘ä»¬è¿›è¡Œç™»å½•æ“ä½œï¼Œåˆ¤æ–­ç™»å½•çš„ç”¨æˆ·åå’Œå¯†ç æ˜¯å¦æœ‰è¯¯ï¼Œä½¿ç”¨md5åŠ å¯†æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç™»å½•æˆåŠŸè¿”å›žçš„ç»“æžœæ˜¯result ç»“æžœæ˜¯è¿™æ ·çš„ä¸€ä¸ªjsonæ•°ç»„ï¼šidï¼š4 nameï¼šrrr passï¼šâ€¦[ RowDataPacket { id: 4, name: â€˜rrrâ€™, pass: â€˜44f437ced647ec3f40fa0841041871cdâ€™ } ] ä¿®æ”¹views/signin.ejssignin.ejs123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051&lt;%- include("header",&#123;type:'signin'&#125;) %&gt; &lt;div class="container"&gt; &lt;form class="form create" method="post "&gt; &lt;div&gt; &lt;label&gt;ç”¨æˆ·åï¼š&lt;/label&gt; &lt;input placeholder="ç”¨æˆ·å" type="text" name="name"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å¯†ç ï¼š&lt;/label&gt; &lt;input placeholder="å¯†ç " type="password" name="password"&gt; &lt;/div&gt; &lt;div class="submit"&gt;ç™»å½•&lt;/div&gt; &lt;/form&gt; &lt;/div&gt; &lt;script&gt; $(window).keyup(function(e)&#123; //console.log(e.keyCode) if (e.keyCode == 13) &#123; $('.submit').click() &#125; &#125;) $('.submit').click(()=&gt;&#123; if ($('input[name=name]').val().trim() == '' || $('input[name=password]').val().trim() == '' ) &#123; fade('è¯·è¾“å…¥ç”¨æˆ·åæˆ–å¯†ç ') &#125;else&#123; console.log($('.form').serialize()) $.ajax(&#123; url: "/signin", data: $('.form').serialize(), type: "POST", cache: false, dataType: 'json', success: function (msg) &#123; if (!msg) &#123; $('input').val('') fade('ç”¨æˆ·åæˆ–å¯†ç é”™è¯¯') &#125; else&#123; fade('ç™»å½•æˆåŠŸ') setTimeout(()=&gt;&#123; window.location.href = "/posts" &#125;,1500) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125; &#125;) &lt;/script&gt;&lt;% include footer %&gt; æˆ‘ä»¬å¢žåŠ äº†ajaxè¯·æ±‚ï¼Œåœ¨routers/signin.jsé‡Œï¼Œæˆ‘ä»¬è®¾ç½®å¦‚æžœç™»å½•å¤±è´¥å°±è¿”å›žfalseï¼Œç™»å½•æˆåŠŸè¿”å›žtrue 12ctx.body = falsectx.body = true é‚£æˆ‘ä»¬ç™»å½•æˆåŠŸåŽè¦åšè·³è½¬ï¼Œå¯ä»¥çœ‹åˆ°window.location.href=&quot;/posts&quot;è·³è½¬åˆ°postsé¡µé¢ å…¨éƒ¨æ–‡ç« ä¿®æ”¹routers/posts.js posts.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172const router = require('koa-router')();const userModel = require('../lib/mysql.js')const moment = require('moment')const checkNotLogin = require('../middlewares/check.js').checkNotLoginconst checkLogin = require('../middlewares/check.js').checkLogin;const md = require('markdown-it')(); // é‡ç½®åˆ°æ–‡ç« é¡µrouter.get('/', async(ctx, next) =&gt; &#123; ctx.redirect('/posts')&#125;)// æ–‡ç« é¡µrouter.get('/posts', async(ctx, next) =&gt; &#123; let res, postsLength, name = decodeURIComponent(ctx.request.querystring.split('=')[1]); if (ctx.request.querystring) &#123; console.log('ctx.request.querystring', name) await userModel.findDataByUser(name) .then(result =&gt; &#123; postsLength = result.length &#125;) await userModel.findPostByUserPage(name,1) .then(result =&gt; &#123; res = result &#125;) await ctx.render('selfPosts', &#123; session: ctx.session, posts: res, postsPageLength:Math.ceil(postsLength / 10), &#125;) &#125; else &#123; await userModel.findPostByPage(1) .then(result =&gt; &#123; //console.log(result) res = result &#125;) await userModel.findAllPost() .then(result=&gt;&#123; postsLength = result.length &#125;) await ctx.render('posts', &#123; session: ctx.session, posts: res, postsLength: postsLength, postsPageLength: Math.ceil(postsLength / 10), &#125;) &#125;&#125;)// é¦–é¡µåˆ†é¡µï¼Œæ¯æ¬¡è¾“å‡º10æ¡router.post('/posts/page', async(ctx, next) =&gt; &#123; let page = ctx.request.body.page; await userModel.findPostByPage(page) .then(result=&gt;&#123; //console.log(result) ctx.body = result &#125;).catch(()=&gt;&#123; ctx.body = 'error' &#125;) &#125;)// ä¸ªäººæ–‡ç« åˆ†é¡µï¼Œæ¯æ¬¡è¾“å‡º10æ¡router.post('/posts/self/page', async(ctx, next) =&gt; &#123; let data = ctx.request.body await userModel.findPostByUserPage(data.name,data.page) .then(result=&gt;&#123; //console.log(result) ctx.body = result &#125;).catch(()=&gt;&#123; ctx.body = 'error' &#125;) &#125;)module.exports = router ä¿®æ”¹ index.js app.use(require(â€˜./routers/posts.jsâ€™).routes())çš„æ³¨é‡ŠåŽ»æŽ‰ ä¿®æ”¹ views/posts.ejs 12345&lt;%- include(&quot;header&quot;,&#123;type:&apos;posts&apos;&#125;) %&gt; posts&lt;% include footer %&gt; çŽ°åœ¨çœ‹çœ‹ç™»å½•æˆåŠŸä¹‹åŽçš„é¡µé¢å§ æŽ¥ä¸‹æ¥æˆ‘ä»¬å®žçŽ°ç™»å‡ºé¡µé¢ ç™»å‡ºé¡µé¢ä¿®æ”¹ router/signout.js signout.js123456789const router = require('koa-router')();router.get('/signout', async(ctx, next) =&gt; &#123; ctx.session = null; console.log('ç™»å‡ºæˆåŠŸ') ctx.body = true&#125;)module.exports = router æŠŠsessionè®¾ç½®ä¸ºnullå³å¯ ä¿®æ”¹ index.js app.use(require(â€˜./routers/posts.jsâ€™).routes())çš„æ³¨é‡ŠåŽ»æŽ‰ï¼ŒçŽ°åœ¨æŠŠæ³¨é‡Šçš„è·¯ç”±å…¨éƒ¨å–æ¶ˆæ³¨é‡Šå°±å¯¹äº† ç„¶åŽæˆ‘ä»¬çœ‹çœ‹ views/header.ejs æˆ‘ä»¬ç‚¹å‡»ç™»å‡ºåŽçš„ajax çš„æäº¤ï¼ŒæˆåŠŸä¹‹åŽå›žåˆ°postsé¡µé¢ å‘è¡¨æ–‡ç« ä¿®æ”¹router/postsåœ¨åŽé¢å¢žåŠ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647// å‘è¡¨æ–‡ç« é¡µé¢router.get('/create', async(ctx, next) =&gt; &#123; await ctx.render('create', &#123; session: ctx.session, &#125;)&#125;)// post å‘è¡¨æ–‡ç« router.post('/create', async(ctx, next) =&gt; &#123; let title = ctx.request.body.title, content = ctx.request.body.content, id = ctx.session.id, name = ctx.session.user, time = moment().format('YYYY-MM-DD HH:mm:ss'), avator, // çŽ°åœ¨ä½¿ç”¨markdownä¸éœ€è¦å•ç‹¬è½¬ä¹‰ newContent = content.replace(/[&lt;"&gt;']/g, (target) =&gt; &#123; return &#123; '&lt;': '&amp;lt;', '"': '&amp;quot;', '&gt;': '&amp;gt;', "'": '&amp;#39;' &#125;[target] &#125;), newTitle = title.replace(/[&lt;"&gt;']/g, (target) =&gt; &#123; return &#123; '&lt;': '&amp;lt;', '"': '&amp;quot;', '&gt;': '&amp;gt;', "'": '&amp;#39;' &#125;[target] &#125;); //console.log([name, newTitle, content, id, time]) await userModel.findUserData(ctx.session.user) .then(res =&gt; &#123; console.log(res[0]['avator']) avator = res[0]['avator'] &#125;) await userModel.insertPost([name, newTitle, md.render(content), content, id, time,avator]) .then(() =&gt; &#123; ctx.body = true &#125;).catch(() =&gt; &#123; ctx.body = false &#125;)&#125;) ä¿®æ”¹ views/create.ejs create.ejs123456789101112131415161718192021222324252627282930313233343536373839404142434445&lt;%- include("header",&#123;type:'create'&#125;) %&gt;&lt;div class="container"&gt; &lt;form style="width:100%" method="post" class="form create"&gt; &lt;div&gt; &lt;label&gt;æ ‡é¢˜ï¼š&lt;/label&gt; &lt;input placeholder="è¯·è¾“å…¥æ ‡é¢˜" type="text" name="title"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å†…å®¹ï¼š&lt;/label&gt; &lt;textarea placeholder="è¯·è¾“å…¥å†…å®¹" name="content" id="" cols="42" rows="10"&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;div class="submit"&gt;å‘è¡¨&lt;/div&gt; &lt;/form&gt;&lt;/div&gt;&lt;script&gt; $('.submit').click(()=&gt;&#123; if ($('input[name=title]').val().trim() == '') &#123; fade('è¯·è¾“å…¥æ ‡é¢˜') &#125;else if ($('textarea').val().trim() == '') &#123; fade('è¯·è¾“å…¥å†…å®¹') &#125;else&#123; $.ajax(&#123; url: "/create", data: $('.form').serialize(), type: "POST", cache: false, dataType: 'json', success: function (msg) &#123; if (msg) &#123; fade('å‘è¡¨æˆåŠŸ') setTimeout(()=&gt;&#123; window.location.href="/posts" &#125;,1000) &#125;else&#123; fade('å‘è¡¨å¤±è´¥') &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125; &#125;)&lt;/script&gt;&lt;% include footer %&gt; çŽ°åœ¨çœ‹çœ‹èƒ½ä¸èƒ½å‘è¡¨å§ å³ä½¿æˆ‘ä»¬å‘è¡¨äº†æ–‡ç« ï¼Œä½†æ˜¯å½“å‰æˆ‘ä»¬çš„postsçš„é¡µé¢æ²¡æœ‰æ˜¾ç¤ºï¼Œå› ä¸ºè¿˜æ²¡æœ‰èŽ·å–åˆ°æ•°æ® æˆ‘ä»¬å¯ä»¥çœ‹æˆ‘ä»¬ä¹‹å‰å†™çš„ä»£ç  router.get(&#39;/posts&#39;, async(ctx, next) =&gt; {}è·¯ç”±1234567891011121314151617181920if (ctx.request.querystring) &#123; ...&#125;else &#123; await userModel.findPostByPage(1) .then(result =&gt; &#123; //console.log(result) res = result &#125;) await userModel.findAllPost() .then(result=&gt;&#123; postsLength = result.length &#125;) await ctx.render('posts', &#123; session: ctx.session, posts: res, postsLength: postsLength, postsPageLength: Math.ceil(postsLength / 10), &#125;) &#125; ifå‰é¢è¿™éƒ¨åˆ†æˆ‘ä»¬å…ˆä¸ç”¨ç®¡ï¼ŒåŽé¢ä¼šè¯´ã€‚åªéœ€è¦çœ‹elseåŽé¢çš„ä»£ç æˆ‘ä»¬é€šè¿‡userModel.findPostByPage(1)æ¥èŽ·å–ç¬¬ä¸€é¡µçš„æ•°æ®ï¼Œç„¶åŽæŸ¥æ‰¾æ‰€æœ‰æ–‡ç« çš„æ•°é‡ï¼Œæœ€åŽé™¤ä»¥10æ‹¿åˆ°é¦–é¡µæ–‡ç« çš„é¡µæ•°ï¼ŒæŠŠæ•°æ®postsPageLengthçš„å€¼ä¼ ç»™æ¨¡æ¿posts.ejsã€‚è¿™æ ·å°±å¯ä»¥æ¸²æŸ“å‡ºæ¥äº† ä¿®æ”¹ views/posts.ejs posts.ejs 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384&lt;%- include("header",&#123;type:'all'&#125;) %&gt; &lt;div class="container"&gt; &lt;ul class="posts"&gt; &lt;% posts.forEach(function(res)&#123; %&gt; &lt;li&gt; &lt;div class="author"&gt; &lt;span title="&lt;%= res.name %&gt;"&gt;&lt;a href="/posts?author=&lt;%= res.name %&gt; "&gt;author: &lt;%= res.name %&gt;&lt;/a&gt;&lt;/span&gt; &lt;span&gt;è¯„è®ºæ•°ï¼š&lt;%= res.comments %&gt;&lt;/span&gt; &lt;span&gt;æµè§ˆé‡ï¼š&lt;%= res.pv %&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class="comment_pv"&gt; &lt;span&gt;&lt;%= res.moment %&gt;&lt;/span&gt; &lt;/div&gt; &lt;a href="/posts/&lt;%= res.id %&gt;"&gt; &lt;div class="title"&gt; &lt;img class="userAvator" src="images/&lt;%= res.avator %&gt;.png"&gt; &lt;%= res.title %&gt; &lt;/div&gt; &lt;div class="content markdown"&gt; &lt;%- res.content %&gt; &lt;/div&gt; &lt;/a&gt; &lt;/li&gt; &lt;% &#125;) %&gt; &lt;/ul&gt; &lt;div style="margin-top: 30px" class="pagination" id="page"&gt;&lt;/div&gt; &lt;/div&gt; &lt;script src="http://www.wclimb.site/pagination/pagination.js"&gt;&lt;/script&gt; &lt;script&gt; pagination(&#123; selector: '#page', totalPage: &lt;%= postsPageLength %&gt;, currentPage: 1, prev: 'ä¸Šä¸€é¡µ', next: 'ä¸‹ä¸€é¡µ', first: true, last: true, showTotalPage: true, count: 2//å½“å‰é¡µå‰åŽæ˜¾ç¤ºçš„æ•°é‡ &#125;,function(val)&#123; // å½“å‰é¡µ $.ajax(&#123; url: "posts/page", type: 'POST', data:&#123; page: val &#125;, cache: false, success: function (msg) &#123; console.log(msg) if (msg != 'error') &#123; $('.posts').html(' ') $.each(msg,function(i,val)&#123; //console.log(val.content) $('.posts').append( '&lt;li&gt;'+ '&lt;div class=\"author\"&gt;'+ '&lt;span title=\"'+ val.name +'\"&gt;&lt;a href=\"/posts?author='+ val.name +' \"&gt;author: '+ val.name +'&lt;/a&gt;&lt;/span&gt;'+ '&lt;span&gt;è¯„è®ºæ•°ï¼š'+ val.comments +'&lt;/span&gt;'+ '&lt;span&gt;æµè§ˆé‡ï¼š'+ val.pv +'&lt;/span&gt;'+ '&lt;/div&gt;'+ '&lt;div class=\"comment_pv\"&gt;'+ '&lt;span&gt;'+ val.moment +'&lt;/span&gt;'+ '&lt;/div&gt;'+ '&lt;a href=\"/posts/'+ val.id +'\"&gt;'+ '&lt;div class=\"title\"&gt;'+ '&lt;img class="userAvator" src="images/'+ val.avator +'.png"&gt;'+ val.title + '&lt;/div&gt;'+ '&lt;div class=\"content\"&gt;'+ val.content + '&lt;/div&gt;'+ '&lt;/a&gt;'+ '&lt;/li&gt;' ) &#125;) &#125;else&#123; alert('åˆ†é¡µä¸å­˜åœ¨') &#125; &#125; &#125;) &#125;) &lt;/script&gt;&lt;% include footer %&gt; çŽ°åœ¨çœ‹çœ‹postsé¡µé¢æœ‰æ²¡æœ‰æ–‡ç« å‡ºçŽ°äº† æˆ‘ä»¬çœ‹åˆ°æ˜¯æ‰€ç¬¬ä¸€é¡µçš„æ–‡ç« æ•°æ®ï¼Œåˆå§‹åŒ–çš„ç¨åŽæˆ‘ä»¬æ˜¯ç”¨æœåŠ¡ç«¯æ¸²æŸ“çš„æ•°æ®ï¼Œä½¿ç”¨äº†åˆ†é¡µï¼Œæ¯é¡µæ˜¾ç¤º10æ¡æ•°æ®ï¼Œç„¶åŽé€šè¿‡è¯·æ±‚é¡µæ•°ã€‚ä¸‹é¢æ˜¯æœåŠ¡ç«¯è¯·æ±‚æ‹¿åˆ°çš„ç¬¬ä¸€é¡µçš„æ•°æ®1234await userModel.findPostByUserPage(name,1) .then(result =&gt; &#123; res = result &#125;) è¦æ‹¿åˆ°åˆ«çš„é¡µé¢æ•°æ®çš„è¯è¦å‘æœåŠ¡å™¨å‘é€postè¯·æ±‚ï¼Œå¦‚ä¸‹1234567891011// é¦–é¡µåˆ†é¡µï¼Œæ¯æ¬¡è¾“å‡º10æ¡router.post(&apos;/posts/page&apos;, async(ctx, next) =&gt; &#123; let page = ctx.request.body.page; await userModel.findPostByPage(page) .then(result=&gt;&#123; //console.log(result) ctx.body = result &#125;).catch(()=&gt;&#123; ctx.body = &apos;error&apos; &#125;) &#125;) å•ç¯‡æ–‡ç« é¡µé¢ä½†æ˜¯æˆ‘éœ€è¦ç‚¹å‡»å•ç¯‡æ–‡ç« çš„æ—¶å€™ï¼Œæ˜¾ç¤ºä¸€ç¯‡æ–‡ç« æ€Žä¹ˆåŠžå‘¢ï¼Ÿ ä¿®æ”¹ routers/posts.js åœ¨posts.jsåŽé¢å¢žåŠ  12345678910111213141516171819202122232425262728293031323334// å•ç¯‡æ–‡ç« é¡µrouter.get('/posts/:postId', async(ctx, next) =&gt; &#123; let comment_res, res, pageOne, res_pv; await userModel.findDataById(ctx.params.postId) .then(result =&gt; &#123; //console.log(result ) res = result res_pv = parseInt(result[0]['pv']) res_pv += 1 // console.log(res_pv) &#125;) await userModel.updatePostPv([res_pv, ctx.params.postId]) await userModel.findCommentByPage(1,ctx.params.postId) .then(result =&gt; &#123; pageOne = result //console.log('comment', comment_res) &#125;) await userModel.findCommentById(ctx.params.postId) .then(result =&gt; &#123; comment_res = result //console.log('comment', comment_res) &#125;) await ctx.render('sPost', &#123; session: ctx.session, posts: res[0], commentLenght: comment_res.length, commentPageLenght: Math.ceil(comment_res.length/10), pageOne:pageOne &#125;)&#125;) çŽ°åœ¨çš„è®¾è®¡æ˜¯ï¼Œæˆ‘ä»¬ç‚¹è¿›åŽ»å‡ºçŽ°çš„urlæ˜¯ /posts/1 è¿™ç±»çš„ 1ä»£è¡¨è¯¥ç¯‡æ–‡ç« çš„idï¼Œæˆ‘ä»¬åœ¨æ•°æ®åº“å»ºè¡¨çš„æ—¶å€™å°±å¤„ç†äº†ï¼Œè®©idä¸ºä¸»é”®ï¼Œç„¶åŽé€’å¢ž æˆ‘ä»¬é€šè¿‡userModel.findDataById æ–‡ç« çš„idæ¥æŸ¥æ‰¾æ•°æ®åº“æˆ‘ä»¬é€šè¿‡userModel.findCommentById æ–‡ç« çš„idæ¥æŸ¥æ‰¾æ–‡ç« çš„è¯„è®ºï¼Œå› ä¸ºå•ç¯‡æ–‡ç« é‡Œé¢æœ‰è¯„è®ºçš„åŠŸèƒ½æœ€åŽé€šè¿‡sPost.ejsæ¨¡æ¿æ¸²æŸ“å•ç¯‡æ–‡ç«  ä¿®æ”¹ views/sPost.ejs sPost.ejs 123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103104105106107108109110111112113114115116117118119120121122123124125126127128129130131132133134135136137138139140141142143144145146147148149150151152153154155156157158159160161162163164165166167168169170171172173174175176177178179180181182183184185186&lt;%- include("header",&#123;type:''&#125;) %&gt; &lt;div class="container"&gt; &lt;ul class="posts spost"&gt; &lt;li&gt; &lt;div class="author"&gt; &lt;span title="&lt;%= posts.name %&gt;"&gt;&lt;a href="/posts?author=&lt;%= posts.name %&gt; "&gt;author: &lt;%= posts.name %&gt;&lt;/a&gt;&lt;/span&gt; &lt;span&gt;è¯„è®ºæ•°ï¼š&lt;%= posts.comments %&gt;&lt;/span&gt; &lt;span&gt;æµè§ˆé‡ï¼š&lt;%= posts.pv %&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class="comment_pv"&gt; &lt;span&gt;&lt;%= posts.moment %&gt;&lt;/span&gt; &lt;/div&gt; &lt;a href="/posts/&lt;%= posts.id %&gt;"&gt; &lt;div class="title"&gt; &lt;img class="userAvator" src="../images/&lt;%= posts.avator %&gt;.png"&gt; &lt;%= posts.title %&gt; &lt;/div&gt; &lt;div class="content markdown"&gt; &lt;%- posts.content %&gt; &lt;/div&gt; &lt;/a&gt; &lt;div class="edit"&gt; &lt;% if(session &amp;&amp; session.user === posts.name )&#123; %&gt; &lt;p&gt;&lt;a href="&lt;%= posts['id'] %&gt;/edit"&gt;ç¼–è¾‘&lt;/a&gt;&lt;/p&gt; &lt;p&gt;&lt;a class="delete_post"&gt;åˆ é™¤&lt;/a&gt;&lt;/p&gt; &lt;% &#125; %&gt; &lt;/div&gt; &lt;/li&gt; &lt;/ul&gt; &lt;/div&gt; &lt;div class="comment_wrap"&gt; &lt;% if(session.user)&#123; %&gt; &lt;form class="form" method="post" action="/&lt;%= posts.id %&gt;"&gt; &lt;textarea id="spContent" name="content" cols="82"&gt;&lt;/textarea&gt; &lt;div class="submit"&gt;å‘è¡¨ç•™è¨€&lt;/div&gt; &lt;/form&gt; &lt;% &#125; else&#123; %&gt; &lt;p class="tips"&gt;ç™»å½•ä¹‹åŽæ‰å¯ä»¥è¯„è®ºå“Ÿ&lt;/p&gt; &lt;% &#125; %&gt; &lt;% if (commentPageLenght &gt; 0) &#123; %&gt; &lt;div class="comment_list markdown"&gt; &lt;% pageOne.forEach(function(res)&#123; %&gt; &lt;div class="cmt_lists"&gt; &lt;div class="cmt_content"&gt; &lt;div class="userMsg"&gt; &lt;img src="../images/&lt;%= res['avator'] %&gt;.png" alt=""&gt;&lt;span&gt;&lt;%= res['name'] %&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class="cmt_detail"&gt; &lt;%- res['content'] %&gt; &lt;/div&gt; &lt;span class="cmt_time"&gt;&lt;%= res['moment'] %&gt;&lt;/span&gt; &lt;span class="cmt_name"&gt; &lt;% if(session &amp;&amp; session.user === res['name'])&#123; %&gt; &lt;a class="delete_comment" href="javascript:delete_comment(&lt;%= res['id'] %&gt;);"&gt; åˆ é™¤&lt;/a&gt; &lt;% &#125; %&gt; &lt;/span&gt; &lt;/div&gt; &lt;/div&gt; &lt;% &#125;) %&gt; &lt;/div&gt; &lt;% &#125; else&#123; %&gt; &lt;p class="tips"&gt;è¿˜æ²¡æœ‰è¯„è®ºï¼Œèµ¶å¿«åŽ»è¯„è®ºå§ï¼&lt;/p&gt; &lt;% &#125; %&gt; &lt;div style="margin-top: 30px" class="pagination" id="page"&gt;&lt;/div&gt; &lt;/div&gt; &lt;script src="http://www.wclimb.site/pagination/pagination.js"&gt;&lt;/script&gt; &lt;script&gt; var userName = "&lt;%- session.user %&gt;" pagination(&#123; selector: '#page', totalPage: &lt;%= commentPageLenght %&gt;, currentPage: 1, prev: 'ä¸Šä¸€é¡µ', next: 'ä¸‹ä¸€é¡µ', first: true, last: true, showTotalPage:true, count: 2//å½“å‰é¡µå‰é¢æ˜¾ç¤ºçš„æ•°é‡ &#125;,function(val)&#123; // å½“å‰é¡µ var _comment = '' $.ajax(&#123; url: "&lt;%= posts.id %&gt;/commentPage", type: 'POST', data:&#123; page: val &#125;, cache: false, success: function (msg) &#123; //console.log(msg) _comment = '' if (msg != 'error') &#123; $('.comment_list').html(' ') $.each(msg,function(i,val)&#123; //console.log(val.content) _comment += '&lt;div class=\"cmt_lists\"&gt;&lt;div class=\"cmt_content\"&gt;&lt;div class=\"userMsg\"&gt;&lt;img src = \"../images/'+ val.avator +'.png\" &gt;&lt;span&gt;'+ val.name +'&lt;/span&gt;&lt;/div &gt;&lt;div class="cmt_detail"&gt;'+ val.content + '&lt;/div&gt;&lt;span class=\"cmt_time\"&gt;'+ val.moment +'&lt;/span&gt;&lt;span class=\"cmt_name\"&gt;'; if (val.name == userName) &#123; _comment += '&lt;a class=\"delete_comment\" href=\"javascript:delete_comment('+ val.id +');\"&gt; åˆ é™¤&lt;/a&gt;' &#125; _comment += '&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;' &#125;) $('.comment_list').append(_comment) &#125;else&#123; alert('åˆ†é¡µä¸å­˜åœ¨') &#125; &#125; &#125;) &#125;) // åˆ é™¤æ–‡ç«  $('.delete_post').click(() =&gt; &#123; $.ajax(&#123; url: "&lt;%= posts.id %&gt;/remove", type: 'POST', cache: false, success: function (msg) &#123; if (msg.data == 1) &#123; fade('åˆ é™¤æ–‡ç« æˆåŠŸ') setTimeout(() =&gt; &#123; window.location.href = "/posts" &#125;, 1000) &#125; else if (msg.data == 2) &#123; fade('åˆ é™¤æ–‡ç« å¤±è´¥'); setTimeout(() =&gt; &#123; window.location.reload() &#125;, 1000) &#125; &#125; &#125;) &#125;) // è¯„è®º var isAllow = true $('.submit').click(function()&#123; if (!isAllow) return isAllow = false if ($('textarea').val().trim() == '') &#123; fade('è¯·è¾“å…¥è¯„è®ºï¼') &#125;else&#123; $.ajax(&#123; url: '/' + location.pathname.split('/')[2], data:$('.form').serialize(), type: "POST", cache: false, dataType: 'json', success: function (msg) &#123; if (msg) &#123; fade('å‘è¡¨ç•™è¨€æˆåŠŸ') setTimeout(()=&gt;&#123; isAllow = true window.location.reload() &#125;,1500) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125; &#125;) // åˆ é™¤è¯„è®º function delete_comment(id) &#123; $.ajax(&#123; url: "&lt;%= posts.id %&gt;/comment/" + id + "/remove", type: 'POST', cache: false, success: function (msg) &#123; if (msg.data == 1) &#123; fade('åˆ é™¤ç•™è¨€æˆåŠŸ') setTimeout(() =&gt; &#123; window.location.reload() &#125;, 1000) &#125; else if (msg.data == 2) &#123; fade('åˆ é™¤ç•™è¨€å¤±è´¥'); setTimeout(() =&gt; &#123; window.location.reload() &#125;, 1500) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸') &#125; &#125;) &#125; &lt;/script&gt;&lt;% include footer %&gt; çŽ°åœ¨ç‚¹å‡»å•ç¯‡æ–‡ç« è¯•è¯•ï¼Œè¿›å…¥å•ç¯‡æ–‡ç« é¡µé¢ï¼Œä½†æ˜¯ç¼–è¾‘ã€åˆ é™¤ã€è¯„è®ºéƒ½è¿˜æ²¡æœ‰åšï¼Œç‚¹å‡»æ— æ•ˆï¼Œæˆ‘ä»¬å…ˆä¸åšï¼Œå…ˆå®žçŽ°æ¯ä¸ªç”¨æˆ·è‡ªå·±å‘è¡¨çš„æ–‡ç« åˆ—è¡¨ï¼Œæˆ‘ä»¬ä¹‹å‰åœ¨ get â€˜/postsâ€™ é‡Œé¢è¯´å…ˆå¿½ç•¥if (ctx.request.querystring) {}é‡Œé¢çš„ä»£ç ï¼Œè¿™é‡Œæ˜¯åšäº†ä¸€ä¸ªå¤„ç†ï¼Œå‡å¦‚ç”¨æˆ·ç‚¹å‡»äº†æŸä¸ªç”¨æˆ·ï¼Œè¯¥ç”¨æˆ·å‘è¡¨äº†å‡ ç¯‡æ–‡ç« ï¼Œæˆ‘ä»¬éœ€è¦åªæ˜¾ç¤ºè¯¥ç”¨æˆ·å‘è¡¨çš„æ–‡ç« ï¼Œé‚£ä¹ˆè¿›å…¥çš„urlåº”è¯¥æ˜¯ /posts?author=xxx ,è¿™ä¸ªå¤„ç†åœ¨posts.ejs å°±å·²ç»åŠ ä¸Šäº†ï¼Œå°±åœ¨æ–‡ç« çš„å·¦ä¸‹è§’ï¼Œä½œè€…ï¼šxxxå°±æ˜¯ä¸€ä¸ªé“¾æŽ¥ã€‚æˆ‘ä»¬é€šè¿‡åˆ¤æ–­ç”¨æˆ·æ¥æŸ¥æ‰¾æ–‡ç« ï¼Œç»§è€Œæœ‰äº†ctx.request.querystring èŽ·å–åˆ°çš„æ˜¯ï¼šauthor=xxx æ³¨ï¼šè¿™é‡Œæˆ‘ä»¬å¤„ç†äº†ï¼Œé€šè¿‡åˆ¤æ–­ session.user === res[&#39;name&#39;] å¦‚æžœä¸æ˜¯è¯¥ç”¨æˆ·å‘çš„æ–‡ç« ï¼Œä¸èƒ½ç¼–è¾‘å’Œåˆ é™¤ï¼Œè¯„è®ºä¹Ÿæ˜¯ã€‚è¿™é‡Œé¢ä¹Ÿå¯ä»¥æ³¨æ„ä¸€ä¸‹åŒ…è£¹çš„&lt;a href=&quot;&quot;&gt;&lt;/a&gt;æ ‡ç­¾ ä¸ªäººå·²å‘è¡¨æ–‡ç« åˆ—è¡¨é‡Œé¢è¿˜è®°å¾—ä¹‹å‰åœ¨ get â€˜/postâ€™ é‡Œé¢çš„ä»£ç å—ï¼Ÿä¸‹é¢çš„ä»£ç å°±æ˜¯ä¹‹å‰è¯´å…ˆä¸å¤„ç†çš„ä»£ç ç‰‡æ®µï¼Œä¸è¿‡è¿™ä¸ªä¸ç”¨å†æ¬¡æ·»åŠ ï¼Œä¹‹å‰å·²ç»æ·»åŠ å¥½äº†ï¼Œè¿™æ®µä»£ç å¤„ç†ä¸ªäººå‘å¸ƒçš„æ–‡ç« åˆ—è¡¨ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡selfPosts.ejsæ¨¡æ¿æ¥æ¸²æŸ“çš„ï¼Œæ ·å¼å’Œå…¨éƒ¨æ–‡ç« åˆ—è¡¨ä¸€æ ·ï¼Œä½†æ˜¯ç‰µæ‰¯åˆ°åˆ†é¡µçš„é—®é¢˜ï¼Œåˆ†é¡µè¯·æ±‚çš„æ˜¯ä¸åŒçš„æŽ¥å£åœ°å€ 12345678910111213141516if (ctx.request.querystring) &#123; console.log('ctx.request.querystring', name) await userModel.findDataByUser(name) .then(result =&gt; &#123; postsLength = result.length &#125;) await userModel.findPostByUserPage(name,1) .then(result =&gt; &#123; res = result &#125;) await ctx.render('selfPosts', &#123; session: ctx.session, posts: res, postsPageLength:Math.ceil(postsLength / 10), &#125;) &#125; ä¿®æ”¹ selfPost.ejs 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859606162636465666768697071727374757677787980818283848586&lt;%- include("header",&#123;type:'my'&#125;) %&gt; &lt;div class="container"&gt; &lt;ul class="posts"&gt; &lt;% posts.forEach(function(res)&#123; %&gt; &lt;li&gt; &lt;div class="author"&gt; &lt;span title="&lt;%= res.name %&gt;"&gt;&lt;a href="/posts?author=&lt;%= res.name %&gt; "&gt;author: &lt;%= res.name %&gt;&lt;/a&gt;&lt;/span&gt; &lt;span&gt;è¯„è®ºæ•°ï¼š&lt;%= res.comments %&gt;&lt;/span&gt; &lt;span&gt;æµè§ˆé‡ï¼š&lt;%= res.pv %&gt;&lt;/span&gt; &lt;/div&gt; &lt;div class="comment_pv"&gt; &lt;span&gt;&lt;%= res.moment %&gt;&lt;/span&gt; &lt;/div&gt; &lt;a href="/posts/&lt;%= res.id %&gt;"&gt; &lt;div class="title"&gt; &lt;img class="userAvator" src="images/&lt;%= res.avator %&gt;.png"&gt; &lt;%= res.title %&gt; &lt;/div&gt; &lt;div class="content markdown"&gt; &lt;%- res.content %&gt; &lt;/div&gt; &lt;/a&gt; &lt;/li&gt; &lt;% &#125;) %&gt; &lt;/ul&gt; &lt;div style="margin-top: 30px" class="pagination" id="page"&gt;&lt;/div&gt; &lt;/div&gt; &lt;script src="http://www.wclimb.site/pagination/pagination.js"&gt;&lt;/script&gt; &lt;script&gt; pagination(&#123; selector: '#page', totalPage: &lt;%= postsPageLength %&gt;, currentPage: 1, prev: 'ä¸Šä¸€é¡µ', next: 'ä¸‹ä¸€é¡µ', first: true, last: true, showTotalPage: true, count: 2//å½“å‰é¡µå‰åŽæ˜¾ç¤ºçš„æ•°é‡ &#125;,function(val)&#123; // å½“å‰é¡µ $.ajax(&#123; url: "posts/self/page", type: 'POST', data:&#123; page: val, name: location.search.slice(1).split('=')[1] &#125;, cache: false, success: function (msg) &#123; //console.log(msg) if (msg != 'error') &#123; $('.posts').html(' ') $.each(msg,function(i,val)&#123; //console.log(val.content) $('.posts').append( '&lt;li&gt;'+ '&lt;div class=\"author\"&gt;'+ '&lt;span title=\"'+ val.name +'\"&gt;&lt;a href=\"/posts?author='+ val.name +' \"&gt;author: '+ val.name +'&lt;/a&gt;&lt;/span&gt;'+ '&lt;span&gt;è¯„è®ºæ•°ï¼š'+ val.comments +'&lt;/span&gt;'+ '&lt;span&gt;æµè§ˆé‡ï¼š'+ val.pv +'&lt;/span&gt;'+ '&lt;/div&gt;'+ '&lt;div class=\"comment_pv\"&gt;'+ '&lt;span&gt;'+ val.moment +'&lt;/span&gt;'+ '&lt;/div&gt;'+ '&lt;a href=\"/posts/'+ val.id +'\"&gt;'+ '&lt;div class=\"title\"&gt;'+ '&lt;img class="userAvator" src="images/' + val.avator + '.png"&gt;' + val.title + '&lt;/div&gt;'+ '&lt;div class=\"content\"&gt;'+ val.content + '&lt;/div&gt;'+ '&lt;/a&gt;'+ '&lt;/li&gt;' ) &#125;) &#125;else&#123; alert('åˆ†é¡µä¸å­˜åœ¨') &#125; &#125; &#125;) &#125;) &lt;/script&gt;&lt;% include footer %&gt; ç¼–è¾‘æ–‡ç« ã€åˆ é™¤æ–‡ç« ã€è¯„è®ºã€åˆ é™¤è¯„è®º è¯„è®º ä¿®æ”¹routers/posts.js åœ¨post.js åŽé¢å¢žåŠ  12345678910111213141516171819202122232425262728293031323334353637// å‘è¡¨è¯„è®ºrouter.post('/:postId', async(ctx, next) =&gt; &#123; let name = ctx.session.user, content = ctx.request.body.content, postId = ctx.params.postId, res_comments, time = moment().format('YYYY-MM-DD HH:mm:ss'), avator; await userModel.findUserData(ctx.session.user) .then(res =&gt; &#123; console.log(res[0]['avator']) avator = res[0]['avator'] &#125;) await userModel.insertComment([name, md.render(content),time, postId,avator]) await userModel.findDataById(postId) .then(result =&gt; &#123; res_comments = parseInt(result[0]['comments']) res_comments += 1 &#125;) await userModel.updatePostComment([res_comments, postId]) .then(() =&gt; &#123; ctx.body = true &#125;).catch(() =&gt; &#123; ctx.body = false &#125;)&#125;)// è¯„è®ºåˆ†é¡µrouter.post('/posts/:postId/commentPage', async function(ctx)&#123; let postId = ctx.params.postId, page = ctx.request.body.page; await userModel.findCommentByPage(page,postId) .then(res=&gt;&#123; ctx.body = res &#125;).catch(()=&gt;&#123; ctx.body = 'error' &#125;) &#125;) çŽ°åœ¨è¯•è¯•å‘è¡¨è¯„è®ºçš„åŠŸèƒ½å§ï¼Œä¹‹æ‰€ä»¥è¿™æ ·ç®€å•ï¼Œå› ä¸ºæˆ‘ä»¬ä¹‹å‰å°±åœ¨sPost.ejsåšäº†å¥½å‡ ä¸ªajaxçš„å¤„ç†ï¼Œåˆ é™¤æ–‡ç« å’Œè¯„è®ºä¹Ÿæ˜¯å¦‚æ­¤è¯„è®ºæˆ‘ä»¬ä¹Ÿåšäº†åˆ†é¡µï¼Œæ‰€ä»¥åŽé¢ä¼šæœ‰ä¸€ä¸ªè¯„è®ºçš„åˆ†é¡µçš„æŽ¥å£ï¼Œæˆ‘ä»¬å·²ç»åœ¨sPost.ejsé‡Œé¢å†™å¥½äº†ajaxè¯·æ±‚ åˆ é™¤è¯„è®º ä¿®æ”¹routers/posts.js ç»§ç»­åœ¨post.js åŽé¢å¢žåŠ  12345678910111213141516171819202122232425// åˆ é™¤è¯„è®ºrouter.post('/posts/:postId/comment/:commentId/remove', async(ctx, next) =&gt; &#123; let postId = ctx.params.postId, commentId = ctx.params.commentId, res_comments; await userModel.findDataById(postId) .then(result =&gt; &#123; res_comments = parseInt(result[0]['comments']) //console.log('res', res_comments) res_comments -= 1 //console.log(res_comments) &#125;) await userModel.updatePostComment([res_comments, postId]) await userModel.deleteComment(commentId) .then(() =&gt; &#123; ctx.body = &#123; data: 1 &#125; &#125;).catch(() =&gt; &#123; ctx.body = &#123; data: 2 &#125; &#125;)&#125;) çŽ°åœ¨è¯•è¯•åˆ é™¤è¯„è®ºçš„åŠŸèƒ½å§ åˆ é™¤æ–‡ç«  åªæœ‰è‡ªå·±å‘è¡¨çš„æ–‡å­—åˆ é™¤çš„æ–‡å­—æ‰ä¼šæ˜¾ç¤ºå‡ºæ¥ï¼Œæ‰èƒ½è¢«åˆ é™¤ï¼Œ ä¿®æ”¹routers/posts.js ç»§ç»­åœ¨post.js åŽé¢å¢žåŠ  123456789101112131415// åˆ é™¤å•ç¯‡æ–‡ç« router.post('/posts/:postId/remove', async(ctx, next) =&gt; &#123; let postId = ctx.params.postId await userModel.deleteAllPostComment(postId) await userModel.deletePost(postId) .then(() =&gt; &#123; ctx.body = &#123; data: 1 &#125; &#125;).catch(() =&gt; &#123; ctx.body = &#123; data: 2 &#125; &#125;)&#125;) çŽ°åœ¨è¯•è¯•åˆ é™¤æ–‡ç« çš„åŠŸèƒ½å§ ç¼–è¾‘æ–‡ç«  ä¿®æ”¹routers/posts.js ç»§ç»­åœ¨post.js åŽé¢å¢žåŠ  123456789101112131415161718192021222324252627282930313233343536373839404142434445464748// ç¼–è¾‘å•ç¯‡æ–‡ç« é¡µé¢router.get('/posts/:postId/edit', async(ctx, next) =&gt; &#123; let name = ctx.session.user, postId = ctx.params.postId, res; await userModel.findDataById(postId) .then(result =&gt; &#123; res = result[0] //console.log('ä¿®æ”¹æ–‡ç« ', res) &#125;) await ctx.render('edit', &#123; session: ctx.session, postsContent: res.md, postsTitle: res.title &#125;)&#125;)// post ç¼–è¾‘å•ç¯‡æ–‡ç« router.post('/posts/:postId/edit', async(ctx, next) =&gt; &#123; let title = ctx.request.body.title, content = ctx.request.body.content, id = ctx.session.id, postId = ctx.params.postId, // çŽ°åœ¨ä½¿ç”¨markdownä¸éœ€è¦å•ç‹¬è½¬ä¹‰ newTitle = title.replace(/[&lt;"&gt;']/g, (target) =&gt; &#123; return &#123; '&lt;': '&amp;lt;', '"': '&amp;quot;', '&gt;': '&amp;gt;', "'": '&amp;#39;' &#125;[target] &#125;), newContent = content.replace(/[&lt;"&gt;']/g, (target) =&gt; &#123; return &#123; '&lt;': '&amp;lt;', '"': '&amp;quot;', '&gt;': '&amp;gt;', "'": '&amp;#39;' &#125;[target] &#125;); await userModel.updatePost([newTitle, md.render(content), content, postId]) .then(() =&gt; &#123; ctx.body = true &#125;).catch(() =&gt; &#123; ctx.body = false &#125;)&#125;) ä¿®æ”¹views/edit.js 12345678910111213141516171819202122232425262728293031323334353637&lt;%- include("header",&#123;type:''&#125;) %&gt;&lt;div class="container"&gt; &lt;form style="width:100%" class="form create" method="post"&gt; &lt;div&gt; &lt;label&gt;æ ‡é¢˜ï¼š&lt;/label&gt; &lt;input placeholder="æ ‡é¢˜" type="text" name="title" value="&lt;%- postsTitle %&gt;"&gt; &lt;/div&gt; &lt;div&gt; &lt;label&gt;å†…å®¹ï¼š&lt;/label&gt; &lt;textarea name="content" id="" cols="42" rows="10"&gt;&lt;%= postsContent %&gt;&lt;/textarea&gt; &lt;/div&gt; &lt;div class="submit"&gt;ä¿®æ”¹&lt;/div&gt; &lt;/form&gt;&lt;/div&gt;&lt;script&gt; $('.submit').click(()=&gt;&#123; $.ajax(&#123; url: '', data: $('.form').serialize(), type: "POST", cache: false, dataType: 'json', success: function (msg) &#123; if (msg) &#123; fade('ä¿®æ”¹æˆåŠŸ') setTimeout(()=&gt;&#123; window.location.href="/posts" &#125;,1000) &#125; &#125;, error: function () &#123; alert('å¼‚å¸¸'); &#125; &#125;) &#125;)&lt;/script&gt;&lt;% include footer %&gt; çŽ°åœ¨è¯•è¯•ç¼–è¾‘æ–‡å­—ç„¶åŽä¿®æ”¹æäº¤å§ ç»“è¯­è‡³æ­¤ä¸€ä¸ªç®€å•çš„blogå°±å·²ç»åˆ¶ä½œå¥½äº†ï¼Œå…¶ä»–æ‰©å±•åŠŸèƒ½ç›¸ä¿¡ä½ å·²ç»ä¼šäº†å§ï¼å¦‚æžœå‡ºçŽ°é—®é¢˜ï¼Œè¿˜æœ›ç§¯æžæé—®å“ˆï¼Œæˆ‘ä¼šå°½å¿«å¤„ç†çš„ æ‰€æœ‰çš„ä»£ç éƒ½åœ¨ https://github.com/wclimb/Koa2-blog é‡Œé¢ï¼Œå¦‚æžœè§‰å¾—ä¸é”™å°±starä¸€ä¸‹å§ã€‚æœ‰é—®é¢˜å¯ä»¥æé—®å“Ÿä¸‹ä¸€ç¯‡å¯èƒ½æ˜¯ Node + express + mongoose æˆ– zeptoæºç ç³»åˆ—æ„Ÿè°¢æ‚¨çš„é˜…è¯»^_^ ä¸ªäººå°ç¨‹åº]]></content>
      <categories>
        <category>javascript</category>
        <category>node</category>
      </categories>
      <tags>
        <tag>Mysql</tag>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>Node</tag>
        <tag>Koa</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[è¯»zeptoæºç ï¼Œå°è£…è‡ªå·±çš„zeptoåº“ï¼ˆä¸€ï¼‰]]></title>
    <url>%2F2017%2F06%2F29%2F%E8%AF%BBzepto%E6%BA%90%E7%A0%81%EF%BC%8C%E5%B0%81%E8%A3%85%E8%87%AA%E5%B7%B1%E7%9A%84zepto%E5%BA%93%EF%BC%88%E4%B8%80%EF%BC%89%2F</url>
    <content type="text"><![CDATA[å†™åœ¨å‰é¢ è¯»zeptoæºç ï¼Œå°è£…è‡ªå·±çš„zeptoåº“ç³»åˆ—æ˜¯è‡ªå·±åœ¨è¯»zeptoæºç çš„ä¸€äº›ç†è§£ï¼Œæœ‰é”™è¯¯çš„åœ°æ–¹è¿˜æœ›æŒ‡å‡ºã€‚å¦‚æžœè§‰å¾—æœ¬ç³»åˆ—å¯¹ä½ æœ‰æ‰€å¸®åŠ©ï¼Œè¿˜è¯·æŒç»­å…³æ³¨wclimbï¼Œè°¢è°¢ã€‚ zeptoçš„æ•´ä½“æž¶æž„é¦–å…ˆæ¥çœ‹çœ‹æ•´ä½“ä»£ç ç»“æž„ 123456789101112131415161718192021222324252627282930313233(function()&#123; var wclimb = &#123;&#125;,$ $ = function(selector)&#123; return wclimb.init(selector) &#125; wclimb.init = function(selector)&#123; var dom; dom = document.querySelectorAll(selector); return wclimb.Z(dom,selector) &#125; wclimb.Z = function(dom,selector)&#123; return new Z(dom,selector) &#125; wclimb.Z.prototype = Z.prototype = &#123; test:function()&#123; alert(1) &#125; &#125; function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length &#125; window.$ = window.wclimb = $&#125;)() é¦–å…ˆæˆ‘ä»¬è®¾ç½®äº†ä¸€ä¸ªé—­åŒ…ï¼Œé¿å…äº§ç”Ÿå…¨å±€å˜é‡123(function()&#123; ...&#125;)() æˆ‘ä»¬å®šä¹‰ä¸€ä¸ªå¯¹è±¡wclimbå’Œ$ï¼Œä»¥ä¾¿åŽé¢ä½¿ç”¨ 1var wclimb = &#123;&#125;,$ $å‡½æ•°è¿”å›žäº†wclimb.init(selector),æˆ‘ä»¬çŸ¥é“ä½¿ç”¨zeptoçš„æ—¶å€™ï¼Œä¸€èˆ¬æ˜¯$(â€˜pâ€™)ï¼Œè€Œselectorå°±æ˜¯på…ƒç´ ï¼Œå½“ç„¶ä¸æ­¢è¿™ä¸€ç§æƒ…å†µå¦‚$(function(){}),æ‰€ä»¥å¯¹é€‰æ‹©å™¨åŽé¢æˆ‘ä»¬è¦åšåˆ¤æ–­123$ = function(selector)&#123; return wclimb.init(selector)&#125; è€Œwclimb.inité¦–å…ˆå®šä¹‰äº†ä¸€ä¸ªdomï¼Œé€šè¿‡é€‰æ‹©å™¨é€‰å–çš„å…ƒç´ èµ‹å€¼ç»™domï¼Œæœ€åŽè¿”å›žwclimb.initï¼Œä¼ å…¥domå’Œé€‰æ‹©å…ƒç´ selector 12345wclimb.init = function(selector)&#123; var dom; dom = document.querySelector(selector); return wclimb.Z(dom,selector)&#125; æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ä¹‹å‰æˆ‘ä»¬å®šä¹‰äº†å¯¹è±¡wclimbï¼Œè€ŒåŽæˆ‘ä»¬å°±å¾€é‡Œé¢æ·»åŠ äº†ä¸€äº›æ–¹æ³•ï¼Œå°±åƒï¼š 12345678910wclimb = &#123; initï¼šfunction(selector)&#123; var dom; dom = document.querySelector(selector); return wclimb.Z(dom,selector) &#125;, Z: function(dom,selector)&#123; return new Z(dom,selector) &#125;&#125; é€šè¿‡wclimb.Zï¼Œå¦‚æžœæœ‰çœ‹è¿‡zeptoæºç çš„åŒå­¦åº”è¯¥å¯¹æ­¤æœ‰äº†è§£.æ¯æ¬¡ç”¨$è°ƒç”¨çš„æ—¶å€™,å°†ç›´æŽ¥è¿”å›žä¸€ä¸ªZçš„å®žä¾‹.è¾¾åˆ°æ— newè°ƒç”¨çš„æ•ˆæžœ,$(â€˜pâ€™)è¿”å›žä¸€ä¸ªå®žä¾‹ï¼Œç„¶åŽ$(â€˜pâ€™).test()è°ƒç”¨ä»–çš„åŽŸå½¢æ–¹æ³•ï¼Œè¿™é‡Œçš„æ–¹æ³•æ˜¯test 1234567891011wclimb.Z = function(dom,selector)&#123; return new Z(dom,selector)&#125;function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length&#125; ç”±äºŽæˆ‘ä»¬æ˜¯return new Z(dom,selector),é‚£è‡ªç„¶,æˆ‘ä»¬éœ€è¦æ‰‹åŠ¨çš„æŠŠwclimb.Zçš„prototypeæŒ‡å‘Zçš„prototype 123456789wclimb.Z.prototype = Z.prototype&#123;&#125;æˆ‘ä»¬å¯ä»¥åœ¨é‡Œé¢æ·»åŠ æ–¹æ³•äº†ï¼Œå¦‚addClass eqç­‰ï¼Œæˆ‘ä»¬è¯•è¯•åŠ ä¸€ä¸ªtestwclimb.Z.prototype = Z.prototype&#123; test: function()&#123; console.log('test') &#125;&#125; Zå‡½æ•°æ˜¯è¿™æ ·çš„ï¼Œå› ä¸ºæˆ‘ä»¬é€‰æ‹©å™¨é€‰æ‹©çš„å…ƒç´ æ˜¯ä¸€ä¸ªæ•°ç»„ï¼ˆå…¶å®žä¸æ˜¯ï¼‰æˆ‘ä»¬æŠŠthisæŒ‡å‘é€‰æ‹©çš„å…ƒç´ ï¼Œç„¶åŽæ·»åŠ ä¸¤ä¸ªå…ƒç´ selectorå’Œlengthï¼Œåˆ†åˆ«ä»£è¡¨é€‰æ‹©çš„å…ƒç´ åå’Œå…ƒç´ çš„é•¿åº¦ 1234567function Z(dom,selector) &#123; for (var i = 0; i &lt; dom.length; i++) &#123; this[i] = dom[i] &#125; this.selector = selector; this.length = dom.length&#125; æœ€åŽæˆ‘ä»¬åœ¨windowä¸Šå¯¹å¤–æš´éœ²ä¸€ä¸ªæŽ¥å£,æˆ‘ä»¬å°±å¯ä»¥ç”¨ $(â€˜pâ€™) æˆ–è€…wclimb(â€˜pâ€™) å³å¯è°ƒç”¨. 1window.$ = window.wclimb = $ çŽ°åœ¨å¯ä»¥è¯•è¯•èƒ½ä¸èƒ½è¿è¡Œ 123htmlï¼š&lt;p&gt;test&lt;/p&gt;jsï¼š$('p') è°ƒç”¨æ–¹æ³•è¯•è¯• $('p').test() æˆ‘ä»¬çš„zeptoå·²ç»å®Œæˆäº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆç®€å•ï¼Ÿéª—ä½ çš„ï¼Œè¿˜å·®å¾—è¿œå‘¢ï¼ŒåŽé¢ä¼šæ…¢æ…¢å®Œå–„ã€‚å¾…ç»­ã€‚ã€‚ã€‚å¦‚æžœä½ è§‰å¾—è¯¥æ–‡ç« å¸®åŠ©åˆ°äº†ä½ ï¼Œä¸å¦¨starä¸€ä¸‹https://github.com/wclimb/wclimb.github.io ï¼Œæ„Ÿè°¢]]></content>
      <tags>
        <tag>javascript</tag>
        <tag>åŽŸåˆ›</tag>
        <tag>zepto</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[canvasä»¿å¾®ä¿¡çº¢åŒ…ç…§ç‰‡]]></title>
    <url>%2F2017%2F06%2F28%2Fcanvas%E5%BE%AE%E4%BF%A1%E7%BA%A2%E5%8C%85%E7%85%A7%E7%89%87%2F</url>
    <content type="text"><![CDATA[canvasä»¿å¾®ä¿¡çº¢åŒ…ç…§ç‰‡ By wclimbHTML1&lt;canvas id=&quot;cav&quot; width=&quot;500&quot; height=&quot;500&quot;&gt;&lt;/canvas&gt; CSS è®¾ç½®canvasçš„èƒŒæ™¯å›¾ 1234canvas&#123; background:url(https://b-ssl.duitang.com/uploads/item/201501/22/20150122203239_Cfr58.thumb.700_0.jpeg) no-repeat; background-size:100% 100%;&#125; JS12345678910111213141516171819202122232425262728293031323334353637var canvas = document.querySelector("#cav")var context = canvas.getContext("2d");var randomX = Math.floor(Math.random()*440+30)var randomY = Math.floor(Math.random()*440+30)context.globalAlpha = 0.96;context.fillStyle = '#333'context.rect(0,0,canvas.width,canvas.height);context.fill();context.save()context.beginPath()context.arc(randomX,randomY,30,0,Math.PI*2,false);context.clip();context.clearRect(0,0,canvas.width,canvas.height)context.restore();var num = 30;var time = null;document.body.onclick = function()&#123; function circle()&#123; num += 5 context.save() context.beginPath() context.arc(randomX,randomY,num,0,Math.PI*2,false); context.clip(); context.clearRect(0,0,canvas.width,canvas.height) context.restore(); console.log(num) if (num &gt;= 677)&#123; clearInterval(timer) &#125; &#125; timer = setInterval(circle,10)&#125; è§£æž éšæœºå‡ºçŽ°åœ†å¿ƒçš„ä½ç½®ï¼Œå› ä¸ºcanvasä¸º500*500 åœ†å¿ƒä¸º30 æ‰€ä»¥åœ†å¿ƒçš„èŒƒå›´ä¸º X(30,470) Y(470,30) 12var randomX = Math.floor(Math.random()*440+30)var randomY = Math.floor(Math.random()*440+30) ç»˜åˆ¶çŸ©å½¢ é€æ˜Žåº¦ä¸º0.96 å¡«å……é¢œè‰²#333 å®½é«˜ä¸ºcanvasçš„å®½é«˜ æœ€åŽç”¨fillå¡«å…… 1234context.globalAlpha = 0.96;context.fillStyle = '#333'context.rect(0,0,canvas.width,canvas.height);context.fill(); åˆå§‹åŒ–åœ†å¿ƒçš„ä½ç½®ï¼Œç”¨arcç»˜åˆ¶åœ†ï¼Œé»˜è®¤åŠå¾„ä¸º30ï¼Œç”¨clipå‰ªåˆ‡ï¼Œåªæœ‰è¢«å‰ªåˆ‡åŒºåŸŸå†…æ˜¯å¯è§çš„ 123456context.save()context.beginPath()context.arc(randomX,randomY,30,0,Math.PI*2,false);context.clip();context.clearRect(0,0,canvas.width,canvas.height)context.restore(); ç‚¹å‡»bodyçš„æ—¶å€™ï¼Œè®¾ç½®å®šæ—¶å™¨ï¼Œè®©åœ†çš„åŠå¾„æ¯éš”10æ¯«ç§’å¢žåŠ 5ï¼Œå½“numåŠå¾„å¤§äºŽ677å…³é—­å®šæ—¶å™¨ï¼Œ677ä¸ºcanvaså¯¹è§’çš„é•¿åº¦ 1document.body.onclick = function()&#123;&#125; æ•ˆæžœé¢„è§ˆ]]></content>
      <categories>
        <category>javascript</category>
        <category>canvas</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>canvas</tag>
      </tags>
  </entry>
  <entry>
    <title><![CDATA[gulpåŸºç¡€æ•™ç¨‹]]></title>
    <url>%2F2017%2F06%2F27%2Fgulp%2F</url>
    <content type="text"><![CDATA[å…¥é—¨æŒ‡å—â€“å¼•ç”¨gulpå®˜ç½‘ç¤ºä¾‹ å…¨å±€å®‰è£… gulpï¼š 1$ npm install --global gulp ä½œä¸ºé¡¹ç›®çš„å¼€å‘ä¾èµ–ï¼ˆdevDependenciesï¼‰å®‰è£…ï¼š 1$ npm install --save-dev gulp åœ¨é¡¹ç›®æ ¹ç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªåä¸º gulpfile.js çš„æ–‡ä»¶ï¼š 12345var gulp = require('gulp');gulp.task('default', function() &#123; // å°†ä½ çš„é»˜è®¤çš„ä»»åŠ¡ä»£ç æ”¾åœ¨è¿™&#125;); è¿è¡Œ gulp 1$ gulp //é»˜è®¤çš„åä¸º default çš„ä»»åŠ¡ï¼ˆtaskï¼‰å°†ä¼šè¢«è¿è¡Œï¼Œåœ¨è¿™é‡Œï¼Œè¿™ä¸ªä»»åŠ¡å¹¶æœªåšä»»ä½•äº‹æƒ…ã€‚ è‡³æ­¤ï¼Œä¸€ä¸ªç®€å•çš„gulpå·²ç»å®Œæˆï¼ŒæŽ¥ä¸‹æ¥è®©æˆ‘ä»¬æ¥å®Œå–„éƒ¨åˆ†åŠŸèƒ½ gulpåŠŸèƒ½å®Œå–„ç”Ÿæˆpackage.jsonæ–‡ä»¶1$ npm init //ä¸€ç›´å›žè½¦ï¼Œæœ‰éœ€è¦çš„å¯ä»¥è®¾ç½® å®‰è£…æ‰€éœ€åŒ… ä½¿ç”¨æ·˜å®é•œåƒ 12$ npm install -g cnpm --registry=https://registry.npm.taobao.orgç¤ºä¾‹ $ cnpm install [name] æŽ¥ç€1$ cnpm i browser-sync gulp gulp-clean-css gulp-imagemin gulp-rename gulp-sass gulp-uglify gulp.spritesmith gulp-autoprefixer --save æ–°å»ºgulpfile.jsæ–‡ä»¶æ·»åŠ 123456789var gulp = require('gulp'); var browserSync = require('browser-sync').create(); //é€šè¿‡æµçš„æ–¹å¼åˆ›å»ºä»»åŠ¡æµç¨‹, è¿™æ ·æ‚¨å°±å¯ä»¥åœ¨æ‚¨çš„ä»»åŠ¡å®ŒæˆåŽè°ƒç”¨reloadï¼Œæ‰€æœ‰çš„æµè§ˆå™¨å°†è¢«å‘ŠçŸ¥çš„å˜åŒ–å¹¶å®žæ—¶æ›´æ–°var sass = require('gulp-sass'); //sassè½¬cssvar reload = browserSync.reload; var minifyCSS = require('gulp-clean-css') //cssåŽ‹ç¼©var uglify = require('gulp-uglify') //jsåŽ‹ç¼©var imagemin = require('gulp-imagemin') //å›¾ç‰‡åŽ‹ç¼©var rename = require('gulp-rename') //æ–‡ä»¶é‡å‘½åvar autoprefixer = require('gulp-autoprefixer') //è‡ªåŠ¨æ·»åŠ å‰ç¼€ è®¾ç½®é»˜è®¤æ–‡ä»¶åœ°å€12345678codeä¸ºæ–‡ä»¶å¤¹ï¼Œé‡Œé¢å­˜æ”¾html css jsæ–‡ä»¶var src = &#123; scss: 'code/scss/*.scss', css: 'code/css/*.css', html: 'code/*.html', js: 'code/js/*.js', images: 'code/images/*.&#123;png,jpg,gif,ico&#125;'&#125;; gulp.task(name[, deps], fn)1234567891011121314151617name: ä»»åŠ¡çš„åå­—deps: ä¸€ä¸ªåŒ…å«ä»»åŠ¡åˆ—è¡¨çš„æ•°ç»„ï¼Œè¿™äº›ä»»åŠ¡ä¼šåœ¨ä½ å½“å‰ä»»åŠ¡è¿è¡Œä¹‹å‰å®Œæˆã€‚fn: è¯¥å‡½æ•°å®šä¹‰ä»»åŠ¡æ‰€è¦æ‰§è¡Œçš„ä¸€äº›æ“ä½œã€‚é€šå¸¸æ¥è¯´ï¼Œå®ƒä¼šæ˜¯è¿™ç§å½¢å¼ï¼šgulp.src().pipe(someplugin())ã€‚// é™æ€æœåŠ¡å™¨ + ç›‘å¬ scss/html æ–‡ä»¶ gulp.task('serve', ['sass'], function() &#123; browserSync.init(&#123; server: "./code" &#125;); gulp.watch(src.scss, ['sass']); gulp.watch(src.css, ['css']); gulp.watch(src.images, ['images']) gulp.watch(src.js, ['js']); gulp.watch(src.html).on('change', reload);&#125;); scssç¼–è¯‘åŽçš„csså°†æ³¨å…¥åˆ°æµè§ˆå™¨é‡Œå®žçŽ°æ›´æ–°123456789101112131415gulp.task('sass', function() &#123; return gulp.src(src.scss) .pipe(sass()) .pipe(minifyCSS(&#123; advanced: false,//ç±»åž‹ï¼šBoolean é»˜è®¤ï¼štrue [æ˜¯å¦å¼€å¯é«˜çº§ä¼˜åŒ–ï¼ˆåˆå¹¶é€‰æ‹©å™¨ç­‰ï¼‰] compatibility: 'ie7',//ä¿ç•™ie7åŠä»¥ä¸‹å…¼å®¹å†™æ³• ç±»åž‹ï¼šString é»˜è®¤ï¼š''or'*' [å¯ç”¨å…¼å®¹æ¨¡å¼ï¼› 'ie7'ï¼šIE7å…¼å®¹æ¨¡å¼ï¼Œ'ie8'ï¼šIE8å…¼å®¹æ¨¡å¼ï¼Œ'*'ï¼šIE9+å…¼å®¹æ¨¡å¼] keepBreaks: true,//ç±»åž‹ï¼šBoolean é»˜è®¤ï¼šfalse [æ˜¯å¦ä¿ç•™æ¢è¡Œ] keepSpecialComments: '*' //ä¿ç•™æ‰€æœ‰ç‰¹æ®Šå‰ç¼€ å½“ä½ ç”¨autoprefixerç”Ÿæˆçš„æµè§ˆå™¨å‰ç¼€ï¼Œå¦‚æžœä¸åŠ è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½å°†ä¼šåˆ é™¤ä½ çš„éƒ¨åˆ†å‰ç¼€ &#125;)) .pipe(autoprefixer()) .pipe(rename(&#123;suffix: '.min'&#125;)) .pipe(gulp.dest("code/css")) .pipe(reload(&#123;stream: true&#125;));&#125;); é›ªç¢§å›¾ï¼ˆæœ‰éœ€è¦å¯ä»¥å°è¯•ï¼‰123456789101112var spritesmith = require('gulp.spritesmith'); gulp.task('sprite', function () &#123; return gulp.src('code/images/*.png') .pipe(spritesmith(&#123; imgName:'images/sprite20161010.png', //ä¿å­˜åˆå¹¶åŽå›¾ç‰‡çš„åœ°å€ cssName:'css/sprite.css', //ä¿å­˜åˆå¹¶åŽå¯¹äºŽcssæ ·å¼çš„åœ°å€ padding:20, algorithm:'binary-tree', &#125;)) .pipe(gulp.dest('code/scss')); &#125;); ç›‘å¬cssæ–‡ä»¶1234567gulp.task('css', function() &#123; return gulp.src(src.css) .pipe(minifyCSS()) .pipe(rename(&#123;suffix: '.min'&#125;)) .pipe(gulp.dest("code/css")) .pipe(reload(&#123;stream: true&#125;));&#125;); ç›‘å¬jsæ–‡ä»¶12345678910gulp.task('js', function() &#123; // 1. æ‰¾åˆ°æ–‡ä»¶ return gulp.src(src.js) //2. åŽ‹ç¼©æ–‡ä»¶ .pipe(uglify()) .pipe(rename(&#123;suffix: '.min'&#125;)) //3. å¦å­˜åŽ‹ç¼©åŽçš„æ–‡ä»¶ .pipe(gulp.dest('code/dest')) .pipe(reload(&#123;stream: true&#125;));&#125;) åŽ‹ç¼©å›¾ç‰‡ä»»åŠ¡12345678910// åœ¨å‘½ä»¤è¡Œè¾“å…¥ gulp images å¯åŠ¨æ­¤ä»»åŠ¡gulp.task('images', function () &#123; // 1. æ‰¾åˆ°å›¾ç‰‡ gulp.src(src.images) // 2. åŽ‹ç¼©å›¾ç‰‡ .pipe($.imagemin()) // 3. å¦å­˜å›¾ç‰‡ .pipe(gulp.dest('images')) .pipe(reload(&#123;stream: true&#125;));&#125;); æœ€åŽæŽ§åˆ¶å°è¾“å…¥gulpæ‰§è¡Œ1gulp.task('default', ['serve']); å¦‚æžœè§‰å¾—å¸®åŠ©åˆ°äº†ä½ ï¼Œæ¬¢è¿Žstar -&gt; https://github.com/wclimb/wclimb.github.io å®Œæ•´ä»£ç æ–‡ä»¶ç›®å½•123456789101112-code -imgage 1.png -css default.css -scss default.scss -js default.js index.htmlgulpfile.jspackage.json package.json12345678910111213141516171819202122232425&#123; "name": "gulp-test", "version": "1.0.0", "description": "Gulp &amp; SASS", "main": "gulpfile.js", "scripts": &#123; "start": "gulp" &#125;, "author": "", "license": "ISC", "devDependencies": &#123; "browser-sync": "^2.2.0", "gulp": "^3.9.1", "gulp-clean-css": "^3.0.3", "gulp-imagemin": "^3.1.1", "gulp-rename": "^1.2.2", "gulp-sass": "^3.1.0", "gulp-uglify": "^2.0.1", "gulp.spritesmith": "^6.4.0", "gulp-autoprefixer": "^4.0.0" &#125;, "dependencies": &#123; &#125;&#125; gulpfile.js123456789101112131415161718192021222324252627282930313233343536373839404142434445464748495051525354555657585960616263646566676869707172737475767778798081828384858687888990919293949596979899100101102103var gulp = require('gulp'); var browserSync = require('browser-sync').create(); //é€šè¿‡æµçš„æ–¹å¼åˆ›å»ºä»»åŠ¡æµç¨‹, è¿™æ ·æ‚¨å°±å¯ä»¥åœ¨æ‚¨çš„ä»»åŠ¡å®ŒæˆåŽè°ƒç”¨reloadï¼Œæ‰€æœ‰çš„æµè§ˆå™¨å°†è¢«å‘ŠçŸ¥çš„å˜åŒ–å¹¶å®žæ—¶æ›´æ–°var sass = require('gulp-sass'); //sassè½¬cssvar reload = browserSync.reload; var minifyCSS = require('gulp-clean-css') //cssåŽ‹ç¼©var uglify = require('gulp-uglify') //jsåŽ‹ç¼©var imagemin = require('gulp-imagemin') //å›¾ç‰‡åŽ‹ç¼©var rename = require('gulp-rename') //æ–‡ä»¶é‡å‘½åvar autoprefixer = require('gulp-autoprefixer') //è‡ªåŠ¨æ·»åŠ å‰ç¼€var src = &#123; scss: 'code/scss/*.scss', css: 'code/css/*.css', html: 'code/*.html', js: 'code/js/*.js', images: 'code/images/*.&#123;png,jpg,gif,ico&#125;'&#125;;// é™æ€æœåŠ¡å™¨ + ç›‘å¬ scss/html æ–‡ä»¶ gulp.task('serve', ['sass'], function() &#123; browserSync.init(&#123; server: "./code" &#125;); gulp.watch(src.scss, ['sass']); gulp.watch(src.css, ['css']); gulp.watch(src.images, ['images']) gulp.watch(src.js, ['js']); gulp.watch(src.html).on('change', reload);&#125;);// scssç¼–è¯‘åŽçš„csså°†æ³¨å…¥åˆ°æµè§ˆå™¨é‡Œå®žçŽ°æ›´æ–°gulp.task('sass', function() &#123; return gulp.src(src.scss) .pipe(sass()) .pipe(minifyCSS(&#123; advanced: false,//ç±»åž‹ï¼šBoolean é»˜è®¤ï¼štrue [æ˜¯å¦å¼€å¯é«˜çº§ä¼˜åŒ–ï¼ˆåˆå¹¶é€‰æ‹©å™¨ç­‰ï¼‰] compatibility: 'ie7',//ä¿ç•™ie7åŠä»¥ä¸‹å…¼å®¹å†™æ³• ç±»åž‹ï¼šString é»˜è®¤ï¼š''or'*' [å¯ç”¨å…¼å®¹æ¨¡å¼ï¼› 'ie7'ï¼šIE7å…¼å®¹æ¨¡å¼ï¼Œ'ie8'ï¼šIE8å…¼å®¹æ¨¡å¼ï¼Œ'*'ï¼šIE9+å…¼å®¹æ¨¡å¼] keepBreaks: true,//ç±»åž‹ï¼šBoolean é»˜è®¤ï¼šfalse [æ˜¯å¦ä¿ç•™æ¢è¡Œ] keepSpecialComments: '*' //ä¿ç•™æ‰€æœ‰ç‰¹æ®Šå‰ç¼€ å½“ä½ ç”¨autoprefixerç”Ÿæˆçš„æµè§ˆå™¨å‰ç¼€ï¼Œå¦‚æžœä¸åŠ è¿™ä¸ªå‚æ•°ï¼Œæœ‰å¯èƒ½å°†ä¼šåˆ é™¤ä½ çš„éƒ¨åˆ†å‰ç¼€ &#125;)) .pipe(autoprefixer()) .pipe(rename(&#123;suffix: '.min'&#125;)) .pipe(gulp.dest("code/css")) //é‡æ–°è¾“å‡ºæ•°æ®åˆ°æŸä¸ªæ–‡ä»¶å¤¹ï¼Œå¦‚æžœæ²¡æœ‰å°±ä¼šè‡ªåŠ¨åˆ›å»º .pipe(reload(&#123;stream: true&#125;));&#125;);// é›ªç¢§å›¾ï¼ˆæœ‰éœ€è¦å¯ä»¥å°è¯•ï¼‰//var spritesmith = require('gulp.spritesmith'); // gulp.task('sprite', function () &#123;// return gulp.src('code/images/*.png')// .pipe(spritesmith(&#123;// imgName:'images/sprite20161010.png', //ä¿å­˜åˆå¹¶åŽå›¾ç‰‡çš„åœ°å€// cssName:'css/sprite.css', //ä¿å­˜åˆå¹¶åŽå¯¹äºŽcssæ ·å¼çš„åœ°å€// padding:20,// algorithm:'binary-tree',// &#125;))// .pipe(gulp.dest('code/scss'));// &#125;);gulp.task('css', function() &#123; return gulp.src(src.css) .pipe(minifyCSS()) .pipe(rename(&#123;suffix: '.min'&#125;)) .pipe(gulp.dest("code/css")) .pipe(reload(&#123;stream: true&#125;));&#125;);gulp.task('js', function() &#123; // 1. æ‰¾åˆ°æ–‡ä»¶ return gulp.src(src.js) //2. åŽ‹ç¼©æ–‡ä»¶ .pipe(uglify()) .pipe(rename(&#123;suffix: '.min'&#125;)) //3. å¦å­˜åŽ‹ç¼©åŽçš„æ–‡ä»¶ .pipe(gulp.dest('code/dest')) .pipe(reload(&#123;stream: true&#125;));&#125;)// åŽ‹ç¼©å›¾ç‰‡ä»»åŠ¡// åœ¨å‘½ä»¤è¡Œè¾“å…¥ gulp images å¯åŠ¨æ­¤ä»»åŠ¡gulp.task('images', function () &#123; // 1. æ‰¾åˆ°å›¾ç‰‡ gulp.src(src.images) // 2. åŽ‹ç¼©å›¾ç‰‡ .pipe($.imagemin()) // 3. å¦å­˜å›¾ç‰‡ .pipe(gulp.dest('images')) .pipe(reload(&#123;stream: true&#125;));&#125;);gulp.task('default', ['serve']);]]></content>
      <categories>
        <category>javascript</category>
        <category>gulp</category>
      </categories>
      <tags>
        <tag>åŽŸåˆ›</tag>
        <tag>gulp</tag>
      </tags>
  </entry>
</search>
